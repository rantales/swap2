"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9448],{79448:function(t,n,l){function size(t){var n=t.width,l=t.height;if(n<0)throw Error("Negative width is not allowed for Size");if(l<0)throw Error("Negative height is not allowed for Size");return{width:n,height:l}}function equalSizes(t,n){return t.width===n.width&&t.height===n.height}l.d(n,{Mr:function(){return tu},TD:function(){return U},C2:function(){return Ce}});var a,u,c,d,g,y,S,_,L,C,k,U,Z,th,tl,tr,to,ta,tu,tc,td,tf=function(){function Observable(t){var n=this;this._resolutionListener=function(){return n._onResolutionChanged()},this._resolutionMediaQueryList=null,this._observers=[],this._window=t,this._installResolutionListener()}return Observable.prototype.dispose=function(){this._uninstallResolutionListener(),this._window=null},Object.defineProperty(Observable.prototype,"value",{get:function(){return this._window.devicePixelRatio},enumerable:!1,configurable:!0}),Observable.prototype.subscribe=function(t){var n=this,l={next:t};return this._observers.push(l),{unsubscribe:function(){n._observers=n._observers.filter(function(t){return t!==l})}}},Observable.prototype._installResolutionListener=function(){if(null!==this._resolutionMediaQueryList)throw Error("Resolution listener is already installed");var t=this._window.devicePixelRatio;this._resolutionMediaQueryList=this._window.matchMedia("all and (resolution: ".concat(t,"dppx)")),this._resolutionMediaQueryList.addListener(this._resolutionListener)},Observable.prototype._uninstallResolutionListener=function(){null!==this._resolutionMediaQueryList&&(this._resolutionMediaQueryList.removeListener(this._resolutionListener),this._resolutionMediaQueryList=null)},Observable.prototype._reinstallResolutionListener=function(){this._uninstallResolutionListener(),this._installResolutionListener()},Observable.prototype._onResolutionChanged=function(){var t=this;this._observers.forEach(function(n){return n.next(t._window.devicePixelRatio)}),this._reinstallResolutionListener()},Observable}(),tv=function(){function DevicePixelContentBoxBinding(t,n,l){var a;this._canvasElement=null,this._bitmapSizeChangedListeners=[],this._suggestedBitmapSize=null,this._suggestedBitmapSizeChangedListeners=[],this._devicePixelRatioObservable=null,this._canvasElementResizeObserver=null,this._canvasElement=t,this._canvasElementClientSize=size({width:this._canvasElement.clientWidth,height:this._canvasElement.clientHeight}),this._transformBitmapSize=null!=n?n:function(t){return t},this._allowResizeObserver=null===(a=null==l?void 0:l.allowResizeObserver)||void 0===a||a,this._chooseAndInitObserver()}return DevicePixelContentBoxBinding.prototype.dispose=function(){var t,n;if(null===this._canvasElement)throw Error("Object is disposed");null===(t=this._canvasElementResizeObserver)||void 0===t||t.disconnect(),this._canvasElementResizeObserver=null,null===(n=this._devicePixelRatioObservable)||void 0===n||n.dispose(),this._devicePixelRatioObservable=null,this._suggestedBitmapSizeChangedListeners.length=0,this._bitmapSizeChangedListeners.length=0,this._canvasElement=null},Object.defineProperty(DevicePixelContentBoxBinding.prototype,"canvasElement",{get:function(){if(null===this._canvasElement)throw Error("Object is disposed");return this._canvasElement},enumerable:!1,configurable:!0}),Object.defineProperty(DevicePixelContentBoxBinding.prototype,"canvasElementClientSize",{get:function(){return this._canvasElementClientSize},enumerable:!1,configurable:!0}),Object.defineProperty(DevicePixelContentBoxBinding.prototype,"bitmapSize",{get:function(){return size({width:this.canvasElement.width,height:this.canvasElement.height})},enumerable:!1,configurable:!0}),DevicePixelContentBoxBinding.prototype.resizeCanvasElement=function(t){this._canvasElementClientSize=size(t),this.canvasElement.style.width="".concat(this._canvasElementClientSize.width,"px"),this.canvasElement.style.height="".concat(this._canvasElementClientSize.height,"px"),this._invalidateBitmapSize()},DevicePixelContentBoxBinding.prototype.subscribeBitmapSizeChanged=function(t){this._bitmapSizeChangedListeners.push(t)},DevicePixelContentBoxBinding.prototype.unsubscribeBitmapSizeChanged=function(t){this._bitmapSizeChangedListeners=this._bitmapSizeChangedListeners.filter(function(n){return n!==t})},Object.defineProperty(DevicePixelContentBoxBinding.prototype,"suggestedBitmapSize",{get:function(){return this._suggestedBitmapSize},enumerable:!1,configurable:!0}),DevicePixelContentBoxBinding.prototype.subscribeSuggestedBitmapSizeChanged=function(t){this._suggestedBitmapSizeChangedListeners.push(t)},DevicePixelContentBoxBinding.prototype.unsubscribeSuggestedBitmapSizeChanged=function(t){this._suggestedBitmapSizeChangedListeners=this._suggestedBitmapSizeChangedListeners.filter(function(n){return n!==t})},DevicePixelContentBoxBinding.prototype.applySuggestedBitmapSize=function(){if(null!==this._suggestedBitmapSize){var t=this._suggestedBitmapSize;this._suggestedBitmapSize=null,this._resizeBitmap(t),this._emitSuggestedBitmapSizeChanged(t,this._suggestedBitmapSize)}},DevicePixelContentBoxBinding.prototype._resizeBitmap=function(t){var n=this.bitmapSize;equalSizes(n,t)||(this.canvasElement.width=t.width,this.canvasElement.height=t.height,this._emitBitmapSizeChanged(n,t))},DevicePixelContentBoxBinding.prototype._emitBitmapSizeChanged=function(t,n){var l=this;this._bitmapSizeChangedListeners.forEach(function(a){return a.call(l,t,n)})},DevicePixelContentBoxBinding.prototype._suggestNewBitmapSize=function(t){var n=this._suggestedBitmapSize,l=size(this._transformBitmapSize(t,this._canvasElementClientSize)),a=equalSizes(this.bitmapSize,l)?null:l;null===n&&null===a||null!==n&&null!==a&&equalSizes(n,a)||(this._suggestedBitmapSize=a,this._emitSuggestedBitmapSizeChanged(n,a))},DevicePixelContentBoxBinding.prototype._emitSuggestedBitmapSizeChanged=function(t,n){var l=this;this._suggestedBitmapSizeChangedListeners.forEach(function(a){return a.call(l,t,n)})},DevicePixelContentBoxBinding.prototype._chooseAndInitObserver=function(){var t=this;if(!this._allowResizeObserver){this._initDevicePixelRatioObservable();return}new Promise(function(t){var n=new ResizeObserver(function(l){t(l.every(function(t){return"devicePixelContentBoxSize"in t})),n.disconnect()});n.observe(document.body,{box:"device-pixel-content-box"})}).catch(function(){return!1}).then(function(n){return n?t._initResizeObserver():t._initDevicePixelRatioObservable()})},DevicePixelContentBoxBinding.prototype._initDevicePixelRatioObservable=function(){var t=this;if(null!==this._canvasElement){var n=canvasElementWindow(this._canvasElement);if(null===n)throw Error("No window is associated with the canvas");this._devicePixelRatioObservable=new tf(n),this._devicePixelRatioObservable.subscribe(function(){return t._invalidateBitmapSize()}),this._invalidateBitmapSize()}},DevicePixelContentBoxBinding.prototype._invalidateBitmapSize=function(){if(null!==this._canvasElement){var t,n,l=canvasElementWindow(this._canvasElement);if(null!==l){var a,u=null!==(n=null===(t=this._devicePixelRatioObservable)||void 0===t?void 0:t.value)&&void 0!==n?n:l.devicePixelRatio,c=this._canvasElement.getClientRects(),d=void 0!==c[0]?size({width:Math.round((a=c[0]).left*u+a.width*u)-Math.round(a.left*u),height:Math.round(a.top*u+a.height*u)-Math.round(a.top*u)}):size({width:this._canvasElementClientSize.width*u,height:this._canvasElementClientSize.height*u});this._suggestNewBitmapSize(d)}}},DevicePixelContentBoxBinding.prototype._initResizeObserver=function(){var t=this;null!==this._canvasElement&&(this._canvasElementResizeObserver=new ResizeObserver(function(n){var l=n.find(function(n){return n.target===t._canvasElement});if(l&&l.devicePixelContentBoxSize&&l.devicePixelContentBoxSize[0]){var a=l.devicePixelContentBoxSize[0],u=size({width:a.inlineSize,height:a.blockSize});t._suggestNewBitmapSize(u)}}),this._canvasElementResizeObserver.observe(this._canvasElement,{box:"device-pixel-content-box"}))},DevicePixelContentBoxBinding}();function canvasElementWindow(t){return t.ownerDocument.defaultView}var tm=function(){function CanvasRenderingTarget2D(t,n,l){if(0===n.width||0===n.height)throw TypeError("Rendering target could only be created on a media with positive width and height");if(this._mediaSize=n,0===l.width||0===l.height)throw TypeError("Rendering target could only be created using a bitmap with positive integer width and height");this._bitmapSize=l,this._context=t}return CanvasRenderingTarget2D.prototype.useMediaCoordinateSpace=function(t){try{return this._context.save(),this._context.setTransform(1,0,0,1,0,0),this._context.scale(this._horizontalPixelRatio,this._verticalPixelRatio),t({context:this._context,mediaSize:this._mediaSize})}finally{this._context.restore()}},CanvasRenderingTarget2D.prototype.useBitmapCoordinateSpace=function(t){try{return this._context.save(),this._context.setTransform(1,0,0,1,0,0),t({context:this._context,mediaSize:this._mediaSize,bitmapSize:this._bitmapSize,horizontalPixelRatio:this._horizontalPixelRatio,verticalPixelRatio:this._verticalPixelRatio})}finally{this._context.restore()}},Object.defineProperty(CanvasRenderingTarget2D.prototype,"_horizontalPixelRatio",{get:function(){return this._bitmapSize.width/this._mediaSize.width},enumerable:!1,configurable:!0}),Object.defineProperty(CanvasRenderingTarget2D.prototype,"_verticalPixelRatio",{get:function(){return this._bitmapSize.height/this._mediaSize.height},enumerable:!1,configurable:!0}),CanvasRenderingTarget2D}();function tryCreateCanvasRenderingTarget2D(t,n){var l=t.canvasElementClientSize;if(0===l.width||0===l.height)return null;var a=t.bitmapSize;if(0===a.width||0===a.height)return null;var u=t.canvasElement.getContext("2d",n);return null===u?null:new tm(u,l,a)}/*!
 * @license
 * TradingView Lightweight Charts™ v4.1.1
 * Copyright (c) 2023 TradingView, Inc.
 * Licensed under Apache License 2.0 https://www.apache.org/licenses/LICENSE-2.0
 */let tp={upColor:"#26a69a",downColor:"#ef5350",wickVisible:!0,borderVisible:!0,borderColor:"#378658",borderUpColor:"#26a69a",borderDownColor:"#ef5350",wickColor:"#737375",wickUpColor:"#26a69a",wickDownColor:"#ef5350"},tb={upColor:"#26a69a",downColor:"#ef5350",openVisible:!0,thinBars:!0},tg={color:"#2196f3",lineStyle:0,lineWidth:3,lineType:0,lineVisible:!0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,crosshairMarkerBorderColor:"",crosshairMarkerBorderWidth:2,crosshairMarkerBackgroundColor:"",lastPriceAnimation:0,pointMarkersVisible:!1},tw={topColor:"rgba( 46, 220, 135, 0.4)",bottomColor:"rgba( 40, 221, 100, 0)",invertFilledArea:!1,lineColor:"#33D778",lineStyle:0,lineWidth:3,lineType:0,lineVisible:!0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,crosshairMarkerBorderColor:"",crosshairMarkerBorderWidth:2,crosshairMarkerBackgroundColor:"",lastPriceAnimation:0,pointMarkersVisible:!1},ty={baseValue:{type:"price",price:0},topFillColor1:"rgba(38, 166, 154, 0.28)",topFillColor2:"rgba(38, 166, 154, 0.05)",topLineColor:"rgba(38, 166, 154, 1)",bottomFillColor1:"rgba(239, 83, 80, 0.05)",bottomFillColor2:"rgba(239, 83, 80, 0.28)",bottomLineColor:"rgba(239, 83, 80, 1)",lineWidth:3,lineStyle:0,lineType:0,lineVisible:!0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,crosshairMarkerBorderColor:"",crosshairMarkerBorderWidth:2,crosshairMarkerBackgroundColor:"",lastPriceAnimation:0,pointMarkersVisible:!1},tS={color:"#26a69a",base:0},tM={color:"#2196f3"},t_={title:"",visible:!0,lastValueVisible:!0,priceLineVisible:!0,priceLineSource:0,priceLineWidth:1,priceLineColor:"",priceLineStyle:2,baseLineVisible:!0,baseLineWidth:1,baseLineColor:"#B2B5BE",baseLineStyle:0,priceFormat:{type:"price",precision:2,minMove:.01}};function f(t,n){let l={0:[],1:[t.lineWidth,t.lineWidth],2:[2*t.lineWidth,2*t.lineWidth],3:[6*t.lineWidth,6*t.lineWidth],4:[t.lineWidth,4*t.lineWidth]}[n];t.setLineDash(l)}function v(t,n,l,a){t.beginPath();let u=t.lineWidth%2?.5:0;t.moveTo(l,n+u),t.lineTo(a,n+u),t.stroke()}function p(t,n){if(!t)throw Error("Assertion failed"+(n?": "+n:""))}function m(t){if(void 0===t)throw Error("Value is undefined");return t}function b(t){if(null===t)throw Error("Value is null");return t}function w(t){return b(m(t))}(a=k||(k={}))[a.Simple=0]="Simple",a[a.WithSteps=1]="WithSteps",a[a.Curved=2]="Curved",(u=U||(U={}))[u.Solid=0]="Solid",u[u.Dotted=1]="Dotted",u[u.Dashed=2]="Dashed",u[u.LargeDashed=3]="LargeDashed",u[u.SparseDotted=4]="SparseDotted";let tx={khaki:"#f0e68c",azure:"#f0ffff",aliceblue:"#f0f8ff",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",gray:"#808080",green:"#008000",honeydew:"#f0fff0",floralwhite:"#fffaf0",lightblue:"#add8e6",lightcoral:"#f08080",lemonchiffon:"#fffacd",hotpink:"#ff69b4",lightyellow:"#ffffe0",greenyellow:"#adff2f",lightgoldenrodyellow:"#fafad2",limegreen:"#32cd32",linen:"#faf0e6",lightcyan:"#e0ffff",magenta:"#f0f",maroon:"#800000",olive:"#808000",orange:"#ffa500",oldlace:"#fdf5e6",mediumblue:"#0000cd",transparent:"#0000",lime:"#0f0",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",midnightblue:"#191970",orchid:"#da70d6",mediumorchid:"#ba55d3",mediumturquoise:"#48d1cc",orangered:"#ff4500",royalblue:"#4169e1",powderblue:"#b0e0e6",red:"#f00",coral:"#ff7f50",turquoise:"#40e0d0",white:"#fff",whitesmoke:"#f5f5f5",wheat:"#f5deb3",teal:"#008080",steelblue:"#4682b4",bisque:"#ffe4c4",aquamarine:"#7fffd4",aqua:"#0ff",sienna:"#a0522d",silver:"#c0c0c0",springgreen:"#00ff7f",antiquewhite:"#faebd7",burlywood:"#deb887",brown:"#a52a2a",beige:"#f5f5dc",chocolate:"#d2691e",chartreuse:"#7fff00",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cadetblue:"#5f9ea0",tomato:"#ff6347",fuchsia:"#f0f",blue:"#00f",salmon:"#fa8072",blanchedalmond:"#ffebcd",slateblue:"#6a5acd",slategray:"#708090",thistle:"#d8bfd8",tan:"#d2b48c",cyan:"#0ff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",blueviolet:"#8a2be2",black:"#000",darkmagenta:"#8b008b",darkslateblue:"#483d8b",darkkhaki:"#bdb76b",darkorchid:"#9932cc",darkorange:"#ff8c00",darkgreen:"#006400",darkred:"#8b0000",dodgerblue:"#1e90ff",darkslategray:"#2f4f4f",dimgray:"#696969",deepskyblue:"#00bfff",firebrick:"#b22222",forestgreen:"#228b22",indigo:"#4b0082",ivory:"#fffff0",lavenderblush:"#fff0f5",feldspar:"#d19275",indianred:"#cd5c5c",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightskyblue:"#87cefa",lightslategray:"#789",lightslateblue:"#8470ff",snow:"#fffafa",lightseagreen:"#20b2aa",lightsalmon:"#ffa07a",darksalmon:"#e9967a",darkviolet:"#9400d3",mediumpurple:"#9370d8",mediumaquamarine:"#66cdaa",skyblue:"#87ceeb",lavender:"#e6e6fa",lightsteelblue:"#b0c4de",mediumvioletred:"#c71585",mintcream:"#f5fffa",navajowhite:"#ffdead",navy:"#000080",olivedrab:"#6b8e23",palevioletred:"#d87093",violetred:"#d02090",yellow:"#ff0",yellowgreen:"#9acd32",lawngreen:"#7cfc00",pink:"#ffc0cb",paleturquoise:"#afeeee",palegoldenrod:"#eee8aa",darkolivegreen:"#556b2f",darkseagreen:"#8fbc8f",darkturquoise:"#00ced1",peachpuff:"#ffdab9",deeppink:"#ff1493",violet:"#ee82ee",palegreen:"#98fb98",mediumseagreen:"#3cb371",peru:"#cd853f",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",purple:"#800080",seagreen:"#2e8b57",seashell:"#fff5ee",papayawhip:"#ffefd5",mediumslateblue:"#7b68ee",plum:"#dda0dd",mediumspringgreen:"#00fa9a"};function M(t){return t<0?0:t>255?255:Math.round(t)||0}function x(t){return t<=0||t>0?t<0?0:t>1?1:Math.round(1e4*t)/1e4:0}let tL=/^#([0-9a-f])([0-9a-f])([0-9a-f])([0-9a-f])?$/i,tC=/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})?$/i,tT=/^rgb\(\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*\)$/,tE=/^rgba\(\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?[\d]{0,10}(?:\.\d+)?)\s*\)$/;function T(t){(t=t.toLowerCase())in tx&&(t=tx[t]);{let n=tE.exec(t)||tT.exec(t);if(n)return[M(parseInt(n[1],10)),M(parseInt(n[2],10)),M(parseInt(n[3],10)),x(n.length<5?1:parseFloat(n[4]))]}{let n=tC.exec(t);if(n)return[M(parseInt(n[1],16)),M(parseInt(n[2],16)),M(parseInt(n[3],16)),1]}{let n=tL.exec(t);if(n)return[M(17*parseInt(n[1],16)),M(17*parseInt(n[2],16)),M(17*parseInt(n[3],16)),1]}throw Error(`Cannot parse color: ${t}`)}function P(t){let n=T(t);return{t:`rgb(${n[0]}, ${n[1]}, ${n[2]})`,i:.199*n[0]+.687*n[1]+.114*n[2]>160?"black":"white"}}let R=class R{constructor(){this.h=[]}l(t,n,l){this.h.push({o:t,_:n,u:!0===l})}v(t){let n=this.h.findIndex(n=>t===n.o);n>-1&&this.h.splice(n,1)}p(t){this.h=this.h.filter(n=>n._!==t)}m(t,n,l){let a=[...this.h];this.h=this.h.filter(t=>!t.u),a.forEach(a=>a.o(t,n,l))}M(){return this.h.length>0}S(){this.h=[]}};function D(t,...n){for(let l of n)for(let n in l)void 0!==l[n]&&("object"!=typeof l[n]||void 0===t[n]||Array.isArray(l[n])?t[n]=l[n]:D(t[n],l[n]));return t}function O(t){return"number"==typeof t&&isFinite(t)}function A(t){return"number"==typeof t&&t%1==0}function V(t){return"string"==typeof t}function B(t){return"boolean"==typeof t}function I(t){let n,l,a;if(!t||"object"!=typeof t)return t;for(l in n=Array.isArray(t)?[]:{},t)t.hasOwnProperty(l)&&(a=t[l],n[l]=a&&"object"==typeof a?I(a):a);return n}function z(t){return null!==t}function E(t){return null===t?void 0:t}let tO="-apple-system, BlinkMacSystemFont, 'Trebuchet MS', Roboto, Ubuntu, sans-serif";function N(t,n,l){return void 0===n&&(n=tO),`${l=void 0!==l?`${l} `:""}${t}px ${n}`}let F=class F{constructor(t){this.k={C:1,T:5,P:NaN,R:"",D:"",O:"",A:"",V:0,B:0,I:0,L:0,N:0},this.F=t}W(){let t=this.k,n=this.j(),l=this.H();return t.P===n&&t.D===l||(t.P=n,t.D=l,t.R=N(n,l),t.L=2.5/12*n,t.V=t.L,t.B=n/12*t.T,t.I=n/12*t.T,t.N=0),t.O=this.$(),t.A=this.U(),this.k}$(){return this.F.W().layout.textColor}U(){return this.F.q()}j(){return this.F.W().layout.fontSize}H(){return this.F.W().layout.fontFamily}};let W=class W{constructor(){this.Y=[]}X(t){this.Y=t}K(t,n,l){this.Y.forEach(a=>{a.K(t,n,l)})}};let j=class j{K(t,n,l){t.useMediaCoordinateSpace(t=>this.Z(t,n,l))}G(t,n,l){t.useMediaCoordinateSpace(t=>this.J(t,n,l))}J(t,n,l){}};let H=class H extends j{constructor(){super(...arguments),this.tt=null}it(t){this.tt=t}Z({context:t}){if(null===this.tt||null===this.tt.nt)return;let n=this.tt.nt,l=this.tt,s=a=>{t.beginPath();for(let u=n.to-1;u>=n.from;--u){let n=l.st[u];t.moveTo(n.et,n.rt),t.arc(n.et,n.rt,a,0,2*Math.PI)}t.fill()};l.ht>0&&(t.fillStyle=l.lt,s(l.ot+l.ht)),t.fillStyle=l._t,s(l.ot)}};function $(){return{st:[{et:0,rt:0,ut:0,ct:0}],_t:"",lt:"",ot:0,ht:0,nt:null}}let tz={from:0,to:1};let q=class q{constructor(t,n){this.dt=new W,this.ft=[],this.vt=[],this.bt=!0,this.F=t,this.wt=n,this.dt.X(this.ft)}gt(t){let n=this.F.Mt();n.length!==this.ft.length&&(this.vt=n.map($),this.ft=this.vt.map(t=>{let n=new H;return n.it(t),n}),this.dt.X(this.ft)),this.bt=!0}xt(){return this.bt&&(this.St(),this.bt=!1),this.dt}St(){let t=2===this.wt.W().mode,n=this.F.Mt(),l=this.wt.kt(),a=this.F.yt();n.forEach((n,u)=>{var c;let d=this.vt[u],g=n.Ct(l);if(t||null===g||!n.Tt())return void(d.nt=null);let y=b(n.Pt());d._t=g.Rt,d.ot=g.ot,d.ht=g.Dt,d.st[0].ct=g.ct,d.st[0].rt=n.At().Ot(g.ct,y.Vt),d.lt=null!==(c=g.Bt)&&void 0!==c?c:this.F.It(d.st[0].rt/n.At().zt()),d.st[0].ut=l,d.st[0].et=a.Et(l),d.nt=tz})}};let Y=class Y{K(t,n,l){t.useBitmapCoordinateSpace(t=>this.Z(t,n,l))}};let X=class X extends Y{constructor(t){super(),this.Lt=t}Z({context:t,bitmapSize:n,horizontalPixelRatio:l,verticalPixelRatio:a}){if(null===this.Lt)return;let u=this.Lt.Nt.Tt,c=this.Lt.Ft.Tt;if(!u&&!c)return;let d=Math.round(this.Lt.et*l),g=Math.round(this.Lt.rt*a);t.lineCap="butt",u&&d>=0&&(t.lineWidth=Math.floor(this.Lt.Nt.ht*l),t.strokeStyle=this.Lt.Nt.O,t.fillStyle=this.Lt.Nt.O,f(t,this.Lt.Nt.Wt),function(t,n,l,a){t.beginPath();let u=t.lineWidth%2?.5:0;t.moveTo(n+u,0),t.lineTo(n+u,a),t.stroke()}(t,d,0,n.height)),c&&g>=0&&(t.lineWidth=Math.floor(this.Lt.Ft.ht*a),t.strokeStyle=this.Lt.Ft.O,t.fillStyle=this.Lt.Ft.O,f(t,this.Lt.Ft.Wt),v(t,g,0,n.width))}};let K=class K{constructor(t){this.bt=!0,this.jt={Nt:{ht:1,Wt:0,O:"",Tt:!1},Ft:{ht:1,Wt:0,O:"",Tt:!1},et:0,rt:0},this.Ht=new X(this.jt),this.$t=t}gt(){this.bt=!0}xt(){return this.bt&&(this.St(),this.bt=!1),this.Ht}St(){let t=this.$t.Tt(),n=b(this.$t.Ut()),l=n.qt().W().crosshair,a=this.jt;if(2===l.mode)return a.Ft.Tt=!1,void(a.Nt.Tt=!1);a.Ft.Tt=t&&this.$t.Yt(n),a.Nt.Tt=t&&this.$t.Xt(),a.Ft.ht=l.horzLine.width,a.Ft.Wt=l.horzLine.style,a.Ft.O=l.horzLine.color,a.Nt.ht=l.vertLine.width,a.Nt.Wt=l.vertLine.style,a.Nt.O=l.vertLine.color,a.et=this.$t.Kt(),a.rt=this.$t.Zt()}};function G(t,n,l,a,u,c){t.save(),t.globalCompositeOperation="copy",t.fillStyle=c,t.fillRect(n,l,a,u),t.restore()}function J(t,n){return t.map(t=>0===t?t:t+n)}function Q(t,n,l,a,u,c){t.beginPath(),t.lineTo(n+a-c[1],l),0!==c[1]&&t.arcTo(n+a,l,n+a,l+c[1],c[1]),t.lineTo(n+a,l+u-c[2]),0!==c[2]&&t.arcTo(n+a,l+u,n+a-c[2],l+u,c[2]),t.lineTo(n+c[3],l+u),0!==c[3]&&t.arcTo(n,l+u,n,l+u-c[3],c[3]),t.lineTo(n,l+c[0]),0!==c[0]&&t.arcTo(n,l,n+c[0],l,c[0])}function tt(t,n,l,a,u,c,d=0,g=[0,0,0,0],y=""){if(t.save(),!d||!y||y===c)return Q(t,n,l,a,u,g),t.fillStyle=c,t.fill(),void t.restore();let S=d/2;"transparent"!==c&&(Q(t,n+d,l+d,a-2*d,u-2*d,J(g,-d)),t.fillStyle=c,t.fill()),"transparent"!==y&&(Q(t,n+S,l+S,a-d,u-d,J(g,-S)),t.lineWidth=d,t.strokeStyle=y,t.closePath(),t.stroke()),t.restore()}function it(t,n,l,a,u,c,d){t.save(),t.globalCompositeOperation="copy";let g=t.createLinearGradient(0,0,0,u);g.addColorStop(0,c),g.addColorStop(1,d),t.fillStyle=g,t.fillRect(n,l,a,u),t.restore()}let nt=class nt{constructor(t,n){this.it(t,n)}it(t,n){this.Lt=t,this.Gt=n}zt(t,n){return this.Lt.Tt?t.P+t.L+t.V:0}K(t,n,l,a){if(!this.Lt.Tt||0===this.Lt.Jt.length)return;let u=this.Lt.O,c=this.Gt.t,d=t.useBitmapCoordinateSpace(t=>{let d=t.context;d.font=n.R;let g=this.Qt(t,n,l,a),y=g.ti,o=(t,n)=>{g.ii?tt(d,y.ni,y.si,y.ei,y.ri,t,y.hi,[y.ot,0,0,y.ot],n):tt(d,y.li,y.si,y.ei,y.ri,t,y.hi,[0,y.ot,y.ot,0],n)};return o(c,"transparent"),this.Lt.ai&&(d.fillStyle=u,d.fillRect(y.li,y.oi,y._i-y.li,y.ui)),o("transparent",c),this.Lt.ci&&(d.fillStyle=n.A,d.fillRect(g.ii?y.di-y.hi:0,y.si,y.hi,y.fi-y.si)),g});t.useMediaCoordinateSpace(({context:t})=>{let l=d.vi;t.font=n.R,t.textAlign=d.ii?"right":"left",t.textBaseline="middle",t.fillStyle=u,t.fillText(this.Lt.Jt,l.pi,(l.si+l.fi)/2+l.mi)})}Qt(t,n,l,a){var u;let c,d,g;let{context:y,bitmapSize:S,mediaSize:_,horizontalPixelRatio:L,verticalPixelRatio:C}=t,k=this.Lt.ai||!this.Lt.bi?n.T:0,U=this.Lt.wi?n.C:0,Z=n.L+this.Gt.gi,th=n.V+this.Gt.Mi,tl=n.B,tr=n.I,to=this.Lt.Jt,ta=n.P,tu=l.xi(y,to),tc=Math.ceil(l.Si(y,to)),td=n.C+tl+tr+tc+k,tf=Math.max(1,Math.floor(C)),tv=Math.round((ta+Z+th)*C);tv%2!=tf%2&&(tv+=1);let tm=U>0?Math.max(1,Math.floor(U*L)):0,tp=Math.round(td*L),tb=Math.round(k*L),tg=null!==(u=this.Gt.ki)&&void 0!==u?u:this.Gt.yi,tw=Math.round(tg*C)-Math.floor(.5*C),ty=Math.floor(tw+tf/2-tv/2),tS=ty+tv,tM="right"===a,t_=tM?_.width-U:U,tx=tM?S.width-tm:tm;return tM?(c=tx-tp,d=tx-tb,g=t_-k-tl-U):(c=tx+tp,d=tx+tb,g=t_+k+tl),{ii:tM,ti:{si:ty,oi:tw,fi:tS,ei:tp,ri:tv,ot:2*L,hi:tm,ni:c,li:tx,_i:d,ui:tf,di:S.width},vi:{si:ty/C,fi:tS/C,pi:g,mi:tu}}}};let st=class st{constructor(t){this.Ci={yi:0,t:"#000",Mi:0,gi:0},this.Ti={Jt:"",Tt:!1,ai:!0,bi:!1,Bt:"",O:"#FFF",ci:!1,wi:!1},this.Pi={Jt:"",Tt:!1,ai:!1,bi:!0,Bt:"",O:"#FFF",ci:!0,wi:!0},this.bt=!0,this.Ri=new(t||nt)(this.Ti,this.Ci),this.Di=new(t||nt)(this.Pi,this.Ci)}Jt(){return this.Oi(),this.Ti.Jt}yi(){return this.Oi(),this.Ci.yi}gt(){this.bt=!0}zt(t,n=!1){return Math.max(this.Ri.zt(t,n),this.Di.zt(t,n))}Ai(){return this.Ci.ki||0}Vi(t){this.Ci.ki=t}Bi(){return this.Oi(),this.Ti.Tt||this.Pi.Tt}Ii(){return this.Oi(),this.Ti.Tt}xt(t){return this.Oi(),this.Ti.ai=this.Ti.ai&&t.W().ticksVisible,this.Pi.ai=this.Pi.ai&&t.W().ticksVisible,this.Ri.it(this.Ti,this.Ci),this.Di.it(this.Pi,this.Ci),this.Ri}zi(){return this.Oi(),this.Ri.it(this.Ti,this.Ci),this.Di.it(this.Pi,this.Ci),this.Di}Oi(){this.bt&&(this.Ti.ai=!0,this.Pi.ai=!1,this.Ei(this.Ti,this.Pi,this.Ci))}};let et=class et extends st{constructor(t,n,l){super(),this.$t=t,this.Li=n,this.Ni=l}Ei(t,n,l){if(t.Tt=!1,2===this.$t.W().mode)return;let a=this.$t.W().horzLine;if(!a.labelVisible)return;let u=this.Li.Pt();if(!this.$t.Tt()||this.Li.Fi()||null===u)return;let c=P(a.labelBackgroundColor);l.t=c.t,t.O=c.i;let d=2/12*this.Li.P();l.gi=d,l.Mi=d;let g=this.Ni(this.Li);l.yi=g.yi,t.Jt=this.Li.Wi(g.ct,u),t.Tt=!0}};let tk=/[1-9]/g;let ht=class ht{constructor(){this.Lt=null}it(t){this.Lt=t}K(t,n){if(null===this.Lt||!1===this.Lt.Tt||0===this.Lt.Jt.length)return;let l=t.useMediaCoordinateSpace(({context:t})=>(t.font=n.R,Math.round(n.ji.Si(t,b(this.Lt).Jt,tk))));if(l<=0)return;let a=n.Hi,u=l+2*a,c=u/2,d=this.Lt.$i,g=this.Lt.yi,y=Math.floor(g-c)+.5;y<0?(g+=Math.abs(0-y),y=Math.floor(g-c)+.5):y+u>d&&(g-=Math.abs(d-(y+u)),y=Math.floor(g-c)+.5);let S=y+u,_=Math.ceil(0+n.C+n.T+n.L+n.P+n.V);t.useBitmapCoordinateSpace(({context:t,horizontalPixelRatio:l,verticalPixelRatio:a})=>{let u=b(this.Lt);t.fillStyle=u.t;let c=Math.round(y*l),d=Math.round(0*a),g=Math.round(S*l),L=Math.round(_*a),C=Math.round(2*l);if(t.beginPath(),t.moveTo(c,d),t.lineTo(c,L-C),t.arcTo(c,L,c+C,L,C),t.lineTo(g-C,L),t.arcTo(g,L,g,L-C,C),t.lineTo(g,d),t.fill(),u.ai){let c=Math.round(u.yi*l),g=Math.round((d+n.T)*a);t.fillStyle=u.O;let y=Math.max(1,Math.floor(l)),S=Math.floor(.5*l);t.fillRect(c-S,d,y,g-d)}}),t.useMediaCoordinateSpace(({context:t})=>{let l=b(this.Lt),u=0+n.C+n.T+n.L+n.P/2;t.font=n.R,t.textAlign="left",t.textBaseline="middle",t.fillStyle=l.O;let c=n.ji.xi(t,"Apr0");t.translate(y+a,u+c),t.fillText(l.Jt,0,0)})}};let lt=class lt{constructor(t,n,l){this.bt=!0,this.Ht=new ht,this.jt={Tt:!1,t:"#4c525e",O:"white",Jt:"",$i:0,yi:NaN,ai:!0},this.wt=t,this.Ui=n,this.Ni=l}gt(){this.bt=!0}xt(){return this.bt&&(this.St(),this.bt=!1),this.Ht.it(this.jt),this.Ht}St(){let t=this.jt;if(t.Tt=!1,2===this.wt.W().mode)return;let n=this.wt.W().vertLine;if(!n.labelVisible)return;let l=this.Ui.yt();if(l.Fi())return;t.$i=l.$i();let a=this.Ni();if(null===a)return;t.yi=a.yi;let u=l.qi(this.wt.kt());t.Jt=l.Yi(b(u)),t.Tt=!0;let c=P(n.labelBackgroundColor);t.t=c.t,t.O=c.i,t.ai=l.W().ticksVisible}};let at=class at{constructor(){this.Xi=null,this.Ki=0}Zi(){return this.Ki}Gi(t){this.Ki=t}At(){return this.Xi}Ji(t){this.Xi=t}Qi(t){return[]}tn(){return[]}Tt(){return!0}};(c=Z||(Z={}))[c.Normal=0]="Normal",c[c.Magnet=1]="Magnet",c[c.Hidden=2]="Hidden";let _t=class _t extends at{constructor(t,n){var l,a,u,c;super(),this.nn=null,this.sn=NaN,this.en=0,this.rn=!0,this.hn=new Map,this.ln=!1,this.an=NaN,this.on=NaN,this._n=NaN,this.un=NaN,this.Ui=t,this.cn=n,this.dn=new q(t,this),this.fn=(l=()=>this.sn,a=()=>this.on,t=>{let n=a(),u=l();if(t===b(this.nn).vn())return{ct:u,yi:n};{let l=b(t.Pt());return{ct:t.pn(n,l),yi:n}}});let d=(u=()=>this.en,c=()=>this.Kt(),()=>{let t=this.Ui.yt().mn(u()),n=c();return t&&Number.isFinite(n)?{ut:t,yi:n}:null});this.bn=new lt(this,t,d),this.wn=new K(this)}W(){return this.cn}gn(t,n){this._n=t,this.un=n}Mn(){this._n=NaN,this.un=NaN}xn(){return this._n}Sn(){return this.un}kn(t,n,l){this.ln||(this.ln=!0),this.rn=!0,this.yn(t,n,l)}kt(){return this.en}Kt(){return this.an}Zt(){return this.on}Tt(){return this.rn}Cn(){this.rn=!1,this.Tn(),this.sn=NaN,this.an=NaN,this.on=NaN,this.nn=null,this.Mn()}Pn(t){return null!==this.nn?[this.wn,this.dn]:[]}Yt(t){return t===this.nn&&this.cn.horzLine.visible}Xt(){return this.cn.vertLine.visible}Rn(t,n){this.rn&&this.nn===t||this.hn.clear();let l=[];return this.nn===t&&l.push(this.Dn(this.hn,n,this.fn)),l}tn(){return this.rn?[this.bn]:[]}Ut(){return this.nn}On(){this.wn.gt(),this.hn.forEach(t=>t.gt()),this.bn.gt(),this.dn.gt()}An(t){return t&&!t.vn().Fi()?t.vn():null}yn(t,n,l){this.Vn(t,n,l)&&this.On()}Vn(t,n,l){let a=this.an,u=this.on,c=this.sn,d=this.en,g=this.nn,y=this.An(l);this.en=t,this.an=isNaN(t)?NaN:this.Ui.yt().Et(t),this.nn=l;let S=null!==y?y.Pt():null;return null!==y&&null!==S?(this.sn=n,this.on=y.Ot(n,S)):(this.sn=NaN,this.on=NaN),a!==this.an||u!==this.on||d!==this.en||c!==this.sn||g!==this.nn}Tn(){let t=this.Ui.Mt().map(t=>t.In().Bn()).filter(z),n=0===t.length?null:Math.max(...t);this.en=null!==n?n:NaN}Dn(t,n,l){let a=t.get(n);return void 0===a&&(a=new et(this,n,l),t.set(n,a)),a}};function ut(t){return"left"===t||"right"===t}let ct=class ct{constructor(t){this.zn=new Map,this.En=[],this.Ln=t}Nn(t,n){var l;let a=void 0===(l=this.zn.get(t))?n:{Fn:Math.max(l.Fn,n.Fn),Wn:l.Wn||n.Wn};this.zn.set(t,a)}jn(){return this.Ln}Hn(t){let n=this.zn.get(t);return void 0===n?{Fn:this.Ln}:{Fn:Math.max(this.Ln,n.Fn),Wn:n.Wn}}$n(){this.Un(),this.En=[{qn:0}]}Yn(t){this.Un(),this.En=[{qn:1,Vt:t}]}Xn(t){this.Kn(),this.En.push({qn:5,Vt:t})}Un(){this.Kn(),this.En.push({qn:6})}Zn(){this.Un(),this.En=[{qn:4}]}Gn(t){this.Un(),this.En.push({qn:2,Vt:t})}Jn(t){this.Un(),this.En.push({qn:3,Vt:t})}Qn(){return this.En}ts(t){for(let n of t.En)this.ns(n);this.Ln=Math.max(this.Ln,t.Ln),t.zn.forEach((t,n)=>{this.Nn(n,t)})}static ss(){return new ct(2)}static es(){return new ct(3)}ns(t){switch(t.qn){case 0:this.$n();break;case 1:this.Yn(t.Vt);break;case 2:this.Gn(t.Vt);break;case 3:this.Jn(t.Vt);break;case 4:this.Zn();break;case 5:this.Xn(t.Vt);break;case 6:this.Kn()}}Kn(){let t=this.En.findIndex(t=>5===t.qn);-1!==t&&this.En.splice(t,1)}};function ft(t,n){if(!O(t))return"n/a";if(!A(n)||n<0||n>16)throw TypeError("invalid length");return 0===n?t.toString():("0000000000000000"+t.toString()).slice(-n)}let vt=class vt{constructor(t,n){if(n||(n=1),O(t)&&A(t)||(t=100),t<0)throw TypeError("invalid base");this.Li=t,this.rs=n,this.hs()}format(t){let n=t<0?"−":"";return t=Math.abs(t),n+this.ls(t)}hs(){if(this.os=0,this.Li>0&&this.rs>0){let t=this.Li;for(;t>1;)t/=10,this.os++}}ls(t){let n=this.Li/this.rs,l=Math.floor(t),a="",u=void 0!==this.os?this.os:NaN;if(n>1){let c=+(Math.round(t*n)-l*n).toFixed(this.os);c>=n&&(c-=n,l+=1),a="."+ft(+c.toFixed(this.os)*this.rs,u)}else l=Math.round(l*n)/n,u>0&&(a="."+ft(0,u));return l.toFixed(0)+a}};let pt=class pt extends vt{constructor(t=100){super(t)}format(t){return`${super.format(t)}%`}};let mt=class mt{constructor(t){this._s=t}format(t){let n="";return t<0&&(n="-",t=-t),t<995?n+this.us(t):t<999995?n+this.us(t/1e3)+"K":t<999999995?(t=1e3*Math.round(t/1e3),n+this.us(t/1e6)+"M"):(t=1e6*Math.round(t/1e6),n+this.us(t/1e9)+"B")}us(t){let n=Math.pow(10,this._s);return((t=Math.round(t*n)/n)>=1e-15&&t<1?t.toFixed(this._s).replace(/\.?0+$/,""):String(t)).replace(/(\.[1-9]*)0+$/,(t,n)=>n)}};function bt(t,n,l,a,u,c,d){if(0===n.length||a.from>=n.length||a.to<=0)return;let{context:g,horizontalPixelRatio:y,verticalPixelRatio:S}=t,_=n[a.from],L=c(t,_),C=_;if(a.to-a.from<2){let n=u/2;g.beginPath();let l={et:_.et-n,rt:_.rt},a={et:_.et+n,rt:_.rt};g.moveTo(l.et*y,l.rt*S),g.lineTo(a.et*y,a.rt*S),d(t,L,l,a)}else{let e=(n,l)=>{d(t,L,C,l),g.beginPath(),L=n,C=l},u=C;g.beginPath(),g.moveTo(_.et*y,_.rt*S);for(let d=a.from+1;d<a.to;++d){u=n[d];let a=c(t,u);switch(l){case 0:g.lineTo(u.et*y,u.rt*S);break;case 1:g.lineTo(u.et*y,n[d-1].rt*S),a!==L&&(e(a,u),g.lineTo(u.et*y,n[d-1].rt*S)),g.lineTo(u.et*y,u.rt*S);break;case 2:{let[t,l]=function(t,n,l){var a,u;let c=Math.min(t.length-1,l+1);return[(a=t[n],u=Mt(gt(t[l],t[Math.max(0,n-1)]),6),{et:a.et+u.et,rt:a.rt+u.rt}),gt(t[l],Mt(gt(t[c],t[n]),6))]}(n,d-1,d);g.bezierCurveTo(t.et*y,t.rt*S,l.et*y,l.rt*S,u.et*y,u.rt*S)}}1!==l&&a!==L&&(e(a,u),g.moveTo(u.et*y,u.rt*S))}(C!==u||C===u&&1===l)&&d(t,L,C,u)}}function gt(t,n){return{et:t.et-n.et,rt:t.rt-n.rt}}function Mt(t,n){return{et:t.et/n,rt:t.rt/n}}function St(t,n,l,a,u){let{context:c,horizontalPixelRatio:d,verticalPixelRatio:g}=n;c.lineTo(u.et*d,t*g),c.lineTo(a.et*d,t*g),c.closePath(),c.fillStyle=l,c.fill()}let kt=class kt extends Y{constructor(){super(...arguments),this.tt=null}it(t){this.tt=t}Z(t){var n;if(null===this.tt)return;let{st:l,nt:a,cs:u,ht:c,Wt:d,ds:g}=this.tt,y=null!==(n=this.tt.fs)&&void 0!==n?n:this.tt.vs?0:t.mediaSize.height;if(null===a)return;let S=t.context;S.lineCap="butt",S.lineJoin="round",S.lineWidth=c,f(S,d),S.lineWidth=1,bt(t,l,g,a,u,this.ps.bind(this),St.bind(null,y))}};function yt(t,n,l){return Math.min(Math.max(t,n),l)}function Tt(t){let n=Math.ceil(t);return n%2==0?n-1:n}let Pt=class Pt{bs(t,n){let l=this.ws,{gs:a,Ms:u,xs:c,Ss:d,ks:g,fs:y}=n;if(void 0===this.ys||void 0===l||l.gs!==a||l.Ms!==u||l.xs!==c||l.Ss!==d||l.fs!==y||l.ks!==g){let l=t.context.createLinearGradient(0,0,0,g);if(l.addColorStop(0,a),null!=y){let n=yt(y*t.verticalPixelRatio/g,0,1);l.addColorStop(n,u),l.addColorStop(n,c)}l.addColorStop(1,d),this.ys=l,this.ws=n}return this.ys}};let Rt=class Rt extends kt{constructor(){super(...arguments),this.Cs=new Pt}ps(t,n){return this.Cs.bs(t,{gs:n.Ts,Ms:"",xs:"",Ss:n.Ps,ks:t.bitmapSize.height})}};function Dt(t,n){let l=t.context;l.strokeStyle=n,l.stroke()}let Ot=class Ot extends Y{constructor(){super(...arguments),this.tt=null}it(t){this.tt=t}Z(t){if(null===this.tt)return;let{st:n,nt:l,cs:a,ds:u,ht:c,Wt:d,Rs:g}=this.tt;if(null===l)return;let y=t.context;y.lineCap="butt",y.lineWidth=c*t.verticalPixelRatio,f(y,d),y.lineJoin="round";let S=this.Ds.bind(this);void 0!==u&&bt(t,n,u,l,a,S,Dt),g&&function(t,n,l,a,u){let{horizontalPixelRatio:c,verticalPixelRatio:d,context:g}=t,y=null,S=Math.max(1,Math.floor(c))%2/2,_=l*d+S;for(let l=a.to-1;l>=a.from;--l){let a=n[l];if(a){let n=u(t,a);n!==y&&(g.beginPath(),null!==y&&g.fill(),g.fillStyle=n,y=n);let l=Math.round(a.et*c)+S,L=a.rt*d;g.moveTo(l,L),g.arc(l,L,_,0,2*Math.PI)}}g.fill()}(t,n,g,l,S)}};let At=class At extends Ot{Ds(t,n){return n._t}};function Vt(t,n,l,a,u=0,c=n.length){let d=c-u;for(;0<d;){let c=d>>1,g=u+c;a(n[g],l)===t?(u=g+1,d-=c+1):d=c}return u}let tP=Vt.bind(null,!0),tR=Vt.bind(null,!1);function zt(t,n){return t.ut<n}function Et(t,n){return n<t.ut}function Lt(t,n,l){let a=n.Os(),u=n.di(),c=tP(t,a,zt),d=tR(t,u,Et);if(!l)return{from:c,to:d};let g=c,y=d;return c>0&&c<t.length&&t[c].ut>=a&&(g=c-1),d>0&&d<t.length&&t[d-1].ut<=u&&(y=d+1),{from:g,to:y}}let Nt=class Nt{constructor(t,n,l){this.As=!0,this.Vs=!0,this.Bs=!0,this.Is=[],this.zs=null,this.Es=t,this.Ls=n,this.Ns=l}gt(t){this.As=!0,"data"===t&&(this.Vs=!0),"options"===t&&(this.Bs=!0)}xt(){return this.Es.Tt()?(this.Fs(),null===this.zs?null:this.Ws):null}js(){this.Is=this.Is.map(t=>Object.assign(Object.assign({},t),this.Es.$s().Hs(t.ut)))}Us(){this.zs=null}Fs(){this.Vs&&(this.qs(),this.Vs=!1),this.Bs&&(this.js(),this.Bs=!1),this.As&&(this.Ys(),this.As=!1)}Ys(){let t=this.Es.At(),n=this.Ls.yt();if(this.Us(),n.Fi()||t.Fi())return;let l=n.Xs();if(null===l||0===this.Es.In().Ks())return;let a=this.Es.Pt();null!==a&&(this.zs=Lt(this.Is,l,this.Ns),this.Zs(t,n,a.Vt),this.Gs())}};let Ft=class Ft extends Nt{constructor(t,n){super(t,n,!0)}Zs(t,n,l){n.Js(this.Is,E(this.zs)),t.Qs(this.Is,l,E(this.zs))}te(t,n){return{ut:t,ct:n,et:NaN,rt:NaN}}qs(){let t=this.Es.$s();this.Is=this.Es.In().ie().map(n=>{let l=n.Vt[3];return this.ne(n.se,l,t)})}};let Wt=class Wt extends Ft{constructor(t,n){super(t,n),this.Ws=new W,this.ee=new Rt,this.re=new At,this.Ws.X([this.ee,this.re])}ne(t,n,l){return Object.assign(Object.assign({},this.te(t,n)),l.Hs(t))}Gs(){let t=this.Es.W();this.ee.it({ds:t.lineType,st:this.Is,Wt:t.lineStyle,ht:t.lineWidth,fs:null,vs:t.invertFilledArea,nt:this.zs,cs:this.Ls.yt().he()}),this.re.it({ds:t.lineVisible?t.lineType:void 0,st:this.Is,Wt:t.lineStyle,ht:t.lineWidth,nt:this.zs,cs:this.Ls.yt().he(),Rs:t.pointMarkersVisible?t.pointMarkersRadius||t.lineWidth/2+2:void 0})}};let jt=class jt extends Y{constructor(){super(...arguments),this.Lt=null,this.le=0,this.ae=0}it(t){this.Lt=t}Z({context:t,horizontalPixelRatio:n,verticalPixelRatio:l}){if(null===this.Lt||0===this.Lt.In.length||null===this.Lt.nt)return;this.le=this.oe(n),this.le>=2&&Math.max(1,Math.floor(n))%2!=this.le%2&&this.le--,this.ae=this.Lt._e?Math.min(this.le,Math.floor(n)):this.le;let a=null,u=this.ae<=this.le&&this.Lt.he>=Math.floor(1.5*n);for(let c=this.Lt.nt.from;c<this.Lt.nt.to;++c){let d=this.Lt.In[c];a!==d.ue&&(t.fillStyle=d.ue,a=d.ue);let g=Math.floor(.5*this.ae),y=Math.round(d.et*n),S=y-g,_=this.ae,L=S+_-1,C=Math.min(d.ce,d.de),k=Math.max(d.ce,d.de),U=Math.round(C*l)-g,Z=Math.round(k*l)+g,th=Math.max(Z-U,this.ae);t.fillRect(S,U,_,th);let tl=Math.ceil(1.5*this.le);if(u){if(this.Lt.fe){let n=y-tl,a=Math.max(U,Math.round(d.ve*l)-g),u=a+_-1;u>U+th-1&&(a=(u=U+th-1)-_+1),t.fillRect(n,a,S-n,u-a+1)}let n=y+tl,a=Math.max(U,Math.round(d.pe*l)-g),u=a+_-1;u>U+th-1&&(a=(u=U+th-1)-_+1),t.fillRect(L+1,a,n-L,u-a+1)}}}oe(t){return Math.max(Math.floor(t),Math.floor(Math.floor(.3*b(this.Lt).he*t)))}};let Ht=class Ht extends Nt{constructor(t,n){super(t,n,!1)}Zs(t,n,l){n.Js(this.Is,E(this.zs)),t.me(this.Is,l,E(this.zs))}be(t,n,l){return{ut:t,we:n.Vt[0],ge:n.Vt[1],Me:n.Vt[2],xe:n.Vt[3],et:NaN,ve:NaN,ce:NaN,de:NaN,pe:NaN}}qs(){let t=this.Es.$s();this.Is=this.Es.In().ie().map(n=>this.ne(n.se,n,t))}};let $t=class $t extends Ht{constructor(){super(...arguments),this.Ws=new jt}ne(t,n,l){return Object.assign(Object.assign({},this.be(t,n,l)),l.Hs(t))}Gs(){let t=this.Es.W();this.Ws.it({In:this.Is,he:this.Ls.yt().he(),fe:t.openVisible,_e:t.thinBars,nt:this.zs})}};let Ut=class Ut extends kt{constructor(){super(...arguments),this.Cs=new Pt}ps(t,n){let l=this.tt;return this.Cs.bs(t,{gs:n.Se,Ms:n.ke,xs:n.ye,Ss:n.Ce,ks:t.bitmapSize.height,fs:l.fs})}};let qt=class qt extends Ot{constructor(){super(...arguments),this.Te=new Pt}Ds(t,n){let l=this.tt;return this.Te.bs(t,{gs:n.Pe,Ms:n.Pe,xs:n.Re,Ss:n.Re,ks:t.bitmapSize.height,fs:l.fs})}};let Yt=class Yt extends Ft{constructor(t,n){super(t,n),this.Ws=new W,this.De=new Ut,this.Oe=new qt,this.Ws.X([this.De,this.Oe])}ne(t,n,l){return Object.assign(Object.assign({},this.te(t,n)),l.Hs(t))}Gs(){let t=this.Es.Pt();if(null===t)return;let n=this.Es.W(),l=this.Es.At().Ot(n.baseValue.price,t.Vt),a=this.Ls.yt().he();this.De.it({st:this.Is,ht:n.lineWidth,Wt:n.lineStyle,ds:n.lineType,fs:l,vs:!1,nt:this.zs,cs:a}),this.Oe.it({st:this.Is,ht:n.lineWidth,Wt:n.lineStyle,ds:n.lineVisible?n.lineType:void 0,Rs:n.pointMarkersVisible?n.pointMarkersRadius||n.lineWidth/2+2:void 0,fs:l,nt:this.zs,cs:a})}};let Xt=class Xt extends Y{constructor(){super(...arguments),this.Lt=null,this.le=0}it(t){this.Lt=t}Z(t){var n;if(null===this.Lt||0===this.Lt.In.length||null===this.Lt.nt)return;let{horizontalPixelRatio:l}=t;this.le=(n=this.Lt.he)>=2.5&&n<=4?Math.floor(3*l):Math.max(Math.floor(l),Math.min(Math.floor(n*(1-.2*Math.atan(Math.max(4,n)-4)/(.5*Math.PI))*l),Math.floor(n*l))),this.le>=2&&Math.floor(l)%2!=this.le%2&&this.le--;let a=this.Lt.In;this.Lt.Ae&&this.Ve(t,a,this.Lt.nt),this.Lt.ci&&this.Be(t,a,this.Lt.nt);let u=this.Ie(l);(!this.Lt.ci||this.le>2*u)&&this.ze(t,a,this.Lt.nt)}Ve(t,n,l){if(null===this.Lt)return;let{context:a,horizontalPixelRatio:u,verticalPixelRatio:c}=t,d="",g=Math.min(Math.floor(u),Math.floor(this.Lt.he*u));g=Math.max(Math.floor(u),Math.min(g,this.le));let y=Math.floor(.5*g),S=null;for(let t=l.from;t<l.to;t++){let l=n[t];l.Ee!==d&&(a.fillStyle=l.Ee,d=l.Ee);let _=Math.round(Math.min(l.ve,l.pe)*c),L=Math.round(Math.max(l.ve,l.pe)*c),C=Math.round(l.ce*c),k=Math.round(l.de*c),U=Math.round(u*l.et)-y,Z=U+g-1;null!==S&&(U=Math.min(U=Math.max(S+1,U),Z));let th=Z-U+1;a.fillRect(U,C,th,_-C),a.fillRect(U,L+1,th,k-L),S=Z}}Ie(t){let n=Math.floor(1*t);this.le<=2*n&&(n=Math.floor(.5*(this.le-1)));let l=Math.max(Math.floor(t),n);return this.le<=2*l?Math.max(Math.floor(t),Math.floor(1*t)):l}Be(t,n,l){if(null===this.Lt)return;let{context:a,horizontalPixelRatio:u,verticalPixelRatio:c}=t,d="",g=this.Ie(u),y=null;for(let t=l.from;t<l.to;t++){let l=n[t];l.Le!==d&&(a.fillStyle=l.Le,d=l.Le);let C=Math.round(l.et*u)-Math.floor(.5*this.le),k=C+this.le-1,U=Math.round(Math.min(l.ve,l.pe)*c),Z=Math.round(Math.max(l.ve,l.pe)*c);if(null!==y&&(C=Math.min(C=Math.max(y+1,C),k)),this.Lt.he*u>2*g){var S,_,L;S=C,_=k-C+1,L=Z-U+1,a.fillRect(S+g,U,_-2*g,g),a.fillRect(S+g,U+L-g,_-2*g,g),a.fillRect(S,U,g,L),a.fillRect(S+_-g,U,g,L)}else{let t=k-C+1;a.fillRect(C,U,t,Z-U+1)}y=k}}ze(t,n,l){if(null===this.Lt)return;let{context:a,horizontalPixelRatio:u,verticalPixelRatio:c}=t,d="",g=this.Ie(u);for(let t=l.from;t<l.to;t++){let l=n[t],y=Math.round(Math.min(l.ve,l.pe)*c),S=Math.round(Math.max(l.ve,l.pe)*c),_=Math.round(l.et*u)-Math.floor(.5*this.le),L=_+this.le-1;if(l.ue!==d){let t=l.ue;a.fillStyle=t,d=t}this.Lt.ci&&(_+=g,y+=g,L-=g,S-=g),y>S||a.fillRect(_,y,L-_+1,S-y+1)}}};let Kt=class Kt extends Ht{constructor(){super(...arguments),this.Ws=new Xt}ne(t,n,l){return Object.assign(Object.assign({},this.be(t,n,l)),l.Hs(t))}Gs(){let t=this.Es.W();this.Ws.it({In:this.Is,he:this.Ls.yt().he(),Ae:t.wickVisible,ci:t.borderVisible,nt:this.zs})}};let Zt=class Zt{constructor(t,n){this.Ne=t,this.Li=n}K(t,n,l){this.Ne.draw(t,this.Li,n,l)}};let Gt=class Gt extends Nt{constructor(t,n,l){super(t,n,!1),this.wn=l,this.Ws=new Zt(this.wn.renderer(),n=>{let l=t.Pt();return null===l?null:t.At().Ot(n,l.Vt)})}Fe(t){return this.wn.priceValueBuilder(t)}We(t){return this.wn.isWhitespace(t)}qs(){let t=this.Es.$s();this.Is=this.Es.In().ie().map(n=>Object.assign(Object.assign({ut:n.se,et:NaN},t.Hs(n.se)),{je:n.He}))}Zs(t,n){n.Js(this.Is,E(this.zs))}Gs(){this.wn.update({bars:this.Is.map(Jt),barSpacing:this.Ls.yt().he(),visibleRange:this.zs},this.Es.W())}};function Jt(t){return{x:t.et,time:t.ut,originalData:t.je,barColor:t.ue}}let Qt=class Qt extends Y{constructor(){super(...arguments),this.Lt=null,this.$e=[]}it(t){this.Lt=t,this.$e=[]}Z({context:t,horizontalPixelRatio:n,verticalPixelRatio:l}){if(null===this.Lt||0===this.Lt.st.length||null===this.Lt.nt)return;this.$e.length||this.Ue(n);let a=Math.max(1,Math.floor(l)),u=Math.round(this.Lt.qe*l)-Math.floor(a/2),c=u+a;for(let n=this.Lt.nt.from;n<this.Lt.nt.to;n++){let d,g;let y=this.Lt.st[n],S=this.$e[n-this.Lt.nt.from],_=Math.round(y.rt*l);t.fillStyle=y.ue,_<=u?(d=_,g=c):(d=u,g=_-Math.floor(a/2)+a),t.fillRect(S.Os,d,S.di-S.Os+1,g-d)}}Ue(t){if(null===this.Lt||0===this.Lt.st.length||null===this.Lt.nt)return void(this.$e=[]);let n=1>=Math.ceil(this.Lt.he*t)?0:Math.max(1,Math.floor(t)),l=Math.round(this.Lt.he*t)-n;this.$e=Array(this.Lt.nt.to-this.Lt.nt.from);for(let n=this.Lt.nt.from;n<this.Lt.nt.to;n++){let a,u;let c=this.Lt.st[n],d=Math.round(c.et*t);if(l%2){let t=(l-1)/2;a=d-t,u=d+t}else{let t=l/2;a=d-t,u=d+t-1}this.$e[n-this.Lt.nt.from]={Os:a,di:u,Ye:d,Xe:c.et*t,ut:c.ut}}for(let t=this.Lt.nt.from+1;t<this.Lt.nt.to;t++){let l=this.$e[t-this.Lt.nt.from],a=this.$e[t-this.Lt.nt.from-1];l.ut===a.ut+1&&l.Os-a.di!==n+1&&(a.Ye>a.Xe?a.di=l.Os-n-1:l.Os=a.di+n+1)}let a=Math.ceil(this.Lt.he*t);for(let t=this.Lt.nt.from;t<this.Lt.nt.to;t++){let n=this.$e[t-this.Lt.nt.from];n.di<n.Os&&(n.di=n.Os);let l=n.di-n.Os+1;a=Math.min(l,a)}if(n>0&&a<4)for(let t=this.Lt.nt.from;t<this.Lt.nt.to;t++){let n=this.$e[t-this.Lt.nt.from];n.di-n.Os+1>a&&(n.Ye>n.Xe?n.di-=1:n.Os+=1)}}};let ti=class ti extends Ft{constructor(){super(...arguments),this.Ws=new Qt}ne(t,n,l){return Object.assign(Object.assign({},this.te(t,n)),l.Hs(t))}Gs(){let t={st:this.Is,he:this.Ls.yt().he(),nt:this.zs,qe:this.Es.At().Ot(this.Es.W().base,b(this.Es.Pt()).Vt)};this.Ws.it(t)}};let ii=class ii extends Ft{constructor(){super(...arguments),this.Ws=new At}ne(t,n,l){return Object.assign(Object.assign({},this.te(t,n)),l.Hs(t))}Gs(){let t=this.Es.W(),n={st:this.Is,Wt:t.lineStyle,ds:t.lineVisible?t.lineType:void 0,ht:t.lineWidth,Rs:t.pointMarkersVisible?t.pointMarkersRadius||t.lineWidth/2+2:void 0,nt:this.zs,cs:this.Ls.yt().he()};this.Ws.it(n)}};let tW=/[2-9]/g;let si=class si{constructor(t=50){this.Ke=0,this.Ze=1,this.Ge=1,this.Je={},this.Qe=new Map,this.tr=t}ir(){this.Ke=0,this.Qe.clear(),this.Ze=1,this.Ge=1,this.Je={}}Si(t,n,l){return this.nr(t,n,l).width}xi(t,n,l){let a=this.nr(t,n,l);return((a.actualBoundingBoxAscent||0)-(a.actualBoundingBoxDescent||0))/2}nr(t,n,l){let a=String(n).replace(l||tW,"0");if(this.Qe.has(a))return m(this.Qe.get(a)).sr;if(this.Ke===this.tr){let t=this.Je[this.Ge];delete this.Je[this.Ge],this.Qe.delete(t),this.Ge++,this.Ke--}t.save(),t.textBaseline="middle";let u=t.measureText(a);return t.restore(),0===u.width&&n.length||(this.Qe.set(a,{sr:u,er:this.Ze}),this.Je[this.Ze]=a,this.Ke++,this.Ze++),u}};let ei=class ei{constructor(t){this.rr=null,this.k=null,this.hr="right",this.lr=t}ar(t,n,l){this.rr=t,this.k=n,this.hr=l}K(t){null!==this.k&&null!==this.rr&&this.rr.K(t,this.k,this.lr,this.hr)}};let ri=class ri{constructor(t,n,l){this._r=t,this.lr=new si(50),this.ur=n,this.F=l,this.j=-1,this.Ht=new ei(this.lr)}xt(){let t=this.F.cr(this.ur);if(null===t)return null;let n=t.dr(this.ur)?t.vr():this.ur.At();if(null===n)return null;let l=t.pr(n);if("overlay"===l)return null;let a=this.F.mr();return a.P!==this.j&&(this.j=a.P,this.lr.ir()),this.Ht.ar(this._r.zi(),a,l),this.Ht}};let hi=class hi extends Y{constructor(){super(...arguments),this.Lt=null}it(t){this.Lt=t}br(t,n){var l;if(!(null===(l=this.Lt)||void 0===l?void 0:l.Tt))return null;let{rt:a,ht:u,wr:c}=this.Lt;return n>=a-u-7&&n<=a+u+7?{gr:this.Lt,wr:c}:null}Z({context:t,bitmapSize:n,horizontalPixelRatio:l,verticalPixelRatio:a}){if(null===this.Lt||!1===this.Lt.Tt)return;let u=Math.round(this.Lt.rt*a);u<0||u>n.height||(t.lineCap="butt",t.strokeStyle=this.Lt.O,t.lineWidth=Math.floor(this.Lt.ht*l),f(t,this.Lt.Wt),v(t,u,0,n.width))}};let li=class li{constructor(t){this.Mr={rt:0,O:"rgba(0, 0, 0, 0)",ht:1,Wt:0,Tt:!1},this.Sr=new hi,this.bt=!0,this.Es=t,this.Ls=t.qt(),this.Sr.it(this.Mr)}gt(){this.bt=!0}xt(){return this.Es.Tt()?(this.bt&&(this.kr(),this.bt=!1),this.Sr):null}};let ai=class ai extends li{constructor(t){super(t)}kr(){this.Mr.Tt=!1;let t=this.Es.At(),n=t.yr().yr;if(2!==n&&3!==n)return;let l=this.Es.W();if(!l.baseLineVisible||!this.Es.Tt())return;let a=this.Es.Pt();null!==a&&(this.Mr.Tt=!0,this.Mr.rt=t.Ot(a.Vt,a.Vt),this.Mr.O=l.baseLineColor,this.Mr.ht=l.baseLineWidth,this.Mr.Wt=l.baseLineStyle)}};let oi=class oi extends Y{constructor(){super(...arguments),this.Lt=null}it(t){this.Lt=t}He(){return this.Lt}Z({context:t,horizontalPixelRatio:n,verticalPixelRatio:l}){let a=this.Lt;if(null===a)return;let u=Math.max(1,Math.floor(n)),c=u%2/2,d=Math.round(a.Xe.x*n)+c,g=a.Xe.y*l;t.fillStyle=a.Cr,t.beginPath();let y=Math.max(2,1.5*a.Tr)*n;t.arc(d,g,y,0,2*Math.PI,!1),t.fill(),t.fillStyle=a.Pr,t.beginPath(),t.arc(d,g,a.ot*n,0,2*Math.PI,!1),t.fill(),t.lineWidth=u,t.strokeStyle=a.Rr,t.beginPath(),t.arc(d,g,a.ot*n+u/2,0,2*Math.PI,!1),t.stroke()}};let tB=[{Dr:0,Or:.25,Ar:4,Vr:10,Br:.25,Ir:0,zr:.4,Er:.8},{Dr:.25,Or:.525,Ar:10,Vr:14,Br:0,Ir:0,zr:.8,Er:0},{Dr:.525,Or:1,Ar:14,Vr:14,Br:0,Ir:0,zr:0,Er:0}];function ui(t,n,l,a){return function(t,n){if("transparent"===t)return t;let l=T(t),a=l[3];return`rgba(${l[0]}, ${l[1]}, ${l[2]}, ${n*a})`}(t,l+(a-l)*n)}function ci(t,n){var l;let a;let u=t%2600/2600;for(let t of tB)if(u>=t.Dr&&u<=t.Or){a=t;break}p(void 0!==a,"Last price animation internal logic error");let c=(u-a.Dr)/(a.Or-a.Dr);return{Pr:ui(n,c,a.Br,a.Ir),Rr:ui(n,c,a.zr,a.Er),ot:(l=a.Ar)+(a.Vr-l)*c}}let di=class di{constructor(t){this.Ht=new oi,this.bt=!0,this.Lr=!0,this.Nr=performance.now(),this.Fr=this.Nr-1,this.Wr=t}jr(){this.Fr=this.Nr-1,this.gt()}Hr(){if(this.gt(),2===this.Wr.W().lastPriceAnimation){let t=performance.now(),n=this.Fr-t;if(n>0)return void(n<650&&(this.Fr+=2600));this.Nr=t,this.Fr=t+2600}}gt(){this.bt=!0}$r(){this.Lr=!0}Tt(){return 0!==this.Wr.W().lastPriceAnimation}Ur(){switch(this.Wr.W().lastPriceAnimation){case 0:return!1;case 1:return!0;case 2:return performance.now()<=this.Fr}}xt(){return this.bt?(this.St(),this.bt=!1,this.Lr=!1):this.Lr&&(this.qr(),this.Lr=!1),this.Ht}St(){this.Ht.it(null);let t=this.Wr.qt().yt(),n=t.Xs(),l=this.Wr.Pt();if(null===n||null===l)return;let a=this.Wr.Yr(!0);if(a.Xr||!n.Kr(a.se))return;let u={x:t.Et(a.se),y:this.Wr.At().Ot(a.ct,l.Vt)},c=a.O,d=this.Wr.W().lineWidth,g=ci(this.Zr(),c);this.Ht.it({Cr:c,Tr:d,Pr:g.Pr,Rr:g.Rr,ot:g.ot,Xe:u})}qr(){let t=this.Ht.He();if(null!==t){let n=ci(this.Zr(),t.Cr);t.Pr=n.Pr,t.Rr=n.Rr,t.ot=n.ot}}Zr(){return this.Ur()?performance.now()-this.Nr:2599}};function fi(t,n){return Tt(Math.min(Math.max(t,12),30)*n)}function vi(t,n){switch(t){case"arrowDown":case"arrowUp":return fi(n,1);case"circle":return fi(n,.8);case"square":return fi(n,.7)}}function pi(t){return function(t){let n=Math.ceil(t);return n%2!=0?n-1:n}(fi(t,1))}function mi(t){return Math.max(fi(t,.1),3)}function bi(t,n,l,a,u){let c=vi("square",l),d=(c-1)/2,g=t-d,y=n-d;return a>=g&&a<=g+c&&u>=y&&u<=y+c}function wi(t,n,l,a,u){let c=(vi("arrowUp",u)-1)/2,d=(Tt(u/2)-1)/2;n.beginPath(),t?(n.moveTo(l-c,a),n.lineTo(l,a-c),n.lineTo(l+c,a),n.lineTo(l+d,a),n.lineTo(l+d,a+c),n.lineTo(l-d,a+c)):(n.moveTo(l-c,a),n.lineTo(l,a+c),n.lineTo(l+c,a),n.lineTo(l+d,a),n.lineTo(l+d,a-c),n.lineTo(l-d,a-c)),n.lineTo(l-d,a),n.fill()}let Mi=class Mi extends j{constructor(){super(...arguments),this.Lt=null,this.lr=new si,this.j=-1,this.H="",this.Gr=""}it(t){this.Lt=t}ar(t,n){this.j===t&&this.H===n||(this.j=t,this.H=n,this.Gr=N(t,n),this.lr.ir())}br(t,n){if(null===this.Lt||null===this.Lt.nt)return null;for(let l=this.Lt.nt.from;l<this.Lt.nt.to;l++){let a=this.Lt.st[l];if(!(void 0===a.Jt||!function(t,n,l,a,u,c){let d=a/2;return u>=t&&u<=t+l&&c>=n-d&&c<=n+d}(a.Jt.et,a.Jt.rt,a.Jt.$i,a.Jt.zt,t,n))||function(t,n,l){if(0===t.Ks)return!1;switch(t.th){case"arrowDown":case"arrowUp":var a;return a=t.et,bi(a,t.rt,t.Ks,n,l);case"circle":return function(t,n,l,a,u){let c=2+vi("circle",l)/2,d=t-a,g=n-u;return Math.sqrt(d*d+g*g)<=c}(t.et,t.rt,t.Ks,n,l);case"square":return bi(t.et,t.rt,t.Ks,n,l)}}(a,t,n))return{gr:a.Jr,wr:a.wr}}return null}Z({context:t},n,l){if(null!==this.Lt&&null!==this.Lt.nt){t.textBaseline="middle",t.font=this.Gr;for(let n=this.Lt.nt.from;n<this.Lt.nt.to;n++){let l=this.Lt.st[n];void 0!==l.Jt&&(l.Jt.$i=this.lr.Si(t,l.Jt.Qr),l.Jt.zt=this.j,l.Jt.et=l.et-l.Jt.$i/2),t.fillStyle=l.O,void 0!==l.Jt&&function(t,n,l,a){t.fillText(n,l,a)}(t,l.Jt.Qr,l.Jt.et,l.Jt.rt),function(t,n){if(0!==t.Ks){switch(t.th){case"arrowDown":return void wi(!1,n,t.et,t.rt,t.Ks);case"arrowUp":return void wi(!0,n,t.et,t.rt,t.Ks);case"circle":return void function(t,n,l,a){let u=(vi("circle",a)-1)/2;t.beginPath(),t.arc(n,l,u,0,2*Math.PI,!1),t.fill()}(n,t.et,t.rt,t.Ks);case"square":return void function(t,n,l,a){let u=vi("square",a),c=(u-1)/2;t.fillRect(n-c,l-c,u,u)}(n,t.et,t.rt,t.Ks)}t.th}}(l,t)}}}};let yi=class yi{constructor(t,n){this.bt=!0,this.sh=!0,this.eh=!0,this.rh=null,this.Ht=new Mi,this.Wr=t,this.Ui=n,this.Lt={st:[],nt:null}}gt(t){this.bt=!0,this.eh=!0,"data"===t&&(this.sh=!0)}xt(t){if(!this.Wr.Tt())return null;this.bt&&this.hh();let n=this.Ui.W().layout;return this.Ht.ar(n.fontSize,n.fontFamily),this.Ht.it(this.Lt),this.Ht}lh(){if(this.eh){if(this.Wr.ah().length>0){let t=this.Ui.yt().he(),n=mi(t),l=1.5*pi(t)+2*n;this.rh={above:l,below:l}}else this.rh=null;this.eh=!1}return this.rh}hh(){let t=this.Wr.At(),n=this.Ui.yt(),l=this.Wr.ah();this.sh&&(this.Lt.st=l.map(t=>({ut:t.time,et:0,rt:0,Ks:0,th:t.shape,O:t.color,Jr:t.Jr,wr:t.id,Jt:void 0})),this.sh=!1);let a=this.Ui.W().layout;this.Lt.nt=null;let u=n.Xs();if(null===u)return;let c=this.Wr.Pt();if(null===c||0===this.Lt.st.length)return;let d=NaN,g=mi(n.he()),y={ih:g,nh:g};this.Lt.nt=Lt(this.Lt.st,u,!0);for(let u=this.Lt.nt.from;u<this.Lt.nt.to;u++){let S=l[u];S.time!==d&&(y.ih=g,y.nh=g,d=S.time);let _=this.Lt.st[u];_.et=n.Et(S.time),void 0!==S.text&&S.text.length>0&&(_.Jt={Qr:S.text,et:0,rt:0,$i:0,zt:0});let L=this.Wr.oh(S.time);null!==L&&function(t,n,l,a,u,c,d,g,y){let S=O(l)?l:l.xe,_=O(l)?l:l.ge,L=O(l)?l:l.Me,C=O(n.size)?Math.max(n.size,0):1,k=pi(g.he())*C,U=k/2;switch(t.Ks=k,n.position){case"inBar":return t.rt=d.Ot(S,y),void(void 0!==t.Jt&&(t.Jt.rt=t.rt+U+c+.6*u));case"aboveBar":return t.rt=d.Ot(_,y)-U-a.ih,void 0!==t.Jt&&(t.Jt.rt=t.rt-U-.6*u,a.ih+=1.2*u),void(a.ih+=k+c);case"belowBar":return t.rt=d.Ot(L,y)+U+a.nh,void 0!==t.Jt&&(t.Jt.rt=t.rt+U+c+.6*u,a.nh+=1.2*u),void(a.nh+=k+c)}n.position}(_,S,L,y,a.fontSize,g,t,n,c.Vt)}this.bt=!1}};let Ci=class Ci extends li{constructor(t){super(t)}kr(){let t=this.Mr;t.Tt=!1;let n=this.Es.W();if(!n.priceLineVisible||!this.Es.Tt())return;let l=this.Es.Yr(0===n.priceLineSource);l.Xr||(t.Tt=!0,t.rt=l.yi,t.O=this.Es._h(l.O),t.ht=n.priceLineWidth,t.Wt=n.priceLineStyle)}};let Ti=class Ti extends st{constructor(t){super(),this.$t=t}Ei(t,n,l){t.Tt=!1,n.Tt=!1;let a=this.$t;if(!a.Tt())return;let u=a.W(),c=u.lastValueVisible,d=""!==a.uh(),g=0===u.seriesLastValueMode,y=a.Yr(!1);if(y.Xr)return;c&&(t.Jt=this.dh(y,c,g),t.Tt=0!==t.Jt.length),(d||g)&&(n.Jt=this.fh(y,c,d,g),n.Tt=n.Jt.length>0);let S=a._h(y.O),_=P(S);l.t=_.t,l.yi=y.yi,n.Bt=a.qt().It(y.yi/a.At().zt()),t.Bt=S,t.O=_.i,n.O=_.i}fh(t,n,l,a){let u="",c=this.$t.uh();return l&&0!==c.length&&(u+=`${c} `),n&&a&&(u+=this.$t.At().ph()?t.mh:t.bh),u.trim()}dh(t,n,l){return n?l?this.$t.At().ph()?t.bh:t.mh:t.Jt:""}};function Pi(t,n,l,a){let u=Number.isFinite(n),c=Number.isFinite(l);return u&&c?t(n,l):u||c?u?n:l:a}let Ri=class Ri{constructor(t,n){this.wh=t,this.gh=n}Mh(t){return null!==t&&this.wh===t.wh&&this.gh===t.gh}xh(){return new Ri(this.wh,this.gh)}Sh(){return this.wh}kh(){return this.gh}yh(){return this.gh-this.wh}Fi(){return this.gh===this.wh||Number.isNaN(this.gh)||Number.isNaN(this.wh)}ts(t){return null===t?this:new Ri(Pi(Math.min,this.Sh(),t.Sh(),-1/0),Pi(Math.max,this.kh(),t.kh(),1/0))}Ch(t){if(!O(t)||0==this.gh-this.wh)return;let n=.5*(this.gh+this.wh),l=this.gh-n,a=this.wh-n;l*=t,a*=t,this.gh=n+l,this.wh=n+a}Th(t){O(t)&&(this.gh+=t,this.wh+=t)}Ph(){return{minValue:this.wh,maxValue:this.gh}}static Rh(t){return null===t?null:new Ri(t.minValue,t.maxValue)}};let Di=class Di{constructor(t,n){this.Dh=t,this.Oh=n||null}Ah(){return this.Dh}Vh(){return this.Oh}Ph(){return null===this.Dh?null:{priceRange:this.Dh.Ph(),margins:this.Oh||void 0}}static Rh(t){return null===t?null:new Di(Ri.Rh(t.priceRange),t.margins)}};let Oi=class Oi extends li{constructor(t,n){super(t),this.Bh=n}kr(){let t=this.Mr;t.Tt=!1;let n=this.Bh.W();if(!this.Es.Tt()||!n.lineVisible)return;let l=this.Bh.Ih();null!==l&&(t.Tt=!0,t.rt=l,t.O=n.color,t.ht=n.lineWidth,t.Wt=n.lineStyle,t.wr=this.Bh.W().id)}};let Ai=class Ai extends st{constructor(t,n){super(),this.Wr=t,this.Bh=n}Ei(t,n,l){t.Tt=!1,n.Tt=!1;let a=this.Bh.W(),u=a.axisLabelVisible,c=""!==a.title,d=this.Wr;if(!u||!d.Tt())return;let g=this.Bh.Ih();if(null===g)return;c&&(n.Jt=a.title,n.Tt=!0),n.Bt=d.qt().It(g/d.At().zt()),t.Jt=this.zh(a.price),t.Tt=!0;let y=P(a.axisLabelColor||a.color);l.t=y.t;let S=a.axisLabelTextColor||y.i;t.O=S,n.O=S,l.yi=g}zh(t){let n=this.Wr.Pt();return null===n?"":this.Wr.At().Wi(t,n.Vt)}};let Vi=class Vi{constructor(t,n){this.Wr=t,this.cn=n,this.Eh=new Oi(t,this),this._r=new Ai(t,this),this.Lh=new ri(this._r,t,t.qt())}Nh(t){D(this.cn,t),this.gt(),this.Wr.qt().Fh()}W(){return this.cn}Wh(){return this.Eh}jh(){return this.Lh}Hh(){return this._r}gt(){this.Eh.gt(),this._r.gt()}Ih(){let t=this.Wr,n=t.At();if(t.qt().yt().Fi()||n.Fi())return null;let l=t.Pt();return null===l?null:n.Ot(this.cn.price,l.Vt)}};let Bi=class Bi extends at{constructor(t){super(),this.Ui=t}qt(){return this.Ui}};let tN={Bar:(t,n,l,a)=>{var u;let c=n.upColor,d=n.downColor,g=b(t(l,a)),y=w(g.Vt[0])<=w(g.Vt[3]);return{ue:null!==(u=g.O)&&void 0!==u?u:y?c:d}},Candlestick:(t,n,l,a)=>{var u,c,d;let g=n.upColor,y=n.downColor,S=n.borderUpColor,_=n.borderDownColor,L=n.wickUpColor,C=n.wickDownColor,k=b(t(l,a)),U=w(k.Vt[0])<=w(k.Vt[3]);return{ue:null!==(u=k.O)&&void 0!==u?u:U?g:y,Le:null!==(c=k.Bt)&&void 0!==c?c:U?S:_,Ee:null!==(d=k.$h)&&void 0!==d?d:U?L:C}},Custom:(t,n,l,a)=>{var u;return{ue:null!==(u=b(t(l,a)).O)&&void 0!==u?u:n.color}},Area:(t,n,l,a)=>{var u,c,d,g;let y=b(t(l,a));return{ue:null!==(u=y._t)&&void 0!==u?u:n.lineColor,_t:null!==(c=y._t)&&void 0!==c?c:n.lineColor,Ts:null!==(d=y.Ts)&&void 0!==d?d:n.topColor,Ps:null!==(g=y.Ps)&&void 0!==g?g:n.bottomColor}},Baseline:(t,n,l,a)=>{var u,c,d,g,y,S;let _=b(t(l,a));return{ue:_.Vt[3]>=n.baseValue.price?n.topLineColor:n.bottomLineColor,Pe:null!==(u=_.Pe)&&void 0!==u?u:n.topLineColor,Re:null!==(c=_.Re)&&void 0!==c?c:n.bottomLineColor,Se:null!==(d=_.Se)&&void 0!==d?d:n.topFillColor1,ke:null!==(g=_.ke)&&void 0!==g?g:n.topFillColor2,ye:null!==(y=_.ye)&&void 0!==y?y:n.bottomFillColor1,Ce:null!==(S=_.Ce)&&void 0!==S?S:n.bottomFillColor2}},Line:(t,n,l,a)=>{var u,c;let d=b(t(l,a));return{ue:null!==(u=d.O)&&void 0!==u?u:n.color,_t:null!==(c=d.O)&&void 0!==c?c:n.color}},Histogram:(t,n,l,a)=>{var u;return{ue:null!==(u=b(t(l,a)).O)&&void 0!==u?u:n.color}}};let zi=class zi{constructor(t){this.Uh=(t,n)=>void 0!==n?n.Vt:this.Wr.In().qh(t),this.Wr=t,this.Yh=tN[t.Xh()]}Hs(t,n){return this.Yh(this.Uh,this.Wr.W(),t,n)}};(d=th||(th={}))[d.NearestLeft=-1]="NearestLeft",d[d.None=0]="None",d[d.NearestRight=1]="NearestRight";let Ni=class Ni{constructor(){this.Kh=[],this.Zh=new Map,this.Gh=new Map}Jh(){return this.Ks()>0?this.Kh[this.Kh.length-1]:null}Qh(){return this.Ks()>0?this.tl(0):null}Bn(){return this.Ks()>0?this.tl(this.Kh.length-1):null}Ks(){return this.Kh.length}Fi(){return 0===this.Ks()}Kr(t){return null!==this.il(t,0)}qh(t){return this.nl(t)}nl(t,n=0){let l=this.il(t,n);return null===l?null:Object.assign(Object.assign({},this.sl(l)),{se:this.tl(l)})}ie(){return this.Kh}el(t,n,l){if(this.Fi())return null;let a=null;for(let u of l)a=Fi(a,this.rl(t,n,u));return a}it(t){this.Gh.clear(),this.Zh.clear(),this.Kh=t}tl(t){return this.Kh[t].se}sl(t){return this.Kh[t]}il(t,n){let l=this.hl(t);if(null===l&&0!==n)switch(n){case -1:return this.ll(t);case 1:return this.al(t);default:throw TypeError("Unknown search mode")}return l}ll(t){let n=this.ol(t);return n>0&&(n-=1),n!==this.Kh.length&&this.tl(n)<t?n:null}al(t){let n=this._l(t);return n!==this.Kh.length&&t<this.tl(n)?n:null}hl(t){let n=this.ol(t);return n===this.Kh.length||t<this.Kh[n].se?null:n}ol(t){return tP(this.Kh,t,(t,n)=>t.se<n)}_l(t){return tR(this.Kh,t,(t,n)=>t.se>n)}ul(t,n,l){let a=null;for(let u=t;u<n;u++){let t=this.Kh[u].Vt[l];Number.isNaN(t)||(null===a?a={cl:t,dl:t}:(t<a.cl&&(a.cl=t),t>a.dl&&(a.dl=t)))}return a}rl(t,n,l){if(this.Fi())return null;let a=null,u=b(this.Qh()),c=b(this.Bn()),d=Math.max(t,u),g=Math.min(n,c),y=30*Math.ceil(d/30),S=Math.max(y,30*Math.floor(g/30));{let t=this.ol(d),u=this._l(Math.min(g,y,n));a=Fi(a,this.ul(t,u,l))}let _=this.Zh.get(l);void 0===_&&(_=new Map,this.Zh.set(l,_));for(let t=Math.max(y+1,d);t<S;t+=30){let n=Math.floor(t/30),u=_.get(n);if(void 0===u){let t=this.ol(30*n),a=this._l((n+1)*30-1);u=this.ul(t,a,l),_.set(n,u)}a=Fi(a,u)}{let t=this.ol(S),n=this._l(g);a=Fi(a,this.ul(t,n,l))}return a}};function Fi(t,n){return null===t?n:null===n?t:{cl:Math.min(t.cl,n.cl),dl:Math.max(t.dl,n.dl)}}let Wi=class Wi{constructor(t){this.fl=t}K(t,n,l){this.fl.draw(t)}G(t,n,l){var a,u;null===(u=(a=this.fl).drawBackground)||void 0===u||u.call(a,t)}};let ji=class ji{constructor(t){this.Qe=null,this.wn=t}xt(){var t;let n=this.wn.renderer();if(null===n)return null;if((null===(t=this.Qe)||void 0===t?void 0:t.vl)===n)return this.Qe.pl;let l=new Wi(n);return this.Qe={vl:n,pl:l},l}ml(){var t,n,l;return null!==(l=null===(n=(t=this.wn).zOrder)||void 0===n?void 0:n.call(t))&&void 0!==l?l:"normal"}};function Hi(t){var n,l,a,u,c;return{Jt:t.text(),yi:t.coordinate(),ki:null===(n=t.fixedCoordinate)||void 0===n?void 0:n.call(t),O:t.textColor(),t:t.backColor(),Tt:null===(a=null===(l=t.visible)||void 0===l?void 0:l.call(t))||void 0===a||a,ai:null===(c=null===(u=t.tickVisible)||void 0===u?void 0:u.call(t))||void 0===c||c}}let $i=class $i{constructor(t,n){this.Ht=new ht,this.bl=t,this.wl=n}xt(){return this.Ht.it(Object.assign({$i:this.wl.$i()},Hi(this.bl))),this.Ht}};let Ui=class Ui extends st{constructor(t,n){super(),this.bl=t,this.Li=n}Ei(t,n,l){let a=Hi(this.bl);l.t=a.t,t.O=a.O;let u=2/12*this.Li.P();l.gi=u,l.Mi=u,l.yi=a.yi,l.ki=a.ki,t.Jt=a.Jt,t.Tt=a.Tt,t.ai=a.ai}};let qi=class qi{constructor(t,n){this.gl=null,this.Ml=null,this.xl=null,this.Sl=null,this.kl=null,this.yl=t,this.Wr=n}Cl(){return this.yl}On(){var t,n;null===(n=(t=this.yl).updateAllViews)||void 0===n||n.call(t)}Pn(){var t,n,l,a;let u=null!==(l=null===(n=(t=this.yl).paneViews)||void 0===n?void 0:n.call(t))&&void 0!==l?l:[];if((null===(a=this.gl)||void 0===a?void 0:a.vl)===u)return this.gl.pl;let c=u.map(t=>new ji(t));return this.gl={vl:u,pl:c},c}tn(){var t,n,l,a;let u=null!==(l=null===(n=(t=this.yl).timeAxisViews)||void 0===n?void 0:n.call(t))&&void 0!==l?l:[];if((null===(a=this.Ml)||void 0===a?void 0:a.vl)===u)return this.Ml.pl;let c=this.Wr.qt().yt(),d=u.map(t=>new $i(t,c));return this.Ml={vl:u,pl:d},d}Rn(){var t,n,l,a;let u=null!==(l=null===(n=(t=this.yl).priceAxisViews)||void 0===n?void 0:n.call(t))&&void 0!==l?l:[];if((null===(a=this.xl)||void 0===a?void 0:a.vl)===u)return this.xl.pl;let c=this.Wr.At(),d=u.map(t=>new Ui(t,c));return this.xl={vl:u,pl:d},d}Tl(){var t,n,l,a;let u=null!==(l=null===(n=(t=this.yl).priceAxisPaneViews)||void 0===n?void 0:n.call(t))&&void 0!==l?l:[];if((null===(a=this.Sl)||void 0===a?void 0:a.vl)===u)return this.Sl.pl;let c=u.map(t=>new ji(t));return this.Sl={vl:u,pl:c},c}Pl(){var t,n,l,a;let u=null!==(l=null===(n=(t=this.yl).timeAxisPaneViews)||void 0===n?void 0:n.call(t))&&void 0!==l?l:[];if((null===(a=this.kl)||void 0===a?void 0:a.vl)===u)return this.kl.pl;let c=u.map(t=>new ji(t));return this.kl={vl:u,pl:c},c}Rl(t,n){var l,a,u;return null!==(u=null===(a=(l=this.yl).autoscaleInfo)||void 0===a?void 0:a.call(l,t,n))&&void 0!==u?u:null}br(t,n){var l,a,u;return null!==(u=null===(a=(l=this.yl).hitTest)||void 0===a?void 0:a.call(l,t,n))&&void 0!==u?u:null}};function Yi(t,n,l,a){t.forEach(t=>{n(t).forEach(t=>{t.ml()===l&&a.push(t)})})}function Xi(t){return t.Pn()}function Ki(t){return t.Tl()}function Zi(t){return t.Pl()}let Gi=class Gi extends Bi{constructor(t,n,l,a,u){super(t),this.Lt=new Ni,this.Eh=new Ci(this),this.Dl=[],this.Ol=new ai(this),this.Al=null,this.Vl=null,this.Bl=[],this.Il=[],this.zl=null,this.El=[],this.cn=n,this.Ll=l;let c=new Ti(this);this.hn=[c],this.Lh=new ri(c,this,t),"Area"!==l&&"Line"!==l&&"Baseline"!==l||(this.Al=new di(this)),this.Nl(),this.Fl(u)}S(){null!==this.zl&&clearTimeout(this.zl)}_h(t){return this.cn.priceLineColor||t}Yr(t){let n,l;let a={Xr:!0},u=this.At();if(this.qt().yt().Fi()||u.Fi()||this.Lt.Fi())return a;let c=this.qt().yt().Xs(),d=this.Pt();if(null===c||null===d)return a;if(t){let t=this.Lt.Jh();if(null===t)return a;n=t,l=t.se}else{let t=this.Lt.nl(c.di(),-1);if(null===t||null===(n=this.Lt.qh(t.se)))return a;l=t.se}let g=n.Vt[3],y=this.$s().Hs(l,{Vt:n}),S=u.Ot(g,d.Vt);return{Xr:!1,ct:g,Jt:u.Wi(g,d.Vt),mh:u.Wl(g),bh:u.jl(g,d.Vt),O:y.ue,yi:S,se:l}}$s(){return null!==this.Vl||(this.Vl=new zi(this)),this.Vl}W(){return this.cn}Nh(t){let n=t.priceScaleId;void 0!==n&&n!==this.cn.priceScaleId&&this.qt().Hl(this,n),D(this.cn,t),void 0!==t.priceFormat&&(this.Nl(),this.qt().$l()),this.qt().Ul(this),this.qt().ql(),this.wn.gt("options")}it(t,n){this.Lt.it(t),this.Yl(),this.wn.gt("data"),this.dn.gt("data"),null!==this.Al&&(n&&n.Xl?this.Al.Hr():0===t.length&&this.Al.jr());let l=this.qt().cr(this);this.qt().Kl(l),this.qt().Ul(this),this.qt().ql(),this.qt().Fh()}Zl(t){this.Bl=t,this.Yl();let n=this.qt().cr(this);this.dn.gt("data"),this.qt().Kl(n),this.qt().Ul(this),this.qt().ql(),this.qt().Fh()}Gl(){return this.Bl}ah(){return this.Il}Jl(t){let n=new Vi(this,t);return this.Dl.push(n),this.qt().Ul(this),n}Ql(t){let n=this.Dl.indexOf(t);-1!==n&&this.Dl.splice(n,1),this.qt().Ul(this)}Xh(){return this.Ll}Pt(){let t=this.ta();return null===t?null:{Vt:t.Vt[3],ia:t.ut}}ta(){let t=this.qt().yt().Xs();if(null===t)return null;let n=t.Os();return this.Lt.nl(n,1)}In(){return this.Lt}oh(t){let n=this.Lt.qh(t);return null===n?null:"Bar"===this.Ll||"Candlestick"===this.Ll||"Custom"===this.Ll?{we:n.Vt[0],ge:n.Vt[1],Me:n.Vt[2],xe:n.Vt[3]}:n.Vt[3]}na(t){let n=[];Yi(this.El,Xi,"top",n);let l=this.Al;return null!==l&&l.Tt()&&(null===this.zl&&l.Ur()&&(this.zl=setTimeout(()=>{this.zl=null,this.qt().sa()},0)),l.$r(),n.push(l)),n}Pn(){let t=[];this.ea()||t.push(this.Ol),t.push(this.wn,this.Eh,this.dn);let n=this.Dl.map(t=>t.Wh());return t.push(...n),Yi(this.El,Xi,"normal",t),t}ra(){return this.ha(Xi,"bottom")}la(t){return this.ha(Ki,t)}aa(t){return this.ha(Zi,t)}oa(t,n){return this.El.map(l=>l.br(t,n)).filter(t=>null!==t)}Qi(t){return[this.Lh,...this.Dl.map(t=>t.jh())]}Rn(t,n){if(n!==this.Xi&&!this.ea())return[];let l=[...this.hn];for(let t of this.Dl)l.push(t.Hh());return this.El.forEach(t=>{l.push(...t.Rn())}),l}tn(){let t=[];return this.El.forEach(n=>{t.push(...n.tn())}),t}Rl(t,n){if(void 0!==this.cn.autoscaleInfoProvider){let l=this.cn.autoscaleInfoProvider(()=>{let l=this._a(t,n);return null===l?null:l.Ph()});return Di.Rh(l)}return this._a(t,n)}ua(){return this.cn.priceFormat.minMove}ca(){return this.da}On(){var t;for(let t of(this.wn.gt(),this.dn.gt(),this.hn))t.gt();for(let t of this.Dl)t.gt();this.Eh.gt(),this.Ol.gt(),null===(t=this.Al)||void 0===t||t.gt(),this.El.forEach(t=>t.On())}At(){return b(super.At())}Ct(t){if(!(("Line"===this.Ll||"Area"===this.Ll||"Baseline"===this.Ll)&&this.cn.crosshairMarkerVisible))return null;let n=this.Lt.qh(t);return null===n?null:{ct:n.Vt[3],ot:this.fa(),Bt:this.va(),Dt:this.pa(),Rt:this.ma(t)}}uh(){return this.cn.title}Tt(){return this.cn.visible}ba(t){this.El.push(new qi(t,this))}wa(t){this.El=this.El.filter(n=>n.Cl()!==t)}ga(){if(this.wn instanceof Gt!=!1)return t=>this.wn.Fe(t)}Ma(){if(this.wn instanceof Gt!=!1)return t=>this.wn.We(t)}ea(){return!ut(this.At().xa())}_a(t,n){if(!A(t)||!A(n)||this.Lt.Fi())return null;let l="Line"===this.Ll||"Area"===this.Ll||"Baseline"===this.Ll||"Histogram"===this.Ll?[3]:[2,1],a=this.Lt.el(t,n,l),u=null!==a?new Ri(a.cl,a.dl):null;if("Histogram"===this.Xh()){let t=this.cn.base,n=new Ri(t,t);u=null!==u?u.ts(n):n}let c=this.dn.lh();return this.El.forEach(l=>{var a,d,g,y;let S=l.Rl(t,n);if(null==S?void 0:S.priceRange){let t=new Ri(S.priceRange.minValue,S.priceRange.maxValue);u=null!==u?u.ts(t):t}(null==S?void 0:S.margins)&&(a=c,d=S.margins,c={above:Math.max(null!==(g=null==a?void 0:a.above)&&void 0!==g?g:0,d.above),below:Math.max(null!==(y=null==a?void 0:a.below)&&void 0!==y?y:0,d.below)})}),new Di(u,c)}fa(){switch(this.Ll){case"Line":case"Area":case"Baseline":return this.cn.crosshairMarkerRadius}return 0}va(){switch(this.Ll){case"Line":case"Area":case"Baseline":{let t=this.cn.crosshairMarkerBorderColor;if(0!==t.length)return t}}return null}pa(){switch(this.Ll){case"Line":case"Area":case"Baseline":return this.cn.crosshairMarkerBorderWidth}return 0}ma(t){switch(this.Ll){case"Line":case"Area":case"Baseline":{let t=this.cn.crosshairMarkerBackgroundColor;if(0!==t.length)return t}}return this.$s().Hs(t).ue}Nl(){switch(this.cn.priceFormat.type){case"custom":this.da={format:this.cn.priceFormat.formatter};break;case"volume":this.da=new mt(this.cn.priceFormat.precision);break;case"percent":this.da=new pt(this.cn.priceFormat.precision);break;default:{let t=Math.pow(10,this.cn.priceFormat.precision);this.da=new vt(t,this.cn.priceFormat.minMove*t)}}null!==this.Xi&&this.Xi.Sa()}Yl(){let t=this.qt().yt();if(!t.ka()||this.Lt.Fi())return void(this.Il=[]);let n=b(this.Lt.Qh());this.Il=this.Bl.map((l,a)=>{let u=b(t.ya(l.time,!0)),c=u<n?1:-1;return{time:b(this.Lt.nl(u,c)).se,position:l.position,shape:l.shape,color:l.color,id:l.id,Jr:a,text:l.text,size:l.size,originalTime:l.originalTime}})}Fl(t){switch(this.dn=new yi(this,this.qt()),this.Ll){case"Bar":this.wn=new $t(this,this.qt());break;case"Candlestick":this.wn=new Kt(this,this.qt());break;case"Line":this.wn=new ii(this,this.qt());break;case"Custom":this.wn=new Gt(this,this.qt(),m(t));break;case"Area":this.wn=new Wt(this,this.qt());break;case"Baseline":this.wn=new Yt(this,this.qt());break;case"Histogram":this.wn=new ti(this,this.qt());break;default:throw Error("Unknown chart style assigned: "+this.Ll)}}ha(t,n){let l=[];return Yi(this.El,t,n,l),l}};let Ji=class Ji{constructor(t){this.cn=t}Ca(t,n,l){if(0===this.cn.mode)return t;let a=l.vn(),u=a.Pt();if(null===u)return t;let c=a.Ot(t,u),d=l.Ta().filter(t=>t instanceof Gi).reduce((t,a)=>{if(l.dr(a)||!a.Tt())return t;let u=a.At(),c=a.In();if(u.Fi()||!c.Kr(n))return t;let d=c.qh(n);if(null===d)return t;let g=w(a.Pt());return t.concat([u.Ot(d.Vt[3],g.Vt)])},[]);if(0===d.length)return t;d.sort((t,n)=>Math.abs(t-c)-Math.abs(n-c));let g=d[0];return a.pn(g,u)}};let Qi=class Qi extends Y{constructor(){super(...arguments),this.Lt=null}it(t){this.Lt=t}Z({context:t,bitmapSize:n,horizontalPixelRatio:l,verticalPixelRatio:a}){if(null===this.Lt)return;let u=Math.max(1,Math.floor(l));t.lineWidth=u,t.save(),t.lineWidth%2&&t.translate(.5,.5),(()=>{let c=b(this.Lt);if(c.Pa){for(let a of(t.strokeStyle=c.Ra,f(t,c.Da),t.beginPath(),c.Oa)){let c=Math.round(a.Aa*l);t.moveTo(c,-u),t.lineTo(c,n.height+u)}t.stroke()}if(c.Va){for(let l of(t.strokeStyle=c.Ba,f(t,c.Ia),t.beginPath(),c.za)){let c=Math.round(l.Aa*a);t.moveTo(-u,c),t.lineTo(n.width+u,c)}t.stroke()}})(),t.restore()}};let tn=class tn{constructor(t){this.Ht=new Qi,this.bt=!0,this.nn=t}gt(){this.bt=!0}xt(){if(this.bt){let t=this.nn.qt().W().grid,n={Va:t.horzLines.visible,Pa:t.vertLines.visible,Ba:t.horzLines.color,Ra:t.vertLines.color,Ia:t.horzLines.style,Da:t.vertLines.style,za:this.nn.vn().Ea(),Oa:(this.nn.qt().yt().Ea()||[]).map(t=>({Aa:t.coord}))};this.Ht.it(n),this.bt=!1}return this.Ht}};let nn=class nn{constructor(t){this.wn=new tn(t)}Wh(){return this.wn}};let tD={La:4,Na:1e-4};function en(t,n){let l=100*(t-n)/n;return n<0?-l:l}function hn(t,n){let l=100*(t-n)/n+100;return n<0?-l:l}function an(t,n){let l=Math.abs(t);if(l<1e-15)return 0;let a=Math.log10(l+n.Na)+n.La;return t<0?-a:a}function on(t,n){let l=Math.abs(t);if(l<1e-15)return 0;let a=Math.pow(10,l-n.La)-n.Na;return t<0?-a:a}function _n(t,n){if(null===t)return null;let l=an(t.Sh(),n),a=an(t.kh(),n);return new Ri(l,a)}function un(t,n){if(null===t)return null;let l=on(t.Sh(),n),a=on(t.kh(),n);return new Ri(l,a)}function cn(t){if(null===t)return tD;let n=Math.abs(t.kh()-t.Sh());if(n>=1||n<1e-15)return tD;let l=tD.La+Math.ceil(Math.abs(Math.log10(n)));return{La:l,Na:1/Math.pow(10,l)}}let dn=class dn{constructor(t,n){if(this.Fa=t,this.Wa=n,function(t){if(t<0)return!1;for(let n=t;n>1;n/=10)if(n%10!=0)return!1;return!0}(this.Fa))this.ja=[2,2.5,2];else{this.ja=[];for(let t=this.Fa;1!==t;){if(t%2==0)this.ja.push(2),t/=2;else{if(t%5!=0)throw Error("unexpected base");this.ja.push(2,2.5),t/=5}if(this.ja.length>100)throw Error("something wrong with base")}}}Ha(t,n,l){let a=0===this.Fa?0:1/this.Fa,u=Math.pow(10,Math.max(0,Math.ceil(Math.log10(t-n)))),c=0,d=this.Wa[0];for(;;){let t=a-u<=1e-14&&u>a+1e-14,n=l*d-u<=1e-14,g=1-u<=1e-14;if(!(t&&n&&g))break;u/=d,d=this.Wa[++c%this.Wa.length]}if(u<=a+1e-14&&(u=a),u=Math.max(1,u),this.ja.length>0&&1e-14>Math.abs(u-1))for(c=0,d=this.ja[0];l*d-u<=1e-14&&u>a+1e-14;)u/=d,d=this.ja[++c%this.ja.length];return u}};let fn=class fn{constructor(t,n,l,a){this.$a=[],this.Li=t,this.Fa=n,this.Ua=l,this.qa=a}Ha(t,n){if(t<n)throw Error("high < low");let l=this.Li.zt(),a=(t-n)*this.Ya()/l,u=new dn(this.Fa,[2,2.5,2]),c=new dn(this.Fa,[2,2,2.5]),d=new dn(this.Fa,[2.5,2,2]),g=[];return g.push(u.Ha(t,n,a),c.Ha(t,n,a),d.Ha(t,n,a)),function(t){if(t.length<1)throw Error("array is empty");let n=t[0];for(let l=1;l<t.length;++l)t[l]<n&&(n=t[l]);return n}(g)}Xa(){let t=this.Li,n=t.Pt();if(null===n)return void(this.$a=[]);let l=t.zt(),a=this.Ua(l-1,n),u=this.Ua(0,n),c=this.Li.W().entireTextOnly?this.Ka()/2:0,d=l-1-c,g=Math.max(a,u),y=Math.min(a,u);if(g===y)return void(this.$a=[]);let S=this.Ha(g,y),_=g%S;_+=_<0?S:0;let L=g>=y?1:-1,C=null,k=0;for(let l=g-_;l>y;l-=S){let a=this.qa(l,n,!0);null!==C&&Math.abs(a-C)<this.Ya()||a<c||a>d||(k<this.$a.length?(this.$a[k].Aa=a,this.$a[k].Za=t.Ga(l)):this.$a.push({Aa:a,Za:t.Ga(l)}),k++,C=a,t.Ja()&&(S=this.Ha(l*L,y)))}this.$a.length=k}Ea(){return this.$a}Ka(){return this.Li.P()}Ya(){return Math.ceil(2.5*this.Ka())}};function vn(t){return t.slice().sort((t,n)=>b(t.Zi())-b(n.Zi()))}(g=tl||(tl={}))[g.Normal=0]="Normal",g[g.Logarithmic=1]="Logarithmic",g[g.Percentage=2]="Percentage",g[g.IndexedTo100=3]="IndexedTo100";let tV=new pt,tF=new vt(100,1);let wn=class wn{constructor(t,n,l,a){this.Qa=0,this.io=null,this.Dh=null,this.no=null,this.so={eo:!1,ro:null},this.ho=0,this.lo=0,this.ao=new R,this.oo=new R,this._o=[],this.uo=null,this.co=null,this.do=null,this.fo=null,this.da=tF,this.vo=cn(null),this.po=t,this.cn=n,this.mo=l,this.bo=a,this.wo=new fn(this,100,this.Mo.bind(this),this.xo.bind(this))}xa(){return this.po}W(){return this.cn}Nh(t){if(D(this.cn,t),this.Sa(),void 0!==t.mode&&this.So({yr:t.mode}),void 0!==t.scaleMargins){let n=m(t.scaleMargins.top),l=m(t.scaleMargins.bottom);if(n<0||n>1)throw Error(`Invalid top margin - expect value between 0 and 1, given=${n}`);if(l<0||l>1||n+l>1)throw Error(`Invalid bottom margin - expect value between 0 and 1, given=${l}`);if(n+l>1)throw Error(`Invalid margins - sum of margins must be less than 1, given=${n+l}`);this.ko(),this.co=null}}yo(){return this.cn.autoScale}Ja(){return 1===this.cn.mode}ph(){return 2===this.cn.mode}Co(){return 3===this.cn.mode}yr(){return{Wn:this.cn.autoScale,To:this.cn.invertScale,yr:this.cn.mode}}So(t){let n=this.yr(),l=null;void 0!==t.Wn&&(this.cn.autoScale=t.Wn),void 0!==t.yr&&(this.cn.mode=t.yr,2!==t.yr&&3!==t.yr||(this.cn.autoScale=!0),this.so.eo=!1),1===n.yr&&t.yr!==n.yr&&(function(t,n){if(null===t)return!1;let l=on(t.Sh(),n),a=on(t.kh(),n);return isFinite(l)&&isFinite(a)}(this.Dh,this.vo)?null!==(l=un(this.Dh,this.vo))&&this.Po(l):this.cn.autoScale=!0),1===t.yr&&t.yr!==n.yr&&null!==(l=_n(this.Dh,this.vo))&&this.Po(l);let a=n.yr!==this.cn.mode;a&&(2===n.yr||this.ph())&&this.Sa(),a&&(3===n.yr||this.Co())&&this.Sa(),void 0!==t.To&&n.To!==t.To&&(this.cn.invertScale=t.To,this.Ro()),this.oo.m(n,this.yr())}Do(){return this.oo}P(){return this.mo.fontSize}zt(){return this.Qa}Oo(t){this.Qa!==t&&(this.Qa=t,this.ko(),this.co=null)}Ao(){if(this.io)return this.io;let t=this.zt()-this.Vo()-this.Bo();return this.io=t,t}Ah(){return this.Io(),this.Dh}Po(t,n){let l=this.Dh;(n||null===l&&null!==t||null!==l&&!l.Mh(t))&&(this.co=null,this.Dh=t)}Fi(){return this.Io(),0===this.Qa||!this.Dh||this.Dh.Fi()}zo(t){return this.To()?t:this.zt()-1-t}Ot(t,n){return this.ph()?t=en(t,n):this.Co()&&(t=hn(t,n)),this.xo(t,n)}Qs(t,n,l){this.Io();let a=this.Bo(),u=b(this.Ah()),c=u.Sh(),d=u.kh(),g=this.Ao()-1,y=this.To(),S=g/(d-c),_=void 0===l?0:l.from,L=void 0===l?t.length:l.to,C=this.Eo();for(let l=_;l<L;l++){let u=t[l],d=u.ct;if(isNaN(d))continue;let g=d;null!==C&&(g=C(u.ct,n));let _=a+S*(g-c),L=y?_:this.Qa-1-_;u.rt=L}}me(t,n,l){this.Io();let a=this.Bo(),u=b(this.Ah()),c=u.Sh(),d=u.kh(),g=this.Ao()-1,y=this.To(),S=g/(d-c),_=void 0===l?0:l.from,L=void 0===l?t.length:l.to,C=this.Eo();for(let l=_;l<L;l++){let u=t[l],d=u.we,g=u.ge,_=u.Me,L=u.xe;null!==C&&(d=C(u.we,n),g=C(u.ge,n),_=C(u.Me,n),L=C(u.xe,n));let k=a+S*(d-c),U=y?k:this.Qa-1-k;u.ve=U,k=a+S*(g-c),U=y?k:this.Qa-1-k,u.ce=U,k=a+S*(_-c),U=y?k:this.Qa-1-k,u.de=U,k=a+S*(L-c),U=y?k:this.Qa-1-k,u.pe=U}}pn(t,n){let l=this.Mo(t,n);return this.Lo(l,n)}Lo(t,n){var l,a;let u=t;return this.ph()?(l=u,n<0&&(l=-l),u=l/100*n+n):this.Co()&&(a=u-100,n<0&&(a=-a),u=a/100*n+n),u}Ta(){return this._o}No(){if(this.uo)return this.uo;let t=[];for(let n=0;n<this._o.length;n++){let l=this._o[n];null===l.Zi()&&l.Gi(n+1),t.push(l)}return t=vn(t),this.uo=t,this.uo}Fo(t){-1===this._o.indexOf(t)&&(this._o.push(t),this.Sa(),this.Wo())}jo(t){let n=this._o.indexOf(t);if(-1===n)throw Error("source is not attached to scale");this._o.splice(n,1),0===this._o.length&&(this.So({Wn:!0}),this.Po(null)),this.Sa(),this.Wo()}Pt(){let t=null;for(let n of this._o){let l=n.Pt();null!==l&&(null===t||l.ia<t.ia)&&(t=l)}return null===t?null:t.Vt}To(){return this.cn.invertScale}Ea(){let t=null===this.Pt();if(null!==this.co&&(t||this.co.Ho===t))return this.co.Ea;this.wo.Xa();let n=this.wo.Ea();return this.co={Ea:n,Ho:t},this.ao.m(),n}$o(){return this.ao}Uo(t){this.ph()||this.Co()||null===this.do&&null===this.no&&(this.Fi()||(this.do=this.Qa-t,this.no=b(this.Ah()).xh()))}qo(t){if(this.ph()||this.Co()||null===this.do)return;this.So({Wn:!1}),(t=this.Qa-t)<0&&(t=0);let n=(this.do+.2*(this.Qa-1))/(t+.2*(this.Qa-1)),l=b(this.no).xh();n=Math.max(n,.1),l.Ch(n),this.Po(l)}Yo(){this.ph()||this.Co()||(this.do=null,this.no=null)}Xo(t){this.yo()||null===this.fo&&null===this.no&&(this.Fi()||(this.fo=t,this.no=b(this.Ah()).xh()))}Ko(t){if(this.yo()||null===this.fo)return;let n=b(this.Ah()).yh()/(this.Ao()-1),l=t-this.fo;this.To()&&(l*=-1);let a=l*n,u=b(this.no).xh();u.Th(a),this.Po(u,!0),this.co=null}Zo(){this.yo()||null!==this.fo&&(this.fo=null,this.no=null)}ca(){return this.da||this.Sa(),this.da}Wi(t,n){switch(this.cn.mode){case 2:return this.Go(en(t,n));case 3:return this.ca().format(hn(t,n));default:return this.zh(t)}}Ga(t){switch(this.cn.mode){case 2:return this.Go(t);case 3:return this.ca().format(t);default:return this.zh(t)}}Wl(t){return this.zh(t,b(this.Jo()).ca())}jl(t,n){return t=en(t,n),this.Go(t,tV)}Qo(){return this._o}t_(t){this.so={ro:t,eo:!1}}On(){this._o.forEach(t=>t.On())}Sa(){this.co=null;let t=this.Jo(),n=100;null!==t&&(n=Math.round(1/t.ua())),this.da=tF,this.ph()?(this.da=tV,n=100):this.Co()?(this.da=new vt(100,1),n=100):null!==t&&(this.da=t.ca()),this.wo=new fn(this,n,this.Mo.bind(this),this.xo.bind(this)),this.wo.Xa()}Wo(){this.uo=null}Jo(){return this._o[0]||null}Vo(){return this.To()?this.cn.scaleMargins.bottom*this.zt()+this.lo:this.cn.scaleMargins.top*this.zt()+this.ho}Bo(){return this.To()?this.cn.scaleMargins.top*this.zt()+this.ho:this.cn.scaleMargins.bottom*this.zt()+this.lo}Io(){this.so.eo||(this.so.eo=!0,this.i_())}ko(){this.io=null}xo(t,n){if(this.Io(),this.Fi())return 0;t=this.Ja()&&t?an(t,this.vo):t;let l=b(this.Ah()),a=this.Bo()+(this.Ao()-1)*(t-l.Sh())/l.yh();return this.zo(a)}Mo(t,n){if(this.Io(),this.Fi())return 0;let l=this.zo(t),a=b(this.Ah()),u=a.Sh()+a.yh()*((l-this.Bo())/(this.Ao()-1));return this.Ja()?on(u,this.vo):u}Ro(){this.co=null,this.wo.Xa()}i_(){var t;let n=this.so.ro;if(null===n)return;let l=null,a=this.Qo(),u=0,c=0;for(let t of a){if(!t.Tt())continue;let a=t.Pt();if(null===a)continue;let d=t.Rl(n.Os(),n.di()),g=d&&d.Ah();if(null!==g){switch(this.cn.mode){case 1:g=_n(g,this.vo);break;case 2:g=function(t,n){let l=en(t.Sh(),n),a=en(t.kh(),n);return new Ri(l,a)}(g,a.Vt);break;case 3:g=function(t,n){let l=hn(t.Sh(),n),a=hn(t.kh(),n);return new Ri(l,a)}(g,a.Vt)}if(l=null===l?g:l.ts(b(g)),null!==d){let t=d.Vh();null!==t&&(c=Math.max(u=Math.max(u,t.above),t.below))}}}if(u===this.ho&&c===this.lo||(this.ho=u,this.lo=c,this.co=null,this.ko()),null!==l){if(l.Sh()===l.kh()){let t=this.Jo(),n=5*(null===t||this.ph()||this.Co()?1:t.ua());this.Ja()&&(l=un(l,this.vo)),l=new Ri(l.Sh()-n,l.kh()+n),this.Ja()&&(l=_n(l,this.vo))}if(this.Ja()){let n=un(l,this.vo),a=cn(n);if(t=this.vo,a.La!==t.La||a.Na!==t.Na){let t=null!==this.no?un(this.no,this.vo):null;this.vo=a,l=_n(n,a),null!==t&&(this.no=_n(t,a))}}this.Po(l)}else null===this.Dh&&(this.Po(new Ri(-.5,.5)),this.vo=cn(null));this.so.eo=!0}Eo(){return this.ph()?en:this.Co()?hn:this.Ja()?t=>an(t,this.vo):null}n_(t,n,l){return void 0===n?(void 0===l&&(l=this.ca()),l.format(t)):n(t)}zh(t,n){return this.n_(t,this.bo.priceFormatter,n)}Go(t,n){return this.n_(t,this.bo.percentageFormatter,n)}};let gn=class gn{constructor(t,n){this._o=[],this.s_=new Map,this.Qa=0,this.e_=0,this.r_=1e3,this.uo=null,this.h_=new R,this.wl=t,this.Ui=n,this.l_=new nn(this);let l=n.W();this.a_=this.o_("left",l.leftPriceScale),this.__=this.o_("right",l.rightPriceScale),this.a_.Do().l(this.u_.bind(this,this.a_),this),this.__.Do().l(this.u_.bind(this,this.__),this),this.c_(l)}c_(t){if(t.leftPriceScale&&this.a_.Nh(t.leftPriceScale),t.rightPriceScale&&this.__.Nh(t.rightPriceScale),t.localization&&(this.a_.Sa(),this.__.Sa()),t.overlayPriceScales){let n=Array.from(this.s_.values());for(let l of n){let n=b(l[0].At());n.Nh(t.overlayPriceScales),t.localization&&n.Sa()}}}d_(t){switch(t){case"left":return this.a_;case"right":return this.__}return this.s_.has(t)?m(this.s_.get(t))[0].At():null}S(){this.qt().f_().p(this),this.a_.Do().p(this),this.__.Do().p(this),this._o.forEach(t=>{t.S&&t.S()}),this.h_.m()}v_(){return this.r_}p_(t){this.r_=t}qt(){return this.Ui}$i(){return this.e_}zt(){return this.Qa}m_(t){this.e_=t,this.b_()}Oo(t){this.Qa=t,this.a_.Oo(t),this.__.Oo(t),this._o.forEach(n=>{if(this.dr(n)){let l=n.At();null!==l&&l.Oo(t)}}),this.b_()}Ta(){return this._o}dr(t){let n=t.At();return null===n||this.a_!==n&&this.__!==n}Fo(t,n,l){let a=void 0!==l?l:this.g_().w_+1;this.M_(t,n,a)}jo(t){let n=this._o.indexOf(t);p(-1!==n,"removeDataSource: invalid data source"),this._o.splice(n,1);let l=b(t.At()).xa();if(this.s_.has(l)){let n=m(this.s_.get(l)),a=n.indexOf(t);-1!==a&&(n.splice(a,1),0===n.length&&this.s_.delete(l))}let a=t.At();a&&a.Ta().indexOf(t)>=0&&a.jo(t),null!==a&&(a.Wo(),this.x_(a)),this.uo=null}pr(t){return t===this.a_?"left":t===this.__?"right":"overlay"}S_(){return this.a_}k_(){return this.__}y_(t,n){t.Uo(n)}C_(t,n){t.qo(n),this.b_()}T_(t){t.Yo()}P_(t,n){t.Xo(n)}R_(t,n){t.Ko(n),this.b_()}D_(t){t.Zo()}b_(){this._o.forEach(t=>{t.On()})}vn(){let t=null;return this.Ui.W().rightPriceScale.visible&&0!==this.__.Ta().length?t=this.__:this.Ui.W().leftPriceScale.visible&&0!==this.a_.Ta().length?t=this.a_:0!==this._o.length&&(t=this._o[0].At()),null===t&&(t=this.__),t}vr(){let t=null;return this.Ui.W().rightPriceScale.visible?t=this.__:this.Ui.W().leftPriceScale.visible&&(t=this.a_),t}x_(t){null!==t&&t.yo()&&this.O_(t)}A_(t){let n=this.wl.Xs();t.So({Wn:!0}),null!==n&&t.t_(n),this.b_()}V_(){this.O_(this.a_),this.O_(this.__)}B_(){this.x_(this.a_),this.x_(this.__),this._o.forEach(t=>{this.dr(t)&&this.x_(t.At())}),this.b_(),this.Ui.Fh()}No(){return null===this.uo&&(this.uo=vn(this._o)),this.uo}I_(){return this.h_}z_(){return this.l_}O_(t){let n=t.Qo();if(n&&n.length>0&&!this.wl.Fi()){let n=this.wl.Xs();null!==n&&t.t_(n)}t.On()}g_(){let t=this.No();if(0===t.length)return{E_:0,w_:0};let n=0,l=0;for(let a=0;a<t.length;a++){let u=t[a].Zi();null!==u&&(u<n&&(n=u),u>l&&(l=u))}return{E_:n,w_:l}}M_(t,n,l){let a=this.d_(n);if(null===a&&(a=this.o_(n,this.Ui.W().overlayPriceScales)),this._o.push(t),!ut(n)){let l=this.s_.get(n)||[];l.push(t),this.s_.set(n,l)}a.Fo(t),t.Ji(a),t.Gi(l),this.x_(a),this.uo=null}u_(t,n,l){n.yr!==l.yr&&this.O_(t)}o_(t,n){let l=Object.assign({visible:!0,autoScale:!0},I(n)),a=new wn(t,l,this.Ui.W().layout,this.Ui.W().localization);return a.Oo(this.zt()),a}};let Mn=class Mn{constructor(t,n,l=50){this.Ke=0,this.Ze=1,this.Ge=1,this.Qe=new Map,this.Je=new Map,this.L_=t,this.N_=n,this.tr=l}F_(t){let n=t.time,l=this.N_.cacheKey(n),a=this.Qe.get(l);if(void 0!==a)return a.W_;if(this.Ke===this.tr){let t=this.Je.get(this.Ge);this.Je.delete(this.Ge),this.Qe.delete(m(t)),this.Ge++,this.Ke--}let u=this.L_(t);return this.Qe.set(l,{W_:u,er:this.Ze}),this.Je.set(this.Ze,l),this.Ke++,this.Ze++,u}};let xn=class xn{constructor(t,n){p(t<=n,"right should be >= left"),this.j_=t,this.H_=n}Os(){return this.j_}di(){return this.H_}U_(){return this.H_-this.j_+1}Kr(t){return this.j_<=t&&t<=this.H_}Mh(t){return this.j_===t.Os()&&this.H_===t.di()}};function Sn(t,n){return null===t||null===n?t===n:t.Mh(n)}let kn=class kn{constructor(){this.q_=new Map,this.Qe=null,this.Y_=!1}X_(t){this.Y_=t,this.Qe=null}K_(t,n){this.Z_(n),this.Qe=null;for(let l=n;l<t.length;++l){let n=t[l],a=this.q_.get(n.timeWeight);void 0===a&&(a=[],this.q_.set(n.timeWeight,a)),a.push({index:l,time:n.time,weight:n.timeWeight,originalTime:n.originalTime})}}G_(t,n){let l=Math.ceil(n/t);return null!==this.Qe&&this.Qe.J_===l||(this.Qe={Ea:this.Q_(l),J_:l}),this.Qe.Ea}Z_(t){if(0===t)return void this.q_.clear();let n=[];for(let l of(this.q_.forEach((l,a)=>{t<=l[0].index?n.push(a):l.splice(tP(l,t,n=>n.index<t),1/0)}),n))this.q_.delete(l)}Q_(t){let n=[];for(let l of Array.from(this.q_.keys()).sort((t,n)=>n-t)){if(!this.q_.get(l))continue;let a=n;n=[];let u=a.length,c=0,d=m(this.q_.get(l)),g=d.length,y=1/0,S=-1/0;for(let l=0;l<g;l++){let g=d[l],_=g.index;for(;c<u;){let t=a[c],l=t.index;if(!(l<_)){y=l;break}c++,n.push(t),S=l,y=1/0}if(y-_>=t&&_-S>=t)n.push(g),S=_;else if(this.Y_)return a}for(;c<u;c++)n.push(a[c])}return n}};let yn=class yn{constructor(t){this.tu=t}iu(){return null===this.tu?null:new xn(Math.floor(this.tu.Os()),Math.ceil(this.tu.di()))}nu(){return this.tu}static su(){return new yn(null)}};function Cn(t,n){return t.weight>n.weight?t:n}let Tn=class Tn{constructor(t,n,l,a){this.e_=0,this.eu=null,this.ru=[],this.fo=null,this.do=null,this.hu=new kn,this.lu=new Map,this.au=yn.su(),this.ou=!0,this._u=new R,this.uu=new R,this.cu=new R,this.du=null,this.fu=null,this.vu=[],this.cn=n,this.bo=l,this.pu=n.rightOffset,this.mu=n.barSpacing,this.Ui=t,this.N_=a,this.bu(),this.hu.X_(n.uniformDistribution)}W(){return this.cn}wu(t){D(this.bo,t),this.gu(),this.bu()}Nh(t,n){var l;D(this.cn,t),this.cn.fixLeftEdge&&this.Mu(),this.cn.fixRightEdge&&this.xu(),void 0!==t.barSpacing&&this.Ui.Gn(t.barSpacing),void 0!==t.rightOffset&&this.Ui.Jn(t.rightOffset),void 0!==t.minBarSpacing&&this.Ui.Gn(null!==(l=t.barSpacing)&&void 0!==l?l:this.mu),this.gu(),this.bu(),this.cu.m()}mn(t){var n,l;return null!==(l=null===(n=this.ru[t])||void 0===n?void 0:n.time)&&void 0!==l?l:null}qi(t){var n;return null!==(n=this.ru[t])&&void 0!==n?n:null}ya(t,n){if(this.ru.length<1)return null;if(this.N_.key(t)>this.N_.key(this.ru[this.ru.length-1].time))return n?this.ru.length-1:null;let l=tP(this.ru,this.N_.key(t),(t,n)=>this.N_.key(t.time)<n);return this.N_.key(t)<this.N_.key(this.ru[l].time)?n?l:null:l}Fi(){return 0===this.e_||0===this.ru.length||null===this.eu}ka(){return this.ru.length>0}Xs(){return this.Su(),this.au.iu()}ku(){return this.Su(),this.au.nu()}yu(){let t=this.Xs();if(null===t)return null;let n={from:t.Os(),to:t.di()};return this.Cu(n)}Cu(t){let n=Math.round(t.from),l=Math.round(t.to),a=b(this.Tu()),u=b(this.Pu());return{from:b(this.qi(Math.max(a,n))),to:b(this.qi(Math.min(u,l)))}}Ru(t){return{from:b(this.ya(t.from,!0)),to:b(this.ya(t.to,!0))}}$i(){return this.e_}m_(t){if(!isFinite(t)||t<=0||this.e_===t)return;let n=this.ku(),l=this.e_;if(this.e_=t,this.ou=!0,this.cn.lockVisibleTimeRangeOnResize&&0!==l){let n=this.mu*t/l;this.mu=n}this.cn.fixLeftEdge&&null!==n&&0>=n.Os()&&(this.pu-=Math.round((l-t)/this.mu)+1,this.ou=!0),this.Du(),this.Ou()}Et(t){if(this.Fi()||!A(t))return 0;let n=this.Au()+this.pu-t;return this.e_-(n+.5)*this.mu-1}Js(t,n){let l=this.Au(),a=void 0===n?0:n.from,u=void 0===n?t.length:n.to;for(let n=a;n<u;n++){let a=t[n].ut,u=l+this.pu-a,c=this.e_-(u+.5)*this.mu-1;t[n].et=c}}Vu(t){return Math.ceil(this.Bu(t))}Jn(t){this.ou=!0,this.pu=t,this.Ou(),this.Ui.Iu(),this.Ui.Fh()}he(){return this.mu}Gn(t){this.zu(t),this.Ou(),this.Ui.Iu(),this.Ui.Fh()}Eu(){return this.pu}Ea(){if(this.Fi())return null;if(null!==this.fu)return this.fu;let t=this.mu,n=5*(this.Ui.W().layout.fontSize+4)/8*(this.cn.tickMarkMaxCharacterLength||8),l=Math.round(n/t),a=b(this.Xs()),u=Math.max(a.Os(),a.Os()-l),c=Math.max(a.di(),a.di()-l),d=this.hu.G_(t,n),g=this.Tu()+l,y=this.Pu()-l,S=this.Lu(),_=this.cn.fixLeftEdge||S,L=this.cn.fixRightEdge||S,C=0;for(let t of d){let l;u<=t.index&&t.index<=c&&(C<this.vu.length?((l=this.vu[C]).coord=this.Et(t.index),l.label=this.Nu(t),l.weight=t.weight):(l={needAlignCoordinate:!1,coord:this.Et(t.index),label:this.Nu(t),weight:t.weight},this.vu.push(l)),this.mu>n/2&&!S?l.needAlignCoordinate=!1:l.needAlignCoordinate=_&&t.index<=g||L&&t.index>=y,C++)}return this.vu.length=C,this.fu=this.vu,this.vu}Fu(){this.ou=!0,this.Gn(this.cn.barSpacing),this.Jn(this.cn.rightOffset)}Wu(t){this.ou=!0,this.eu=t,this.Ou(),this.Mu()}ju(t,n){let l=this.Bu(t),a=this.he();this.Gn(a+n*(a/10)),this.cn.rightBarStaysOnScroll||this.Jn(this.Eu()+(l-this.Bu(t)))}Uo(t){this.fo&&this.Zo(),null===this.do&&null===this.du&&(this.Fi()||(this.do=t,this.Hu()))}qo(t){if(null===this.du)return;let n=yt(this.e_-t,0,this.e_),l=yt(this.e_-b(this.do),0,this.e_);0!==n&&0!==l&&this.Gn(this.du.he*n/l)}Yo(){null!==this.do&&(this.do=null,this.$u())}Xo(t){null===this.fo&&null===this.du&&(this.Fi()||(this.fo=t,this.Hu()))}Ko(t){if(null===this.fo)return;let n=(this.fo-t)/this.he();this.pu=b(this.du).Eu+n,this.ou=!0,this.Ou()}Zo(){null!==this.fo&&(this.fo=null,this.$u())}Uu(){this.qu(this.cn.rightOffset)}qu(t,n=400){if(!isFinite(t))throw RangeError("offset is required and must be finite number");if(!isFinite(n)||n<=0)throw RangeError("animationDuration (optional) must be finite positive number");let l=this.pu,a=performance.now();this.Ui.Xn({Yu:t=>(t-a)/n>=1,Xu:u=>{let c=(u-a)/n;return c>=1?t:l+(t-l)*c}})}gt(t,n){this.ou=!0,this.ru=t,this.hu.K_(t,n),this.Ou()}Ku(){return this._u}Zu(){return this.uu}Gu(){return this.cu}Au(){return this.eu||0}Ju(t){let n=t.U_();this.zu(this.e_/n),this.pu=t.di()-this.Au(),this.Ou(),this.ou=!0,this.Ui.Iu(),this.Ui.Fh()}Qu(){let t=this.Tu(),n=this.Pu();null!==t&&null!==n&&this.Ju(new xn(t,n+this.cn.rightOffset))}tc(t){let n=new xn(t.from,t.to);this.Ju(n)}Yi(t){return void 0!==this.bo.timeFormatter?this.bo.timeFormatter(t.originalTime):this.N_.formatHorzItem(t.time)}Lu(){let{handleScroll:t,handleScale:n}=this.Ui.W();return!(t.horzTouchDrag||t.mouseWheel||t.pressedMouseMove||t.vertTouchDrag||n.axisDoubleClickReset.time||n.axisPressedMouseMove.time||n.mouseWheel||n.pinch)}Tu(){return 0===this.ru.length?null:0}Pu(){return 0===this.ru.length?null:this.ru.length-1}ic(t){return(this.e_-1-t)/this.mu}Bu(t){let n=this.ic(t),l=this.Au()+this.pu-n;return Math.round(1e6*l)/1e6}zu(t){let n=this.mu;this.mu=t,this.Du(),n!==this.mu&&(this.ou=!0,this.nc())}Su(){if(!this.ou)return;if(this.ou=!1,this.Fi())return void this.sc(yn.su());let t=this.Au(),n=this.e_/this.mu,l=this.pu+t,a=new xn(l-n+1,l);this.sc(new yn(a))}Du(){let t=this.ec();if(this.mu<t&&(this.mu=t,this.ou=!0),0!==this.e_){let t=.5*this.e_;this.mu>t&&(this.mu=t,this.ou=!0)}}ec(){return this.cn.fixLeftEdge&&this.cn.fixRightEdge&&0!==this.ru.length?this.e_/this.ru.length:this.cn.minBarSpacing}Ou(){let t=this.rc();this.pu>t&&(this.pu=t,this.ou=!0);let n=this.hc();null!==n&&this.pu<n&&(this.pu=n,this.ou=!0)}hc(){let t=this.Tu(),n=this.eu;return null===t||null===n?null:t-n-1+(this.cn.fixLeftEdge?this.e_/this.mu:Math.min(2,this.ru.length))}rc(){return this.cn.fixRightEdge?0:this.e_/this.mu-Math.min(2,this.ru.length)}Hu(){this.du={he:this.he(),Eu:this.Eu()}}$u(){this.du=null}Nu(t){let n=this.lu.get(t.weight);return void 0===n&&(n=new Mn(t=>this.lc(t),this.N_),this.lu.set(t.weight,n)),n.F_(t)}lc(t){return this.N_.formatTickmark(t,this.bo)}sc(t){let n=this.au;this.au=t,Sn(n.iu(),this.au.iu())||this._u.m(),Sn(n.nu(),this.au.nu())||this.uu.m(),this.nc()}nc(){this.fu=null}gu(){this.nc(),this.lu.clear()}bu(){this.N_.updateFormatter(this.bo)}Mu(){if(!this.cn.fixLeftEdge)return;let t=this.Tu();if(null===t)return;let n=this.Xs();if(null===n)return;let l=n.Os()-t;if(l<0){let t=this.pu-l-1;this.Jn(t)}this.Du()}xu(){this.Ou(),this.Du()}};let Pn=class Pn extends j{constructor(t){super(),this.ac=new Map,this.Lt=t}Z(t){}J(t){if(!this.Lt.Tt)return;let{context:n,mediaSize:l}=t,a=0;for(let t of this.Lt.oc){if(0===t.Jt.length)continue;n.font=t.R;let u=this._c(n,t.Jt);u>l.width?t.ju=l.width/u:t.ju=1,a+=t.uc*t.ju}let u=0;switch(this.Lt.cc){case"top":u=0;break;case"center":u=Math.max((l.height-a)/2,0);break;case"bottom":u=Math.max(l.height-a,0)}for(let t of(n.fillStyle=this.Lt.O,this.Lt.oc)){n.save();let a=0;switch(this.Lt.dc){case"left":n.textAlign="left",a=t.uc/2;break;case"center":n.textAlign="center",a=l.width/2;break;case"right":n.textAlign="right",a=l.width-1-t.uc/2}n.translate(a,u),n.textBaseline="top",n.font=t.R,n.scale(t.ju,t.ju),n.fillText(t.Jt,0,t.fc),n.restore(),u+=t.uc*t.ju}}_c(t,n){let l=this.vc(t.font),a=l.get(n);return void 0===a&&(a=t.measureText(n).width,l.set(n,a)),a}vc(t){let n=this.ac.get(t);return void 0===n&&(n=new Map,this.ac.set(t,n)),n}};let Rn=class Rn{constructor(t){this.bt=!0,this.jt={Tt:!1,O:"",oc:[],cc:"center",dc:"center"},this.Ht=new Pn(this.jt),this.$t=t}gt(){this.bt=!0}xt(){return this.bt&&(this.St(),this.bt=!1),this.Ht}St(){let t=this.$t.W(),n=this.jt;n.Tt=t.visible,n.Tt&&(n.O=t.color,n.dc=t.horzAlign,n.cc=t.vertAlign,n.oc=[{Jt:t.text,R:N(t.fontSize,t.fontFamily,t.fontStyle),uc:1.2*t.fontSize,fc:0,ju:0}])}};let Dn=class Dn extends at{constructor(t,n){super(),this.cn=n,this.wn=new Rn(this)}Rn(){return[]}Pn(){return[this.wn]}W(){return this.cn}On(){this.wn.gt()}};(y=tr||(tr={}))[y.OnTouchEnd=0]="OnTouchEnd",y[y.OnNextTap=1]="OnNextTap";let zn=class zn{constructor(t,n,l){this.mc=[],this.bc=[],this.e_=0,this.wc=null,this.gc=new R,this.Mc=new R,this.xc=null,this.Sc=t,this.cn=n,this.N_=l,this.kc=new F(this),this.wl=new Tn(this,n.timeScale,this.cn.localization,l),this.wt=new _t(this,n.crosshair),this.yc=new Ji(n.crosshair),this.Cc=new Dn(this,n.watermark),this.Tc(),this.mc[0].p_(2e3),this.Pc=this.Rc(0),this.Dc=this.Rc(1)}$l(){this.Oc(ct.es())}Fh(){this.Oc(ct.ss())}sa(){this.Oc(new ct(1))}Ul(t){let n=this.Ac(t);this.Oc(n)}Vc(){return this.wc}Bc(t){let n=this.wc;this.wc=t,null!==n&&this.Ul(n.Ic),null!==t&&this.Ul(t.Ic)}W(){return this.cn}Nh(t){D(this.cn,t),this.mc.forEach(n=>n.c_(t)),void 0!==t.timeScale&&this.wl.Nh(t.timeScale),void 0!==t.localization&&this.wl.wu(t.localization),(t.leftPriceScale||t.rightPriceScale)&&this.gc.m(),this.Pc=this.Rc(0),this.Dc=this.Rc(1),this.$l()}zc(t,n){if("left"===t)return void this.Nh({leftPriceScale:n});if("right"===t)return void this.Nh({rightPriceScale:n});let l=this.Ec(t);null!==l&&(l.At.Nh(n),this.gc.m())}Ec(t){for(let n of this.mc){let l=n.d_(t);if(null!==l)return{Ut:n,At:l}}return null}yt(){return this.wl}Lc(){return this.mc}Nc(){return this.Cc}Fc(){return this.wt}Wc(){return this.Mc}jc(t,n){t.Oo(n),this.Iu()}m_(t){this.e_=t,this.wl.m_(this.e_),this.mc.forEach(n=>n.m_(t)),this.Iu()}Tc(t){let n=new gn(this.wl,this);void 0!==t?this.mc.splice(t,0,n):this.mc.push(n);let l=void 0===t?this.mc.length-1:t,a=ct.es();return a.Nn(l,{Fn:0,Wn:!0}),this.Oc(a),n}y_(t,n,l){t.y_(n,l)}C_(t,n,l){t.C_(n,l),this.ql(),this.Oc(this.Hc(t,2))}T_(t,n){t.T_(n),this.Oc(this.Hc(t,2))}P_(t,n,l){n.yo()||t.P_(n,l)}R_(t,n,l){n.yo()||(t.R_(n,l),this.ql(),this.Oc(this.Hc(t,2)))}D_(t,n){n.yo()||(t.D_(n),this.Oc(this.Hc(t,2)))}A_(t,n){t.A_(n),this.Oc(this.Hc(t,2))}$c(t){this.wl.Uo(t)}Uc(t,n){let l=this.yt();if(l.Fi()||0===n)return;let a=l.$i();t=Math.max(1,Math.min(t,a)),l.ju(t,n),this.Iu()}qc(t){this.Yc(0),this.Xc(t),this.Kc()}Zc(t){this.wl.qo(t),this.Iu()}Gc(){this.wl.Yo(),this.Fh()}Yc(t){this.wl.Xo(t)}Xc(t){this.wl.Ko(t),this.Iu()}Kc(){this.wl.Zo(),this.Fh()}Mt(){return this.bc}Jc(t,n,l,a,u){this.wt.gn(t,n);let c=NaN,d=this.wl.Vu(t),g=this.wl.Xs();null!==g&&(d=Math.min(Math.max(g.Os(),d),g.di()));let y=a.vn(),S=y.Pt();null!==S&&(c=y.pn(n,S)),c=this.yc.Ca(c,d,a),this.wt.kn(d,c,a),this.sa(),u||this.Mc.m(this.wt.kt(),{x:t,y:n},l)}Qc(t,n,l){let a=l.vn(),u=a.Pt(),c=a.Ot(t,b(u)),d=this.wl.ya(n,!0),g=this.wl.Et(b(d));this.Jc(g,c,null,l,!0)}td(t){this.Fc().Cn(),this.sa(),t||this.Mc.m(null,null,null)}ql(){let t=this.wt.Ut();if(null!==t){let n=this.wt.xn(),l=this.wt.Sn();this.Jc(n,l,null,t)}this.wt.On()}nd(t,n,l){let a=this.wl.mn(0);void 0!==n&&void 0!==l&&this.wl.gt(n,l);let u=this.wl.mn(0),c=this.wl.Au(),d=this.wl.Xs();if(null!==d&&null!==a&&null!==u){let n=d.Kr(c),g=this.N_.key(a)>this.N_.key(u),y=null!==t&&t>c&&!g,S=this.wl.W().allowShiftVisibleRangeOnWhitespaceReplacement,_=n&&(void 0!==l||S)&&this.wl.W().shiftVisibleRangeOnNewBar;if(y&&!_){let n=t-c;this.wl.Jn(this.wl.Eu()-n)}}this.wl.Wu(t)}Kl(t){null!==t&&t.B_()}cr(t){let n=this.mc.find(n=>n.No().includes(t));return void 0===n?null:n}Iu(){this.Cc.On(),this.mc.forEach(t=>t.B_()),this.ql()}S(){this.mc.forEach(t=>t.S()),this.mc.length=0,this.cn.localization.priceFormatter=void 0,this.cn.localization.percentageFormatter=void 0,this.cn.localization.timeFormatter=void 0}sd(){return this.kc}mr(){return this.kc.W()}f_(){return this.gc}ed(t,n,l){let a=this.mc[0],u=this.rd(n,t,a,l);return this.bc.push(u),1===this.bc.length?this.$l():this.Fh(),u}hd(t){let n=this.cr(t),l=this.bc.indexOf(t);p(-1!==l,"Series not found"),this.bc.splice(l,1),b(n).jo(t),t.S&&t.S()}Hl(t,n){let l=b(this.cr(t));l.jo(t);let a=this.Ec(n);if(null===a){let a=t.Zi();l.Fo(t,n,a)}else{let u=a.Ut===l?t.Zi():void 0;a.Ut.Fo(t,n,u)}}Qu(){let t=ct.ss();t.$n(),this.Oc(t)}ld(t){let n=ct.ss();n.Yn(t),this.Oc(n)}Zn(){let t=ct.ss();t.Zn(),this.Oc(t)}Gn(t){let n=ct.ss();n.Gn(t),this.Oc(n)}Jn(t){let n=ct.ss();n.Jn(t),this.Oc(n)}Xn(t){let n=ct.ss();n.Xn(t),this.Oc(n)}Un(){let t=ct.ss();t.Un(),this.Oc(t)}ad(){return this.cn.rightPriceScale.visible?"right":"left"}od(){return this.Dc}q(){return this.Pc}It(t){let n=this.Dc,l=this.Pc;if(n===l)return n;if(t=Math.max(0,Math.min(100,Math.round(100*t))),null===this.xc||this.xc.Ts!==l||this.xc.Ps!==n)this.xc={Ts:l,Ps:n,_d:new Map};else{let n=this.xc._d.get(t);if(void 0!==n)return n}let a=function(t,n,l){let[a,u,c,d]=T(t),[g,y,S,_]=T(n),L=[M(a+l*(g-a)),M(u+l*(y-u)),M(c+l*(S-c)),x(d+l*(_-d))];return`rgba(${L[0]}, ${L[1]}, ${L[2]}, ${L[3]})`}(l,n,t/100);return this.xc._d.set(t,a),a}Hc(t,n){let l=new ct(n);if(null!==t){let a=this.mc.indexOf(t);l.Nn(a,{Fn:n})}return l}Ac(t,n){return void 0===n&&(n=2),this.Hc(this.cr(t),n)}Oc(t){this.Sc&&this.Sc(t),this.mc.forEach(t=>t.z_().Wh().gt())}rd(t,n,l,a){let u=new Gi(this,t,n,l,a),c=void 0!==t.priceScaleId?t.priceScaleId:this.ad();return l.Fo(u,c),ut(c)||u.Nh(t),u}Rc(t){let n=this.cn.layout;return"gradient"===n.background.type?0===t?n.background.topColor:n.background.bottomColor:n.background.color}};function En(t){return!O(t)&&!V(t)}(S=to||(to={}))[S.Disabled=0]="Disabled",S[S.Continuous=1]="Continuous",S[S.OnDataUpdate=2]="OnDataUpdate",(_=ta||(ta={}))[_.LastBar=0]="LastBar",_[_.LastVisible=1]="LastVisible",(L=tu||(tu={})).Solid="solid",L.VerticalGradient="gradient",(C=tc||(tc={}))[C.Year=0]="Year",C[C.Month=1]="Month",C[C.DayOfMonth=2]="DayOfMonth",C[C.Time=3]="Time",C[C.TimeWithSeconds=4]="TimeWithSeconds";let Nn=t=>t.getUTCFullYear();let Wn=class Wn{constructor(t="yyyy-MM-dd",n="default"){this.ud=t,this.dd=n}F_(t){var n,l,a;return n=t,l=this.ud,a=this.dd,l.replace(/yyyy/g,ft(Nn(n),4)).replace(/yy/g,ft(Nn(n)%100,2)).replace(/MMMM/g,new Date(n.getUTCFullYear(),n.getUTCMonth(),1).toLocaleString(a,{month:"long"})).replace(/MMM/g,new Date(n.getUTCFullYear(),n.getUTCMonth(),1).toLocaleString(a,{month:"short"})).replace(/MM/g,ft(n.getUTCMonth()+1,2)).replace(/dd/g,ft(n.getUTCDate(),2))}};let jn=class jn{constructor(t){this.fd=t||"%h:%m:%s"}F_(t){return this.fd.replace("%h",ft(t.getUTCHours(),2)).replace("%m",ft(t.getUTCMinutes(),2)).replace("%s",ft(t.getUTCSeconds(),2))}};let tA={vd:"yyyy-MM-dd",pd:"%h:%m:%s",md:" ",bd:"default"};let $n=class $n{constructor(t={}){let n=Object.assign(Object.assign({},tA),t);this.wd=new Wn(n.vd,n.bd),this.gd=new jn(n.pd),this.Md=n.md}F_(t){return`${this.wd.F_(t)}${this.Md}${this.gd.F_(t)}`}};function Un(t){return 60*t*6e4}function qn(t){return 60*t*1e3}let tI=[{xd:1e3,Sd:10},{xd:qn(1),Sd:20},{xd:qn(5),Sd:21},{xd:qn(30),Sd:22},{xd:Un(1),Sd:30},{xd:Un(3),Sd:31},{xd:Un(6),Sd:32},{xd:Un(12),Sd:33}];function Kn(t,n){if(t.getUTCFullYear()!==n.getUTCFullYear())return 70;if(t.getUTCMonth()!==n.getUTCMonth())return 60;if(t.getUTCDate()!==n.getUTCDate())return 50;for(let l=tI.length-1;l>=0;--l)if(Math.floor(n.getTime()/tI[l].xd)!==Math.floor(t.getTime()/tI[l].xd))return tI[l].Sd;return 0}function Zn(t){let n=t;if(V(t)&&(n=Jn(t)),!En(n))throw Error("time must be of type BusinessDay");let l=new Date(Date.UTC(n.year,n.month-1,n.day,0,0,0,0));return{kd:Math.round(l.getTime()/1e3),yd:n}}function Gn(t){if(!O(t))throw Error("time must be of type isUTCTimestamp");return{kd:t}}function Jn(t){let n=new Date(t);if(isNaN(n.getTime()))throw Error(`Invalid date string=${t}, expected format=yyyy-mm-dd`);return{day:n.getUTCDate(),month:n.getUTCMonth()+1,year:n.getUTCFullYear()}}function Qn(t){V(t.time)&&(t.time=Jn(t.time))}let ts=class ts{options(){return this.cn}setOptions(t){this.cn=t,this.updateFormatter(t.localization)}preprocessData(t){Array.isArray(t)?function(t){t.forEach(Qn)}(t):Qn(t)}createConverterToInternalObj(t){return b(0===t.length?null:En(t[0].time)||V(t[0].time)?Zn:Gn)}key(t){return"object"==typeof t&&"kd"in t?t.kd:this.key(this.convertHorzItemToInternal(t))}cacheKey(t){return void 0===t.yd?new Date(1e3*t.kd).getTime():new Date(Date.UTC(t.yd.year,t.yd.month-1,t.yd.day)).getTime()}convertHorzItemToInternal(t){return O(t)?Gn(t):En(t)?Zn(t):Zn(Jn(t))}updateFormatter(t){if(!this.cn)return;let n=t.dateFormat;this.cn.timeScale.timeVisible?this.Cd=new $n({vd:n,pd:this.cn.timeScale.secondsVisible?"%h:%m:%s":"%h:%m",md:"   ",bd:t.locale}):this.Cd=new Wn(n,t.locale)}formatHorzItem(t){return this.Cd.F_(new Date(1e3*t.kd))}formatTickmark(t,n){let l=function(t,n,l){switch(t){case 0:case 10:return n?l?4:3:2;case 20:case 21:case 22:case 30:case 31:case 32:case 33:return n?3:2;case 50:return 2;case 60:return 1;case 70:return 0}}(t.weight,this.cn.timeScale.timeVisible,this.cn.timeScale.secondsVisible),a=this.cn.timeScale;if(void 0!==a.tickMarkFormatter){let u=a.tickMarkFormatter(t.originalTime,l,n.locale);if(null!==u)return u}return function(t,n,l){let a={};switch(n){case 0:a.year="numeric";break;case 1:a.month="short";break;case 2:a.day="numeric";break;case 3:a.hour12=!1,a.hour="2-digit",a.minute="2-digit";break;case 4:a.hour12=!1,a.hour="2-digit",a.minute="2-digit",a.second="2-digit"}let u=new Date(void 0===t.yd?1e3*t.kd:Date.UTC(t.yd.year,t.yd.month-1,t.yd.day));return new Date(u.getUTCFullYear(),u.getUTCMonth(),u.getUTCDate(),u.getUTCHours(),u.getUTCMinutes(),u.getUTCSeconds(),u.getUTCMilliseconds()).toLocaleString(l,a)}(t.time,l,n.locale)}maxTickMarkWeight(t){let n=t.reduce(Cn,t[0]).weight;return n>30&&n<50&&(n=30),n}fillWeightsForPoints(t,n){!function(t,n=0){if(0===t.length)return;let l=0===n?null:t[n-1].time.kd,a=null!==l?new Date(1e3*l):null,u=0;for(let c=n;c<t.length;++c){let n=t[c],d=new Date(1e3*n.time.kd);null!==a&&(n.timeWeight=Kn(d,a)),u+=n.time.kd-(l||n.time.kd),l=n.time.kd,a=d}if(0===n&&t.length>1){let n=Math.ceil(u/(t.length-1)),l=new Date(1e3*(t[0].time.kd-n));t[0].timeWeight=Kn(new Date(1e3*t[0].time.kd),l)}}(t,n)}static Td(t){return D({localization:{dateFormat:"dd MMM 'yy"}},null!=t?t:{})}};let tU="undefined"!=typeof window;function ns(){return!!tU&&window.navigator.userAgent.toLowerCase().indexOf("firefox")>-1}function ss(){return!!tU&&/iPhone|iPad|iPod/.test(window.navigator.platform)}function hs(t,n,l){let a=(t.Pd-n.Pd)/(t.ut-n.ut);return Math.sign(a)*Math.min(Math.abs(a),l)}let ls=class ls{constructor(t,n,l,a){this.Rd=null,this.Dd=null,this.Od=null,this.Ad=null,this.Vd=null,this.Bd=0,this.Id=0,this.zd=t,this.Ed=n,this.Ld=l,this.rs=a}Nd(t,n){if(null!==this.Rd){if(this.Rd.ut===n)return void(this.Rd.Pd=t);if(Math.abs(this.Rd.Pd-t)<this.rs)return}this.Ad=this.Od,this.Od=this.Dd,this.Dd=this.Rd,this.Rd={ut:n,Pd:t}}Dr(t,n){var l,a,u,c,d,g;if(null===this.Rd||null===this.Dd||n-this.Rd.ut>50)return;let y=0,S=hs(this.Rd,this.Dd,this.Ed),_=(l=this.Rd,a=this.Dd,l.Pd-a.Pd),L=[S],C=[_];if(y+=_,null!==this.Od){let t=hs(this.Dd,this.Od,this.Ed);if(Math.sign(t)===Math.sign(S)){let n=(u=this.Dd,c=this.Od,u.Pd-c.Pd);if(L.push(t),C.push(n),y+=n,null!==this.Ad){let t=hs(this.Od,this.Ad,this.Ed);if(Math.sign(t)===Math.sign(S)){let n=(d=this.Od,g=this.Ad,d.Pd-g.Pd);L.push(t),C.push(n),y+=n}}}}let k=0;for(let t=0;t<L.length;++t)k+=C[t]/y*L[t];Math.abs(k)<this.zd||(this.Vd={Pd:t,ut:n},this.Id=k,this.Bd=function(t,n){let l=Math.log(n);return Math.log(-(1*l/t))/l}(Math.abs(k),this.Ld))}Xu(t){let n=b(this.Vd),l=t-n.ut;return n.Pd+this.Id*(Math.pow(this.Ld,l)-1)/Math.log(this.Ld)}Yu(t){return null===this.Vd||this.Fd(t)===this.Bd}Fd(t){let n=t-b(this.Vd).ut;return Math.min(n,this.Bd)}};function as(t,n){let l=b(t.ownerDocument).createElement("canvas");t.appendChild(l);let a=function(t,n){if("device-pixel-content-box"===n.type)return new tv(t,n.transform,n.options);throw Error("Unsupported binding target")}(l,{type:"device-pixel-content-box",options:{allowResizeObserver:!1},transform:(t,n)=>({width:Math.max(t.width,n.width),height:Math.max(t.height,n.height)})});return a.resizeCanvasElement(n),a}function os(t,n,l,a){t.G&&t.G(n,l,a)}function _s(t,n,l,a){t.K(n,l,a)}function us(t,n,l,a){let u=t(l,a);for(let t of u){let l=t.xt();null!==l&&n(l)}}let ds=class ds{constructor(t,n,l){this.Wd=0,this.jd=null,this.Hd={et:Number.NEGATIVE_INFINITY,rt:Number.POSITIVE_INFINITY},this.$d=0,this.Ud=null,this.qd={et:Number.NEGATIVE_INFINITY,rt:Number.POSITIVE_INFINITY},this.Yd=null,this.Xd=!1,this.Kd=null,this.Zd=null,this.Gd=!1,this.Jd=!1,this.Qd=!1,this.tf=null,this.if=null,this.nf=null,this.sf=null,this.ef=null,this.rf=null,this.hf=null,this.lf=0,this.af=!1,this._f=!1,this.uf=!1,this.cf=0,this.df=null,this.ff=!ss(),this.vf=t=>{this.pf(t)},this.mf=t=>{if(this.bf(t)){let n=this.wf(t);if(++this.$d,this.Ud&&this.$d>1){let{gf:l}=this.Mf(ps(t),this.qd);l<30&&!this.Qd&&this.xf(n,this.kf.Sf),this.yf()}}else{let n=this.wf(t);if(++this.Wd,this.jd&&this.Wd>1){let{gf:l}=this.Mf(ps(t),this.Hd);l<5&&!this.Jd&&this.Cf(n,this.kf.Tf),this.Pf()}}},this.Rf=t,this.kf=n,this.cn=l,this.Df()}S(){null!==this.tf&&(this.tf(),this.tf=null),null!==this.if&&(this.if(),this.if=null),null!==this.sf&&(this.sf(),this.sf=null),null!==this.ef&&(this.ef(),this.ef=null),null!==this.rf&&(this.rf(),this.rf=null),null!==this.nf&&(this.nf(),this.nf=null),this.Of(),this.Pf()}Af(t){this.sf&&this.sf();let n=this.Vf.bind(this);if(this.sf=()=>{this.Rf.removeEventListener("mousemove",n)},this.Rf.addEventListener("mousemove",n),this.bf(t))return;let l=this.wf(t);this.Cf(l,this.kf.Bf),this.ff=!0}Pf(){null!==this.jd&&clearTimeout(this.jd),this.Wd=0,this.jd=null,this.Hd={et:Number.NEGATIVE_INFINITY,rt:Number.POSITIVE_INFINITY}}yf(){null!==this.Ud&&clearTimeout(this.Ud),this.$d=0,this.Ud=null,this.qd={et:Number.NEGATIVE_INFINITY,rt:Number.POSITIVE_INFINITY}}Vf(t){if(this.uf||null!==this.Zd||this.bf(t))return;let n=this.wf(t);this.Cf(n,this.kf.If),this.ff=!0}zf(t){let n=bs(t.changedTouches,b(this.df));if(null===n||(this.cf=ms(t),null!==this.hf)||this._f)return;this.af=!0;let l=this.Mf(ps(n),b(this.Zd)),{Ef:a,Lf:u,gf:c}=l;if(this.Gd||!(c<5)){if(!this.Gd){let t=.5*a,n=u>=t&&!this.cn.Nf(),l=t>u&&!this.cn.Ff();n||l||(this._f=!0),this.Gd=!0,this.Qd=!0,this.Of(),this.yf()}if(!this._f){let l=this.wf(t,n);this.xf(l,this.kf.Wf),vs(t)}}}jf(t){if(0!==t.button)return;let n=this.Mf(ps(t),b(this.Kd)),{gf:l}=n;if(l>=5&&(this.Jd=!0,this.Pf()),this.Jd){let n=this.wf(t);this.Cf(n,this.kf.Hf)}}Mf(t,n){let l=Math.abs(n.et-t.et),a=Math.abs(n.rt-t.rt);return{Ef:l,Lf:a,gf:l+a}}$f(t){let n=bs(t.changedTouches,b(this.df));if(null===n&&0===t.touches.length&&(n=t.changedTouches[0]),null===n)return;this.df=null,this.cf=ms(t),this.Of(),this.Zd=null,this.rf&&(this.rf(),this.rf=null);let l=this.wf(t,n);if(this.xf(l,this.kf.Uf),++this.$d,this.Ud&&this.$d>1){let{gf:t}=this.Mf(ps(n),this.qd);t<30&&!this.Qd&&this.xf(l,this.kf.Sf),this.yf()}else this.Qd||(this.xf(l,this.kf.qf),this.kf.qf&&vs(t));0===this.$d&&vs(t),0===t.touches.length&&this.Xd&&(this.Xd=!1,vs(t))}pf(t){if(0!==t.button)return;let n=this.wf(t);if(this.Kd=null,this.uf=!1,this.ef&&(this.ef(),this.ef=null),ns()&&this.Rf.ownerDocument.documentElement.removeEventListener("mouseleave",this.vf),!this.bf(t)){if(this.Cf(n,this.kf.Yf),++this.Wd,this.jd&&this.Wd>1){let{gf:l}=this.Mf(ps(t),this.Hd);l<5&&!this.Jd&&this.Cf(n,this.kf.Tf),this.Pf()}else this.Jd||this.Cf(n,this.kf.Xf)}}Of(){null!==this.Yd&&(clearTimeout(this.Yd),this.Yd=null)}Kf(t){if(null!==this.df)return;let n=t.changedTouches[0];this.df=n.identifier,this.cf=ms(t);let l=this.Rf.ownerDocument.documentElement;this.Qd=!1,this.Gd=!1,this._f=!1,this.Zd=ps(n),this.rf&&(this.rf(),this.rf=null);{let n=this.zf.bind(this),a=this.$f.bind(this);this.rf=()=>{l.removeEventListener("touchmove",n),l.removeEventListener("touchend",a)},l.addEventListener("touchmove",n,{passive:!1}),l.addEventListener("touchend",a,{passive:!1}),this.Of(),this.Yd=setTimeout(this.Zf.bind(this,t),240)}let a=this.wf(t,n);this.xf(a,this.kf.Gf),this.Ud||(this.$d=0,this.Ud=setTimeout(this.yf.bind(this),500),this.qd=ps(n))}Jf(t){if(0!==t.button)return;let n=this.Rf.ownerDocument.documentElement;ns()&&n.addEventListener("mouseleave",this.vf),this.Jd=!1,this.Kd=ps(t),this.ef&&(this.ef(),this.ef=null);{let t=this.jf.bind(this),l=this.pf.bind(this);this.ef=()=>{n.removeEventListener("mousemove",t),n.removeEventListener("mouseup",l)},n.addEventListener("mousemove",t),n.addEventListener("mouseup",l)}if(this.uf=!0,this.bf(t))return;let l=this.wf(t);this.Cf(l,this.kf.Qf),this.jd||(this.Wd=0,this.jd=setTimeout(this.Pf.bind(this),500),this.Hd=ps(t))}Df(){var t;this.Rf.addEventListener("mouseenter",this.Af.bind(this)),this.Rf.addEventListener("touchcancel",this.Of.bind(this));{let t=this.Rf.ownerDocument,i=t=>{this.kf.tv&&(t.composed&&this.Rf.contains(t.composedPath()[0])||t.target&&this.Rf.contains(t.target)||this.kf.tv())};this.if=()=>{t.removeEventListener("touchstart",i)},this.tf=()=>{t.removeEventListener("mousedown",i)},t.addEventListener("mousedown",i),t.addEventListener("touchstart",i,{passive:!0})}ss()&&(this.nf=()=>{this.Rf.removeEventListener("dblclick",this.mf)},this.Rf.addEventListener("dblclick",this.mf)),this.Rf.addEventListener("mouseleave",this.iv.bind(this)),this.Rf.addEventListener("touchstart",this.Kf.bind(this),{passive:!0}),t=this.Rf,tU&&void 0!==window.chrome&&t.addEventListener("mousedown",t=>{if(1===t.button)return t.preventDefault(),!1}),this.Rf.addEventListener("mousedown",this.Jf.bind(this)),this.nv(),this.Rf.addEventListener("touchmove",()=>{},{passive:!1})}nv(){void 0===this.kf.sv&&void 0===this.kf.ev&&void 0===this.kf.rv||(this.Rf.addEventListener("touchstart",t=>this.hv(t.touches),{passive:!0}),this.Rf.addEventListener("touchmove",t=>{if(2===t.touches.length&&null!==this.hf&&void 0!==this.kf.ev){let n=fs(t.touches[0],t.touches[1])/this.lf;this.kf.ev(this.hf,n),vs(t)}},{passive:!1}),this.Rf.addEventListener("touchend",t=>{this.hv(t.touches)}))}hv(t){1===t.length&&(this.af=!1),2!==t.length||this.af||this.Xd?this.lv():this.av(t)}av(t){let n=this.Rf.getBoundingClientRect()||{left:0,top:0};this.hf={et:(t[0].clientX-n.left+(t[1].clientX-n.left))/2,rt:(t[0].clientY-n.top+(t[1].clientY-n.top))/2},this.lf=fs(t[0],t[1]),void 0!==this.kf.sv&&this.kf.sv(),this.Of()}lv(){null!==this.hf&&(this.hf=null,void 0!==this.kf.rv&&this.kf.rv())}iv(t){if(this.sf&&this.sf(),this.bf(t)||!this.ff)return;let n=this.wf(t);this.Cf(n,this.kf.ov),this.ff=!ss()}Zf(t){let n=bs(t.touches,b(this.df));if(null===n)return;let l=this.wf(t,n);this.xf(l,this.kf._v),this.Qd=!0,this.Xd=!0}bf(t){return t.sourceCapabilities&&void 0!==t.sourceCapabilities.firesTouchEvents?t.sourceCapabilities.firesTouchEvents:ms(t)<this.cf+500}xf(t,n){n&&n.call(this.kf,t)}Cf(t,n){n&&n.call(this.kf,t)}wf(t,n){let l=n||t,a=this.Rf.getBoundingClientRect()||{left:0,top:0};return{clientX:l.clientX,clientY:l.clientY,pageX:l.pageX,pageY:l.pageY,screenX:l.screenX,screenY:l.screenY,localX:l.clientX-a.left,localY:l.clientY-a.top,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey,metaKey:t.metaKey,uv:!t.type.startsWith("mouse")&&"contextmenu"!==t.type&&"click"!==t.type,cv:t.type,dv:l.target,fv:t.view,vv:()=>{"touchstart"!==t.type&&vs(t)}}}};function fs(t,n){let l=t.clientX-n.clientX,a=t.clientY-n.clientY;return Math.sqrt(l*l+a*a)}function vs(t){t.cancelable&&t.preventDefault()}function ps(t){return{et:t.pageX,rt:t.pageY}}function ms(t){return t.timeStamp||performance.now()}function bs(t,n){for(let l=0;l<t.length;++l)if(t[l].identifier===n)return t[l];return null}function ws(t){return{Ic:t.Ic,pv:{wr:t.mv.externalId},bv:t.mv.cursorStyle}}function Ms(t,n){return l=>{var a,u,c,d;return(null!==(u=null===(a=l.At())||void 0===a?void 0:a.xa())&&void 0!==u?u:"")!==n?[]:null!==(d=null===(c=l.la)||void 0===c?void 0:c.call(l,t))&&void 0!==d?d:[]}}let xs=class xs{constructor(t,n,l,a){this.Li=null,this.wv=null,this.gv=!1,this.Mv=new si(200),this.Gr=null,this.xv=0,this.Sv=!1,this.kv=()=>{this.Sv||this.nn.yv().qt().Fh()},this.Cv=()=>{this.Sv||this.nn.yv().qt().Fh()},this.nn=t,this.cn=n,this.mo=n.layout,this.kc=l,this.Tv="left"===a,this.Pv=Ms("normal",a),this.Rv=Ms("top",a),this.Dv=Ms("bottom",a),this.Ov=document.createElement("div"),this.Ov.style.height="100%",this.Ov.style.overflow="hidden",this.Ov.style.width="25px",this.Ov.style.left="0",this.Ov.style.position="relative",this.Av=as(this.Ov,size({width:16,height:16})),this.Av.subscribeSuggestedBitmapSizeChanged(this.kv);let u=this.Av.canvasElement;u.style.position="absolute",u.style.zIndex="1",u.style.left="0",u.style.top="0",this.Vv=as(this.Ov,size({width:16,height:16})),this.Vv.subscribeSuggestedBitmapSizeChanged(this.Cv);let c=this.Vv.canvasElement;c.style.position="absolute",c.style.zIndex="2",c.style.left="0",c.style.top="0";let d={Qf:this.Bv.bind(this),Gf:this.Bv.bind(this),Hf:this.Iv.bind(this),Wf:this.Iv.bind(this),tv:this.zv.bind(this),Yf:this.Ev.bind(this),Uf:this.Ev.bind(this),Tf:this.Lv.bind(this),Sf:this.Lv.bind(this),Bf:this.Nv.bind(this),ov:this.Fv.bind(this)};this.Wv=new ds(this.Vv.canvasElement,d,{Nf:()=>!this.cn.handleScroll.vertTouchDrag,Ff:()=>!0})}S(){this.Wv.S(),this.Vv.unsubscribeSuggestedBitmapSizeChanged(this.Cv),this.Vv.dispose(),this.Av.unsubscribeSuggestedBitmapSizeChanged(this.kv),this.Av.dispose(),null!==this.Li&&this.Li.$o().p(this),this.Li=null}jv(){return this.Ov}P(){return this.mo.fontSize}Hv(){let t=this.kc.W();return this.Gr!==t.R&&(this.Mv.ir(),this.Gr=t.R),t}$v(){var t;if(null===this.Li)return 0;let n=0,l=this.Hv(),a=b(this.Av.canvasElement.getContext("2d"));a.save();let u=this.Li.Ea();a.font=this.Uv(),u.length>0&&(n=Math.max(this.Mv.Si(a,u[0].Za),this.Mv.Si(a,u[u.length-1].Za)));let c=this.qv();for(let t=c.length;t--;){let l=this.Mv.Si(a,c[t].Jt());l>n&&(n=l)}let d=this.Li.Pt();if(null!==d&&null!==this.wv){let t=this.Li.pn(1,d),l=this.Li.pn(this.wv.height-2,d);n=Math.max(n,this.Mv.Si(a,this.Li.Wi(Math.floor(Math.min(t,l))+.11111111111111,d)),this.Mv.Si(a,this.Li.Wi(Math.ceil(Math.max(t,l))-.11111111111111,d)))}a.restore();let g=n||34;return(t=Math.ceil(l.C+l.T+l.B+l.I+5+g))+t%2}Yv(t){null!==this.wv&&equalSizes(this.wv,t)||(this.wv=t,this.Sv=!0,this.Av.resizeCanvasElement(t),this.Vv.resizeCanvasElement(t),this.Sv=!1,this.Ov.style.width=`${t.width}px`,this.Ov.style.height=`${t.height}px`)}Xv(){return b(this.wv).width}Ji(t){this.Li!==t&&(null!==this.Li&&this.Li.$o().p(this),this.Li=t,t.$o().l(this.ao.bind(this),this))}At(){return this.Li}ir(){let t=this.nn.Kv();this.nn.yv().qt().A_(t,b(this.At()))}Zv(t){if(null===this.wv)return;if(1!==t){this.Gv(),this.Av.applySuggestedBitmapSize();let t=tryCreateCanvasRenderingTarget2D(this.Av);null!==t&&(t.useBitmapCoordinateSpace(t=>{this.Jv(t),this.Be(t)}),this.nn.Qv(t,this.Dv),this.tp(t),this.nn.Qv(t,this.Pv),this.ip(t))}this.Vv.applySuggestedBitmapSize();let n=tryCreateCanvasRenderingTarget2D(this.Vv);null!==n&&(n.useBitmapCoordinateSpace(({context:t,bitmapSize:n})=>{t.clearRect(0,0,n.width,n.height)}),this.np(n),this.nn.Qv(n,this.Rv))}sp(){return this.Av.bitmapSize}ep(t,n,l){let a=this.sp();a.width>0&&a.height>0&&t.drawImage(this.Av.canvasElement,n,l)}gt(){var t;null===(t=this.Li)||void 0===t||t.Ea()}Bv(t){if(null===this.Li||this.Li.Fi()||!this.cn.handleScale.axisPressedMouseMove.price)return;let n=this.nn.yv().qt(),l=this.nn.Kv();this.gv=!0,n.y_(l,this.Li,t.localY)}Iv(t){if(null===this.Li||!this.cn.handleScale.axisPressedMouseMove.price)return;let n=this.nn.yv().qt(),l=this.nn.Kv(),a=this.Li;n.C_(l,a,t.localY)}zv(){if(null===this.Li||!this.cn.handleScale.axisPressedMouseMove.price)return;let t=this.nn.yv().qt(),n=this.nn.Kv(),l=this.Li;this.gv&&(this.gv=!1,t.T_(n,l))}Ev(t){if(null===this.Li||!this.cn.handleScale.axisPressedMouseMove.price)return;let n=this.nn.yv().qt(),l=this.nn.Kv();this.gv=!1,n.T_(l,this.Li)}Lv(t){this.cn.handleScale.axisDoubleClickReset.price&&this.ir()}Nv(t){null!==this.Li&&(!this.nn.yv().qt().W().handleScale.axisPressedMouseMove.price||this.Li.ph()||this.Li.Co()||this.rp(1))}Fv(t){this.rp(0)}qv(){let t=[],n=null===this.Li?void 0:this.Li;return(l=>{for(let a=0;a<l.length;++a){let u=l[a].Rn(this.nn.Kv(),n);for(let n=0;n<u.length;n++)t.push(u[n])}})(this.nn.Kv().No()),t}Jv({context:t,bitmapSize:n}){let{width:l,height:a}=n,u=this.nn.Kv().qt(),c=u.q(),d=u.od();c===d?G(t,0,0,l,a,c):it(t,0,0,l,a,c,d)}Be({context:t,bitmapSize:n,horizontalPixelRatio:l}){let a;if(null===this.wv||null===this.Li||!this.Li.W().borderVisible)return;t.fillStyle=this.Li.W().borderColor;let u=Math.max(1,Math.floor(this.Hv().C*l));a=this.Tv?n.width-u:0,t.fillRect(a,0,u,n.height)}tp(t){if(null===this.wv||null===this.Li)return;let n=this.Li.Ea(),l=this.Li.W(),a=this.Hv(),u=this.Tv?this.wv.width-a.T:0;l.borderVisible&&l.ticksVisible&&t.useBitmapCoordinateSpace(({context:t,horizontalPixelRatio:c,verticalPixelRatio:d})=>{t.fillStyle=l.borderColor;let g=Math.max(1,Math.floor(d)),y=Math.floor(.5*d),S=Math.round(a.T*c);for(let l of(t.beginPath(),n))t.rect(Math.floor(u*c),Math.round(l.Aa*d)-y,S,g);t.fill()}),t.useMediaCoordinateSpace(({context:t})=>{var c;t.font=this.Uv(),t.fillStyle=null!==(c=l.textColor)&&void 0!==c?c:this.mo.textColor,t.textAlign=this.Tv?"right":"left",t.textBaseline="middle";let d=this.Tv?Math.round(u-a.B):Math.round(u+a.T+a.B),g=n.map(n=>this.Mv.xi(t,n.Za));for(let l=n.length;l--;){let a=n[l];t.fillText(a.Za,d,a.Aa+g[l])}})}Gv(){if(null===this.wv||null===this.Li)return;let t=this.wv.height/2,n=[],l=this.Li.No().slice(),a=this.nn.Kv(),u=this.Hv();this.Li===a.vr()&&this.nn.Kv().No().forEach(t=>{a.dr(t)&&l.push(t)});let c=this.Li.Ta()[0],d=this.Li;l.forEach(l=>{let u=l.Rn(a,d);u.forEach(t=>{t.Vi(null),t.Bi()&&n.push(t)}),c===l&&u.length>0&&(t=u[0].yi())}),n.forEach(t=>t.Vi(t.yi())),this.Li.W().alignLabels&&this.hp(n,u,t)}hp(t,n,l){if(null===this.wv)return;let a=t.filter(t=>t.yi()<=l),u=t.filter(t=>t.yi()>l);for(let l of(a.sort((t,n)=>n.yi()-t.yi()),a.length&&u.length&&u.push(a[0]),u.sort((t,n)=>t.yi()-n.yi()),t)){let t=Math.floor(l.zt(n)/2),a=l.yi();a>-t&&a<t&&l.Vi(t),a>this.wv.height-t&&a<this.wv.height+t&&l.Vi(this.wv.height-t)}for(let t=1;t<a.length;t++){let l=a[t],u=a[t-1],c=u.zt(n,!1),d=l.yi(),g=u.Ai();d>g-c&&l.Vi(g-c)}for(let t=1;t<u.length;t++){let l=u[t],a=u[t-1],c=a.zt(n,!0),d=l.yi(),g=a.Ai();d<g+c&&l.Vi(g+c)}}ip(t){if(null===this.wv)return;let n=this.qv(),l=this.Hv(),a=this.Tv?"right":"left";n.forEach(n=>{n.Ii()&&n.xt(b(this.Li)).K(t,l,this.Mv,a)})}np(t){if(null===this.wv||null===this.Li)return;let n=this.nn.yv().qt(),l=[],a=this.nn.Kv(),u=n.Fc().Rn(a,this.Li);u.length&&l.push(u);let c=this.Hv(),d=this.Tv?"right":"left";l.forEach(n=>{n.forEach(n=>{n.xt(b(this.Li)).K(t,c,this.Mv,d)})})}rp(t){this.Ov.style.cursor=1===t?"ns-resize":"default"}ao(){let t=this.$v();this.xv<t&&this.nn.yv().qt().$l(),this.xv=t}Uv(){return N(this.mo.fontSize,this.mo.fontFamily)}};function Ss(t,n){var l,a;return null!==(a=null===(l=t.ra)||void 0===l?void 0:l.call(t,n))&&void 0!==a?a:[]}function ks(t,n){var l,a;return null!==(a=null===(l=t.Pn)||void 0===l?void 0:l.call(t,n))&&void 0!==a?a:[]}function ys(t,n){var l,a;return null!==(a=null===(l=t.Qi)||void 0===l?void 0:l.call(t,n))&&void 0!==a?a:[]}function Cs(t,n){var l,a;return null!==(a=null===(l=t.na)||void 0===l?void 0:l.call(t,n))&&void 0!==a?a:[]}let Ts=class Ts{constructor(t,n){this.wv=size({width:0,height:0}),this.lp=null,this.ap=null,this.op=null,this._p=!1,this.up=new R,this.cp=new R,this.dp=0,this.fp=!1,this.vp=null,this.pp=!1,this.mp=null,this.bp=null,this.Sv=!1,this.kv=()=>{this.Sv||null===this.wp||this.Ui().Fh()},this.Cv=()=>{this.Sv||null===this.wp||this.Ui().Fh()},this.gp=t,this.wp=n,this.wp.I_().l(this.Mp.bind(this),this,!0),this.xp=document.createElement("td"),this.xp.style.padding="0",this.xp.style.position="relative";let l=document.createElement("div");l.style.width="100%",l.style.height="100%",l.style.position="relative",l.style.overflow="hidden",this.Sp=document.createElement("td"),this.Sp.style.padding="0",this.kp=document.createElement("td"),this.kp.style.padding="0",this.xp.appendChild(l),this.Av=as(l,size({width:16,height:16})),this.Av.subscribeSuggestedBitmapSizeChanged(this.kv);let a=this.Av.canvasElement;a.style.position="absolute",a.style.zIndex="1",a.style.left="0",a.style.top="0",this.Vv=as(l,size({width:16,height:16})),this.Vv.subscribeSuggestedBitmapSizeChanged(this.Cv);let u=this.Vv.canvasElement;u.style.position="absolute",u.style.zIndex="2",u.style.left="0",u.style.top="0",this.yp=document.createElement("tr"),this.yp.appendChild(this.Sp),this.yp.appendChild(this.xp),this.yp.appendChild(this.kp),this.Cp(),this.Wv=new ds(this.Vv.canvasElement,this,{Nf:()=>null===this.vp&&!this.gp.W().handleScroll.vertTouchDrag,Ff:()=>null===this.vp&&!this.gp.W().handleScroll.horzTouchDrag})}S(){null!==this.lp&&this.lp.S(),null!==this.ap&&this.ap.S(),this.Vv.unsubscribeSuggestedBitmapSizeChanged(this.Cv),this.Vv.dispose(),this.Av.unsubscribeSuggestedBitmapSizeChanged(this.kv),this.Av.dispose(),null!==this.wp&&this.wp.I_().p(this),this.Wv.S()}Kv(){return b(this.wp)}Tp(t){null!==this.wp&&this.wp.I_().p(this),this.wp=t,null!==this.wp&&this.wp.I_().l(Ts.prototype.Mp.bind(this),this,!0),this.Cp()}yv(){return this.gp}jv(){return this.yp}Cp(){if(null!==this.wp&&(this.Pp(),0!==this.Ui().Mt().length)){if(null!==this.lp){let t=this.wp.S_();this.lp.Ji(b(t))}if(null!==this.ap){let t=this.wp.k_();this.ap.Ji(b(t))}}}Rp(){null!==this.lp&&this.lp.gt(),null!==this.ap&&this.ap.gt()}v_(){return null!==this.wp?this.wp.v_():0}p_(t){this.wp&&this.wp.p_(t)}Bf(t){if(!this.wp)return;this.Dp();let n=t.localX,l=t.localY;this.Op(n,l,t)}Qf(t){this.Dp(),this.Ap(),this.Op(t.localX,t.localY,t)}If(t){var n;if(!this.wp)return;this.Dp();let l=t.localX,a=t.localY;this.Op(l,a,t);let u=this.br(l,a);this.gp.Vp(null!==(n=null==u?void 0:u.bv)&&void 0!==n?n:null),this.Ui().Bc(u&&{Ic:u.Ic,pv:u.pv})}Xf(t){null!==this.wp&&(this.Dp(),this.Bp(t))}Tf(t){null!==this.wp&&this.Ip(this.cp,t)}Sf(t){this.Tf(t)}Hf(t){this.Dp(),this.zp(t),this.Op(t.localX,t.localY,t)}Yf(t){null!==this.wp&&(this.Dp(),this.fp=!1,this.Ep(t))}qf(t){null!==this.wp&&this.Bp(t)}_v(t){if(this.fp=!0,null===this.vp){let n={x:t.localX,y:t.localY};this.Lp(n,n,t)}}ov(t){null!==this.wp&&(this.Dp(),this.wp.qt().Bc(null),this.Np())}Fp(){return this.up}Wp(){return this.cp}sv(){this.dp=1,this.Ui().Un()}ev(t,n){if(!this.gp.W().handleScale.pinch)return;let l=5*(n-this.dp);this.dp=n,this.Ui().Uc(t.et,l)}Gf(t){this.fp=!1,this.pp=null!==this.vp,this.Ap();let n=this.Ui().Fc();null!==this.vp&&n.Tt()&&(this.mp={x:n.Kt(),y:n.Zt()},this.vp={x:t.localX,y:t.localY})}Wf(t){if(null===this.wp)return;let n=t.localX,l=t.localY;if(null===this.vp)this.zp(t);else{this.pp=!1;let a=b(this.mp),u=a.x+(n-this.vp.x),c=a.y+(l-this.vp.y);this.Op(u,c,t)}}Uf(t){0===this.yv().W().trackingMode.exitMode&&(this.pp=!0),this.jp(),this.Ep(t)}br(t,n){let l=this.wp;return null===l?null:function(t,n,l){let a=t.No(),u=function(t,n,l){var a,u,c,d;let g,y;for(let S of t){let t=null!==(u=null===(a=S.oa)||void 0===a?void 0:a.call(S,n,l))&&void 0!==u?u:[];for(let n of t)c=n.zOrder,(d=null==g?void 0:g.zOrder)&&("top"!==c||"top"===d)&&("normal"!==c||"bottom"!==d)||(g=n,y=S)}return g&&y?{mv:g,Ic:y}:null}(a,n,l);if("top"===(null==u?void 0:u.mv.zOrder))return ws(u);for(let c of a){if(u&&u.Ic===c&&"bottom"!==u.mv.zOrder&&!u.mv.isBackground)return ws(u);let a=function(t,n,l){for(let a of t){let t=a.xt();if(null!==t&&t.br){let u=t.br(n,l);if(null!==u)return{fv:a,pv:u}}}return null}(c.Pn(t),n,l);if(null!==a)return{Ic:c,fv:a.fv,pv:a.pv};if(u&&u.Ic===c&&"bottom"!==u.mv.zOrder&&u.mv.isBackground)return ws(u)}return(null==u?void 0:u.mv)?ws(u):null}(l,t,n)}Hp(t,n){b("left"===n?this.lp:this.ap).Yv(size({width:t,height:this.wv.height}))}$p(){return this.wv}Yv(t){equalSizes(this.wv,t)||(this.wv=t,this.Sv=!0,this.Av.resizeCanvasElement(t),this.Vv.resizeCanvasElement(t),this.Sv=!1,this.xp.style.width=t.width+"px",this.xp.style.height=t.height+"px")}Up(){let t=b(this.wp);for(let n of(t.x_(t.S_()),t.x_(t.k_()),t.Ta()))if(t.dr(n)){let l=n.At();null!==l&&t.x_(l),n.On()}}sp(){return this.Av.bitmapSize}ep(t,n,l){let a=this.sp();a.width>0&&a.height>0&&t.drawImage(this.Av.canvasElement,n,l)}Zv(t){if(0===t||null===this.wp)return;if(t>1&&this.Up(),null!==this.lp&&this.lp.Zv(t),null!==this.ap&&this.ap.Zv(t),1!==t){this.Av.applySuggestedBitmapSize();let t=tryCreateCanvasRenderingTarget2D(this.Av);null!==t&&(t.useBitmapCoordinateSpace(t=>{this.Jv(t)}),this.wp&&(this.qp(t,Ss),this.Yp(t),this.Xp(t),this.qp(t,ks),this.qp(t,ys)))}this.Vv.applySuggestedBitmapSize();let n=tryCreateCanvasRenderingTarget2D(this.Vv);null!==n&&(n.useBitmapCoordinateSpace(({context:t,bitmapSize:n})=>{t.clearRect(0,0,n.width,n.height)}),this.Kp(n),this.qp(n,Cs))}Zp(){return this.lp}Gp(){return this.ap}Qv(t,n){this.qp(t,n)}Mp(){null!==this.wp&&this.wp.I_().p(this),this.wp=null}Bp(t){this.Ip(this.up,t)}Ip(t,n){let l=n.localX,a=n.localY;t.M()&&t.m(this.Ui().yt().Vu(l),{x:l,y:a},n)}Jv({context:t,bitmapSize:n}){let{width:l,height:a}=n,u=this.Ui(),c=u.q(),d=u.od();c===d?G(t,0,0,l,a,d):it(t,0,0,l,a,c,d)}Yp(t){let n=b(this.wp).z_().Wh().xt();null!==n&&n.K(t,!1)}Xp(t){let n=this.Ui().Nc();this.Jp(t,ks,os,n),this.Jp(t,ks,_s,n)}Kp(t){this.Jp(t,ks,_s,this.Ui().Fc())}qp(t,n){let l=b(this.wp).No();for(let a of l)this.Jp(t,n,os,a);for(let a of l)this.Jp(t,n,_s,a)}Jp(t,n,l,a){let u=b(this.wp),c=u.qt().Vc(),d=null!==c&&c.Ic===a,g=null!==c&&d&&void 0!==c.pv?c.pv.gr:void 0;us(n,n=>l(n,t,d,g),a,u)}Pp(){if(null===this.wp)return;let t=this.gp,n=this.wp.S_().W().visible,l=this.wp.k_().W().visible;n||null===this.lp||(this.Sp.removeChild(this.lp.jv()),this.lp.S(),this.lp=null),l||null===this.ap||(this.kp.removeChild(this.ap.jv()),this.ap.S(),this.ap=null);let a=t.qt().sd();n&&null===this.lp&&(this.lp=new xs(this,t.W(),a,"left"),this.Sp.appendChild(this.lp.jv())),l&&null===this.ap&&(this.ap=new xs(this,t.W(),a,"right"),this.kp.appendChild(this.ap.jv()))}Qp(t){return t.uv&&this.fp||null!==this.vp}tm(t){return Math.max(0,Math.min(t,this.wv.width-1))}im(t){return Math.max(0,Math.min(t,this.wv.height-1))}Op(t,n,l){this.Ui().Jc(this.tm(t),this.im(n),l,b(this.wp))}Np(){this.Ui().td()}jp(){this.pp&&(this.vp=null,this.Np())}Lp(t,n,l){this.vp=t,this.pp=!1,this.Op(n.x,n.y,l);let a=this.Ui().Fc();this.mp={x:a.Kt(),y:a.Zt()}}Ui(){return this.gp.qt()}Ep(t){if(!this._p)return;let n=this.Ui(),l=this.Kv();if(n.D_(l,l.vn()),this.op=null,this._p=!1,n.Kc(),null!==this.bp){let t=performance.now(),l=n.yt();this.bp.Dr(l.Eu(),t),this.bp.Yu(t)||n.Xn(this.bp)}}Dp(){this.vp=null}Ap(){if(this.wp){if(this.Ui().Un(),document.activeElement!==document.body&&document.activeElement!==document.documentElement)b(document.activeElement).blur();else{let t=document.getSelection();null!==t&&t.removeAllRanges()}this.wp.vn().Fi()||this.Ui().yt().Fi()}}zp(t){if(null===this.wp)return;let n=this.Ui(),l=n.yt();if(l.Fi())return;let a=this.gp.W(),u=a.handleScroll,c=a.kineticScroll;if((!u.pressedMouseMove||t.uv)&&(!u.horzTouchDrag&&!u.vertTouchDrag||!t.uv))return;let d=this.wp.vn(),g=performance.now();if(null!==this.op||this.Qp(t)||(this.op={x:t.clientX,y:t.clientY,kd:g,nm:t.localX,sm:t.localY}),null!==this.op&&!this._p&&(this.op.x!==t.clientX||this.op.y!==t.clientY)){if(t.uv&&c.touch||!t.uv&&c.mouse){let t=l.he();this.bp=new ls(.2/t,7/t,.997,15/t),this.bp.Nd(l.Eu(),this.op.kd)}else this.bp=null;d.Fi()||n.P_(this.wp,d,t.localY),n.Yc(t.localX),this._p=!0}this._p&&(d.Fi()||n.R_(this.wp,d,t.localY),n.Xc(t.localX),null!==this.bp&&this.bp.Nd(l.Eu(),g))}};let Ps=class Ps{constructor(t,n,l,a,u){this.bt=!0,this.wv=size({width:0,height:0}),this.kv=()=>this.Zv(3),this.Tv="left"===t,this.kc=l.sd,this.cn=n,this.rm=a,this.hm=u,this.Ov=document.createElement("div"),this.Ov.style.width="25px",this.Ov.style.height="100%",this.Ov.style.overflow="hidden",this.Av=as(this.Ov,size({width:16,height:16})),this.Av.subscribeSuggestedBitmapSizeChanged(this.kv)}S(){this.Av.unsubscribeSuggestedBitmapSizeChanged(this.kv),this.Av.dispose()}jv(){return this.Ov}$p(){return this.wv}Yv(t){equalSizes(this.wv,t)||(this.wv=t,this.Av.resizeCanvasElement(t),this.Ov.style.width=`${t.width}px`,this.Ov.style.height=`${t.height}px`,this.bt=!0)}Zv(t){if(t<3&&!this.bt||0===this.wv.width||0===this.wv.height)return;this.bt=!1,this.Av.applySuggestedBitmapSize();let n=tryCreateCanvasRenderingTarget2D(this.Av);null!==n&&n.useBitmapCoordinateSpace(t=>{this.Jv(t),this.Be(t)})}sp(){return this.Av.bitmapSize}ep(t,n,l){let a=this.sp();a.width>0&&a.height>0&&t.drawImage(this.Av.canvasElement,n,l)}Be({context:t,bitmapSize:n,horizontalPixelRatio:l,verticalPixelRatio:a}){if(!this.rm())return;t.fillStyle=this.cn.timeScale.borderColor;let u=Math.floor(this.kc.W().C*l),c=Math.floor(this.kc.W().C*a),d=this.Tv?n.width-u:0;t.fillRect(d,0,u,c)}Jv({context:t,bitmapSize:n}){G(t,0,0,n.width,n.height,this.hm())}};function Rs(t){return n=>{var l,a;return null!==(a=null===(l=n.aa)||void 0===l?void 0:l.call(n,t))&&void 0!==a?a:[]}}let tq=Rs("normal"),t$=Rs("top"),tj=Rs("bottom");let Vs=class Vs{constructor(t,n){this.lm=null,this.am=null,this.k=null,this.om=!1,this.wv=size({width:0,height:0}),this._m=new R,this.Mv=new si(5),this.Sv=!1,this.kv=()=>{this.Sv||this.gp.qt().Fh()},this.Cv=()=>{this.Sv||this.gp.qt().Fh()},this.gp=t,this.N_=n,this.cn=t.W().layout,this.um=document.createElement("tr"),this.dm=document.createElement("td"),this.dm.style.padding="0",this.fm=document.createElement("td"),this.fm.style.padding="0",this.Ov=document.createElement("td"),this.Ov.style.height="25px",this.Ov.style.padding="0",this.vm=document.createElement("div"),this.vm.style.width="100%",this.vm.style.height="100%",this.vm.style.position="relative",this.vm.style.overflow="hidden",this.Ov.appendChild(this.vm),this.Av=as(this.vm,size({width:16,height:16})),this.Av.subscribeSuggestedBitmapSizeChanged(this.kv);let l=this.Av.canvasElement;l.style.position="absolute",l.style.zIndex="1",l.style.left="0",l.style.top="0",this.Vv=as(this.vm,size({width:16,height:16})),this.Vv.subscribeSuggestedBitmapSizeChanged(this.Cv);let a=this.Vv.canvasElement;a.style.position="absolute",a.style.zIndex="2",a.style.left="0",a.style.top="0",this.um.appendChild(this.dm),this.um.appendChild(this.Ov),this.um.appendChild(this.fm),this.pm(),this.gp.qt().f_().l(this.pm.bind(this),this),this.Wv=new ds(this.Vv.canvasElement,this,{Nf:()=>!0,Ff:()=>!this.gp.W().handleScroll.horzTouchDrag})}S(){this.Wv.S(),null!==this.lm&&this.lm.S(),null!==this.am&&this.am.S(),this.Vv.unsubscribeSuggestedBitmapSizeChanged(this.Cv),this.Vv.dispose(),this.Av.unsubscribeSuggestedBitmapSizeChanged(this.kv),this.Av.dispose()}jv(){return this.um}bm(){return this.lm}wm(){return this.am}Qf(t){if(this.om)return;this.om=!0;let n=this.gp.qt();!n.yt().Fi()&&this.gp.W().handleScale.axisPressedMouseMove.time&&n.$c(t.localX)}Gf(t){this.Qf(t)}tv(){let t=this.gp.qt();!t.yt().Fi()&&this.om&&(this.om=!1,this.gp.W().handleScale.axisPressedMouseMove.time&&t.Gc())}Hf(t){let n=this.gp.qt();!n.yt().Fi()&&this.gp.W().handleScale.axisPressedMouseMove.time&&n.Zc(t.localX)}Wf(t){this.Hf(t)}Yf(){this.om=!1;let t=this.gp.qt();t.yt().Fi()&&!this.gp.W().handleScale.axisPressedMouseMove.time||t.Gc()}Uf(){this.Yf()}Tf(){this.gp.W().handleScale.axisDoubleClickReset.time&&this.gp.qt().Zn()}Sf(){this.Tf()}Bf(){this.gp.qt().W().handleScale.axisPressedMouseMove.time&&this.rp(1)}ov(){this.rp(0)}$p(){return this.wv}gm(){return this._m}Mm(t,n,l){equalSizes(this.wv,t)||(this.wv=t,this.Sv=!0,this.Av.resizeCanvasElement(t),this.Vv.resizeCanvasElement(t),this.Sv=!1,this.Ov.style.width=`${t.width}px`,this.Ov.style.height=`${t.height}px`,this._m.m(t)),null!==this.lm&&this.lm.Yv(size({width:n,height:t.height})),null!==this.am&&this.am.Yv(size({width:l,height:t.height}))}xm(){let t=this.Sm();return Math.ceil(t.C+t.T+t.P+t.L+t.V+t.km)}gt(){this.gp.qt().yt().Ea()}sp(){return this.Av.bitmapSize}ep(t,n,l){let a=this.sp();a.width>0&&a.height>0&&t.drawImage(this.Av.canvasElement,n,l)}Zv(t){if(0===t)return;if(1!==t){this.Av.applySuggestedBitmapSize();let n=tryCreateCanvasRenderingTarget2D(this.Av);null!==n&&(n.useBitmapCoordinateSpace(t=>{this.Jv(t),this.Be(t),this.ym(n,tj)}),this.tp(n),this.ym(n,tq)),null!==this.lm&&this.lm.Zv(t),null!==this.am&&this.am.Zv(t)}this.Vv.applySuggestedBitmapSize();let n=tryCreateCanvasRenderingTarget2D(this.Vv);null!==n&&(n.useBitmapCoordinateSpace(({context:t,bitmapSize:n})=>{t.clearRect(0,0,n.width,n.height)}),this.Cm([...this.gp.qt().Mt(),this.gp.qt().Fc()],n),this.ym(n,t$))}ym(t,n){let l=this.gp.qt().Mt();for(let a of l)us(n,n=>os(n,t,!1,void 0),a,void 0);for(let a of l)us(n,n=>_s(n,t,!1,void 0),a,void 0)}Jv({context:t,bitmapSize:n}){G(t,0,0,n.width,n.height,this.gp.qt().od())}Be({context:t,bitmapSize:n,verticalPixelRatio:l}){if(this.gp.W().timeScale.borderVisible){t.fillStyle=this.Tm();let a=Math.max(1,Math.floor(this.Sm().C*l));t.fillRect(0,0,n.width,a)}}tp(t){let n=this.gp.qt().yt(),l=n.Ea();if(!l||0===l.length)return;let a=this.N_.maxTickMarkWeight(l),u=this.Sm(),c=n.W();c.borderVisible&&c.ticksVisible&&t.useBitmapCoordinateSpace(({context:t,horizontalPixelRatio:n,verticalPixelRatio:a})=>{t.strokeStyle=this.Tm(),t.fillStyle=this.Tm();let c=Math.max(1,Math.floor(n)),d=Math.floor(.5*n);t.beginPath();let g=Math.round(u.T*a);for(let a=l.length;a--;){let u=Math.round(l[a].coord*n);t.rect(u-d,0,c,g)}t.fill()}),t.useMediaCoordinateSpace(({context:t})=>{let n=u.C+u.T+u.L+u.P/2;for(let u of(t.textAlign="center",t.textBaseline="middle",t.fillStyle=this.$(),t.font=this.Uv(),l))if(u.weight<a){let l=u.needAlignCoordinate?this.Pm(t,u.coord,u.label):u.coord;t.fillText(u.label,l,n)}for(let u of(t.font=this.Rm(),l))if(u.weight>=a){let l=u.needAlignCoordinate?this.Pm(t,u.coord,u.label):u.coord;t.fillText(u.label,l,n)}})}Pm(t,n,l){let a=this.Mv.Si(t,l),u=Math.floor(n-a/2)+.5;return u<0?n+=Math.abs(0-u):u+a>this.wv.width&&(n-=Math.abs(this.wv.width-(u+a))),n}Cm(t,n){let l=this.Sm();for(let a of t)for(let t of a.tn())t.xt().K(n,l)}Tm(){return this.gp.W().timeScale.borderColor}$(){return this.cn.textColor}j(){return this.cn.fontSize}Uv(){return N(this.j(),this.cn.fontFamily)}Rm(){return N(this.j(),this.cn.fontFamily,"bold")}Sm(){null===this.k&&(this.k={C:1,N:NaN,L:NaN,V:NaN,Hi:NaN,T:5,P:NaN,R:"",ji:new si,km:0});let t=this.k,n=this.Uv();if(t.R!==n){let l=this.j();t.P=l,t.R=n,t.L=3*l/12,t.V=3*l/12,t.Hi=9*l/12,t.N=0,t.km=4*l/12,t.ji.ir()}return this.k}rp(t){this.Ov.style.cursor=1===t?"ew-resize":"default"}pm(){let t=this.gp.qt(),n=t.W();n.leftPriceScale.visible||null===this.lm||(this.dm.removeChild(this.lm.jv()),this.lm.S(),this.lm=null),n.rightPriceScale.visible||null===this.am||(this.fm.removeChild(this.am.jv()),this.am.S(),this.am=null);let l={sd:this.gp.qt().sd()},s=()=>n.leftPriceScale.borderVisible&&t.yt().W().borderVisible,e=()=>t.od();n.leftPriceScale.visible&&null===this.lm&&(this.lm=new Ps("left",n,l,s,e),this.dm.appendChild(this.lm.jv())),n.rightPriceScale.visible&&null===this.am&&(this.am=new Ps("right",n,l,s,e),this.fm.appendChild(this.am.jv()))}};let tJ=!!tU&&!!navigator.userAgentData&&navigator.userAgentData.brands.some(t=>t.brand.includes("Chromium"))&&!!tU&&((null===(td=null==navigator?void 0:navigator.userAgentData)||void 0===td?void 0:td.platform)?"Windows"===navigator.userAgentData.platform:navigator.userAgent.toLowerCase().indexOf("win")>=0);let zs=class zs{constructor(t,n,l){var a;this.Dm=[],this.Om=0,this.Qa=0,this.e_=0,this.Am=0,this.Vm=0,this.Bm=null,this.Im=!1,this.up=new R,this.cp=new R,this.Mc=new R,this.zm=null,this.Em=null,this.Lm=t,this.cn=n,this.N_=l,this.um=document.createElement("div"),this.um.classList.add("tv-lightweight-charts"),this.um.style.overflow="hidden",this.um.style.direction="ltr",this.um.style.width="100%",this.um.style.height="100%",(a=this.um).style.userSelect="none",a.style.webkitUserSelect="none",a.style.msUserSelect="none",a.style.MozUserSelect="none",a.style.webkitTapHighlightColor="transparent",this.Nm=document.createElement("table"),this.Nm.setAttribute("cellspacing","0"),this.um.appendChild(this.Nm),this.Fm=this.Wm.bind(this),Es(this.cn)&&this.jm(!0),this.Ui=new zn(this.Sc.bind(this),this.cn,l),this.qt().Wc().l(this.Hm.bind(this),this),this.$m=new Vs(this,this.N_),this.Nm.appendChild(this.$m.jv());let u=n.autoSize&&this.Um(),c=this.cn.width,d=this.cn.height;if(u||0===c||0===d){let n=t.getBoundingClientRect();c=c||n.width,d=d||n.height}this.qm(c,d),this.Ym(),t.appendChild(this.um),this.Xm(),this.Ui.yt().Gu().l(this.Ui.$l.bind(this.Ui),this),this.Ui.f_().l(this.Ui.$l.bind(this.Ui),this)}qt(){return this.Ui}W(){return this.cn}Km(){return this.Dm}Zm(){return this.$m}S(){for(let t of(this.jm(!1),0!==this.Om&&window.cancelAnimationFrame(this.Om),this.Ui.Wc().p(this),this.Ui.yt().Gu().p(this),this.Ui.f_().p(this),this.Ui.S(),this.Dm))this.Nm.removeChild(t.jv()),t.Fp().p(this),t.Wp().p(this),t.S();this.Dm=[],b(this.$m).S(),null!==this.um.parentElement&&this.um.parentElement.removeChild(this.um),this.Mc.S(),this.up.S(),this.cp.S(),this.Gm()}qm(t,n,l=!1){if(this.Qa===n&&this.e_===t)return;let a=function(t){let n=Math.floor(t.width),l=Math.floor(t.height);return size({width:n-n%2,height:l-l%2})}(size({width:t,height:n}));this.Qa=a.height,this.e_=a.width;let u=this.Qa+"px",c=this.e_+"px";b(this.um).style.height=u,b(this.um).style.width=c,this.Nm.style.height=u,this.Nm.style.width=c,l?this.Jm(ct.es(),performance.now()):this.Ui.$l()}Zv(t){void 0===t&&(t=ct.es());for(let n=0;n<this.Dm.length;n++)this.Dm[n].Zv(t.Hn(n).Fn);this.cn.timeScale.visible&&this.$m.Zv(t.jn())}Nh(t){let n=Es(this.cn);this.Ui.Nh(t);let l=Es(this.cn);l!==n&&this.jm(l),this.Xm(),this.Qm(t)}Fp(){return this.up}Wp(){return this.cp}Wc(){return this.Mc}tb(){null!==this.Bm&&(this.Jm(this.Bm,performance.now()),this.Bm=null);let t=this.ib(null),n=document.createElement("canvas");n.width=t.width,n.height=t.height;let l=b(n.getContext("2d"));return this.ib(l),n}nb(t){return("left"!==t||this.sb())&&("right"!==t||this.eb())&&0!==this.Dm.length?b("left"===t?this.Dm[0].Zp():this.Dm[0].Gp()).Xv():0}rb(){return this.cn.autoSize&&null!==this.zm}hb(){return this.um}Vp(t){this.Em=t,this.Em?this.hb().style.setProperty("cursor",t):this.hb().style.removeProperty("cursor")}lb(){return this.Em}ab(){return m(this.Dm[0]).$p()}Qm(t){(void 0!==t.autoSize||!this.zm||void 0===t.width&&void 0===t.height)&&(t.autoSize&&!this.zm&&this.Um(),!1===t.autoSize&&null!==this.zm&&this.Gm(),t.autoSize||void 0===t.width&&void 0===t.height||this.qm(t.width||this.e_,t.height||this.Qa))}ib(t){let n=0,l=0,a=this.Dm[0],r=(n,l)=>{let a=0;for(let u=0;u<this.Dm.length;u++){let c=this.Dm[u],d=b("left"===n?c.Zp():c.Gp()),g=d.sp();null!==t&&d.ep(t,l,a),a+=g.height}};this.sb()&&(r("left",0),n+=b(a.Zp()).sp().width);for(let a=0;a<this.Dm.length;a++){let u=this.Dm[a],c=u.sp();null!==t&&u.ep(t,n,l),l+=c.height}n+=a.sp().width,this.eb()&&(r("right",n),n+=b(a.Gp()).sp().width);let h=(n,l,a)=>{b("left"===n?this.$m.bm():this.$m.wm()).ep(b(t),l,a)};if(this.cn.timeScale.visible){let n=this.$m.sp();if(null!==t){let u=0;this.sb()&&(h("left",u,l),u=b(a.Zp()).sp().width),this.$m.ep(t,u,l),u+=n.width,this.eb()&&h("right",u,l)}l+=n.height}return size({width:n,height:l})}ob(){var t,n,l;let a=0,u=0,c=0;for(let t of this.Dm)this.sb()&&(u=Math.max(u,b(t.Zp()).$v(),this.cn.leftPriceScale.minimumWidth)),this.eb()&&(c=Math.max(c,b(t.Gp()).$v(),this.cn.rightPriceScale.minimumWidth)),a+=t.v_();u=(n=u)+n%2,c=(l=c)+l%2;let d=this.e_,g=this.Qa,y=Math.max(d-u-c,0),S=this.cn.timeScale.visible,_=S?Math.max(this.$m.xm(),this.cn.timeScale.minimumHeight):0;_=(t=_)+t%2;let L=0+_,C=g<L?0:g-L,k=C/a,U=0;for(let t=0;t<this.Dm.length;++t){let n=this.Dm[t];n.Tp(this.Ui.Lc()[t]);let l=0;l=Math.max(t===this.Dm.length-1?C-U:Math.round(n.v_()*k),2),U+=l,n.Yv(size({width:y,height:l})),this.sb()&&n.Hp(u,"left"),this.eb()&&n.Hp(c,"right"),n.Kv()&&this.Ui.jc(n.Kv(),l)}this.$m.Mm(size({width:S?y:0,height:_}),S?u:0,S?c:0),this.Ui.m_(y),this.Am!==u&&(this.Am=u),this.Vm!==c&&(this.Vm=c)}jm(t){t?this.um.addEventListener("wheel",this.Fm,{passive:!1}):this.um.removeEventListener("wheel",this.Fm)}_b(t){switch(t.deltaMode){case t.DOM_DELTA_PAGE:return 120;case t.DOM_DELTA_LINE:return 32}return tJ?1/window.devicePixelRatio:1}Wm(t){if(!(0!==t.deltaX&&this.cn.handleScroll.mouseWheel||0!==t.deltaY&&this.cn.handleScale.mouseWheel))return;let n=this._b(t),l=n*t.deltaX/100,a=-n*t.deltaY/100;if(t.cancelable&&t.preventDefault(),0!==a&&this.cn.handleScale.mouseWheel){let n=Math.sign(a)*Math.min(1,Math.abs(a)),l=t.clientX-this.um.getBoundingClientRect().left;this.qt().Uc(l,n)}0!==l&&this.cn.handleScroll.mouseWheel&&this.qt().qc(-80*l)}Jm(t,n){var l;let a=t.jn();3===a&&this.ub(),3!==a&&2!==a||(this.cb(t),this.fb(t,n),this.$m.gt(),this.Dm.forEach(t=>{t.Rp()}),3===(null===(l=this.Bm)||void 0===l?void 0:l.jn())&&(this.Bm.ts(t),this.ub(),this.cb(this.Bm),this.fb(this.Bm,n),t=this.Bm,this.Bm=null)),this.Zv(t)}fb(t,n){for(let l of t.Qn())this.ns(l,n)}cb(t){let n=this.Ui.Lc();for(let l=0;l<n.length;l++)t.Hn(l).Wn&&n[l].V_()}ns(t,n){let l=this.Ui.yt();switch(t.qn){case 0:l.Qu();break;case 1:l.tc(t.Vt);break;case 2:l.Gn(t.Vt);break;case 3:l.Jn(t.Vt);break;case 4:l.Fu();break;case 5:t.Vt.Yu(n)||l.Jn(t.Vt.Xu(n))}}Sc(t){null!==this.Bm?this.Bm.ts(t):this.Bm=t,this.Im||(this.Im=!0,this.Om=window.requestAnimationFrame(t=>{if(this.Im=!1,this.Om=0,null!==this.Bm){let n=this.Bm;for(let l of(this.Bm=null,this.Jm(n,t),n.Qn()))if(5===l.qn&&!l.Vt.Yu(t)){this.qt().Xn(l.Vt);break}}}))}ub(){this.Ym()}Ym(){let t=this.Ui.Lc(),n=t.length,l=this.Dm.length;for(let t=n;t<l;t++){let t=m(this.Dm.pop());this.Nm.removeChild(t.jv()),t.Fp().p(this),t.Wp().p(this),t.S()}for(let a=l;a<n;a++){let n=new Ts(this,t[a]);n.Fp().l(this.vb.bind(this),this),n.Wp().l(this.pb.bind(this),this),this.Dm.push(n),this.Nm.insertBefore(n.jv(),this.$m.jv())}for(let l=0;l<n;l++){let n=t[l],a=this.Dm[l];a.Kv()!==n?a.Tp(n):a.Cp()}this.Xm(),this.ob()}mb(t,n,l){var a;let u;let c=new Map;if(null!==t&&this.Ui.Mt().forEach(n=>{let l=n.In().nl(t);null!==l&&c.set(n,l)}),null!==t){let n=null===(a=this.Ui.yt().qi(t))||void 0===a?void 0:a.originalTime;void 0!==n&&(u=n)}let d=this.qt().Vc(),g=null!==d&&d.Ic instanceof Gi?d.Ic:void 0,y=null!==d&&void 0!==d.pv?d.pv.wr:void 0;return{bb:u,se:null!=t?t:void 0,wb:null!=n?n:void 0,gb:g,Mb:c,xb:y,Sb:null!=l?l:void 0}}vb(t,n,l){this.up.m(()=>this.mb(t,n,l))}pb(t,n,l){this.cp.m(()=>this.mb(t,n,l))}Hm(t,n,l){this.Mc.m(()=>this.mb(t,n,l))}Xm(){let t=this.cn.timeScale.visible?"":"none";this.$m.jv().style.display=t}sb(){return this.Dm[0].Kv().S_().W().visible}eb(){return this.Dm[0].Kv().k_().W().visible}Um(){return"ResizeObserver"in window&&(this.zm=new ResizeObserver(t=>{let n=t.find(t=>t.target===this.Lm);n&&this.qm(n.contentRect.width,n.contentRect.height)}),this.zm.observe(this.Lm,{box:"border-box"}),!0)}Gm(){null!==this.zm&&this.zm.disconnect(),this.zm=null}};function Es(t){return!!(t.handleScroll.mouseWheel||t.handleScale.mouseWheel)}function Ls(t,n){var l={};for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&0>n.indexOf(a)&&(l[a]=t[a]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var u=0;for(a=Object.getOwnPropertySymbols(t);u<a.length;u++)0>n.indexOf(a[u])&&Object.prototype.propertyIsEnumerable.call(t,a[u])&&(l[a[u]]=t[a[u]])}return l}function Ns(t,n,l,a){let u=l.value,c={se:n,ut:t,Vt:[u,u,u,u],bb:a};return void 0!==l.color&&(c.O=l.color),c}function Fs(t,n,l,a){let u=l.value,c={se:n,ut:t,Vt:[u,u,u,u],bb:a};return void 0!==l.lineColor&&(c._t=l.lineColor),void 0!==l.topColor&&(c.Ts=l.topColor),void 0!==l.bottomColor&&(c.Ps=l.bottomColor),c}function Ws(t,n,l,a){let u=l.value,c={se:n,ut:t,Vt:[u,u,u,u],bb:a};return void 0!==l.topLineColor&&(c.Pe=l.topLineColor),void 0!==l.bottomLineColor&&(c.Re=l.bottomLineColor),void 0!==l.topFillColor1&&(c.Se=l.topFillColor1),void 0!==l.topFillColor2&&(c.ke=l.topFillColor2),void 0!==l.bottomFillColor1&&(c.ye=l.bottomFillColor1),void 0!==l.bottomFillColor2&&(c.Ce=l.bottomFillColor2),c}function js(t,n,l,a){let u={se:n,ut:t,Vt:[l.open,l.high,l.low,l.close],bb:a};return void 0!==l.color&&(u.O=l.color),u}function Hs(t,n,l,a){let u={se:n,ut:t,Vt:[l.open,l.high,l.low,l.close],bb:a};return void 0!==l.color&&(u.O=l.color),void 0!==l.borderColor&&(u.Bt=l.borderColor),void 0!==l.wickColor&&(u.$h=l.wickColor),u}function $s(t,n,l,a,u){let c=m(u)(l),d=c[c.length-1],{time:g,color:y}=l;return{se:n,ut:t,Vt:[d,Math.max(...c),Math.min(...c),d],bb:a,He:Ls(l,["time","color"]),O:y}}function Us(t){return void 0!==t.Vt}function qs(t,n){return void 0!==n.customValues&&(t.kb=n.customValues),t}function Ys(t){return(n,l,a,u,c,d)=>(d?d(a):void 0===a.open&&void 0===a.value)?qs({ut:n,se:l,bb:u},a):qs(t(n,l,a,u,c),a)}function Xs(t){return({Candlestick:Ys(Hs),Bar:Ys(js),Area:Ys(Fs),Baseline:Ys(Ws),Histogram:Ys(Ns),Line:Ys(Ns),Custom:Ys($s)})[t]}function Ks(t){return{se:0,yb:new Map,ia:t}}function Zs(t,n){if(void 0!==t&&0!==t.length)return{Cb:n.key(t[0].ut),Tb:n.key(t[t.length-1].ut)}}function Gs(t){let n;return t.forEach(t=>{void 0===n&&(n=t.bb)}),m(n)}let Js=class Js{constructor(t){this.Pb=new Map,this.Rb=new Map,this.Db=new Map,this.Ob=[],this.N_=t}S(){this.Pb.clear(),this.Rb.clear(),this.Db.clear(),this.Ob=[]}Ab(t,n){let l=0!==this.Pb.size,a=!1,u=this.Rb.get(t);if(void 0!==u){if(1===this.Rb.size)l=!1,a=!0,this.Pb.clear();else for(let n of this.Ob)n.pointData.yb.delete(t)&&(a=!0)}let c=[];if(0!==n.length){let l=n.map(t=>t.time),u=this.N_.createConverterToInternalObj(n),d=Xs(t.Xh()),g=t.ga(),y=t.Ma();c=n.map((n,c)=>{let S=u(n.time),_=this.N_.key(S),L=this.Pb.get(_);void 0===L&&(L=Ks(S),this.Pb.set(_,L),a=!0);let C=d(S,L.se,n,l[c],g,y);return L.yb.set(t,C),C})}l&&this.Vb(),this.Bb(t,c);let d=-1;if(a){let t=[];this.Pb.forEach(n=>{t.push({timeWeight:0,time:n.ia,pointData:n,originalTime:Gs(n.yb)})}),t.sort((t,n)=>this.N_.key(t.time)-this.N_.key(n.time)),d=this.Ib(t)}return this.zb(t,d,function(t,n,l){let a=Zs(t,l),u=Zs(n,l);if(void 0!==a&&void 0!==u)return{Xl:a.Tb>=u.Tb&&a.Cb>=u.Cb}}(this.Rb.get(t),u,this.N_))}hd(t){return this.Ab(t,[])}Eb(t,n){void 0===n.bb&&(n.bb=n.time),this.N_.preprocessData(n);let l=this.N_.createConverterToInternalObj([n])(n.time),a=this.Db.get(t);if(void 0!==a&&this.N_.key(l)<this.N_.key(a))throw Error(`Cannot update oldest data, last time=${a}, new time=${l}`);let u=this.Pb.get(this.N_.key(l)),c=void 0===u;void 0===u&&(u=Ks(l),this.Pb.set(this.N_.key(l),u));let d=Xs(t.Xh()),g=t.ga(),y=t.Ma(),S=d(l,u.se,n,n.bb,g,y);u.yb.set(t,S),this.Lb(t,S);let _={Xl:Us(S)};if(!c)return this.zb(t,-1,_);let L={timeWeight:0,time:u.ia,pointData:u,originalTime:Gs(u.yb)},C=tP(this.Ob,this.N_.key(L.time),(t,n)=>this.N_.key(t.time)<n);this.Ob.splice(C,0,L);for(let t=C;t<this.Ob.length;++t)Qs(this.Ob[t].pointData,t);return this.N_.fillWeightsForPoints(this.Ob,C),this.zb(t,C,_)}Lb(t,n){let l=this.Rb.get(t);void 0===l&&(l=[],this.Rb.set(t,l));let a=0!==l.length?l[l.length-1]:null;null===a||this.N_.key(n.ut)>this.N_.key(a.ut)?Us(n)&&l.push(n):Us(n)?l[l.length-1]=n:l.splice(-1,1),this.Db.set(t,n.ut)}Bb(t,n){0!==n.length?(this.Rb.set(t,n.filter(Us)),this.Db.set(t,n[n.length-1].ut)):(this.Rb.delete(t),this.Db.delete(t))}Vb(){for(let t of this.Ob)0===t.pointData.yb.size&&this.Pb.delete(this.N_.key(t.time))}Ib(t){let n=-1;for(let l=0;l<this.Ob.length&&l<t.length;++l){let a=this.Ob[l],u=t[l];if(this.N_.key(a.time)!==this.N_.key(u.time)){n=l;break}u.timeWeight=a.timeWeight,Qs(u.pointData,l)}if(-1===n&&this.Ob.length!==t.length&&(n=Math.min(this.Ob.length,t.length)),-1===n)return -1;for(let l=n;l<t.length;++l)Qs(t[l].pointData,l);return this.N_.fillWeightsForPoints(t,n),this.Ob=t,n}Nb(){if(0===this.Rb.size)return null;let t=0;return this.Rb.forEach(n=>{0!==n.length&&(t=Math.max(t,n[n.length-1].se))}),t}zb(t,n,l){let a={Fb:new Map,yt:{Au:this.Nb()}};if(-1!==n)this.Rb.forEach((n,u)=>{a.Fb.set(u,{He:n,Wb:u===t?l:void 0})}),this.Rb.has(t)||a.Fb.set(t,{He:[],Wb:l}),a.yt.jb=this.Ob,a.yt.Hb=n;else{let n=this.Rb.get(t);a.Fb.set(t,{He:n||[],Wb:l})}return a}};function Qs(t,n){t.se=n,t.yb.forEach(t=>{t.se=n})}function te(t){let n={value:t.Vt[3],time:t.bb};return void 0!==t.kb&&(n.customValues=t.kb),n}function ie(t){let n=te(t);return void 0!==t.O&&(n.color=t.O),n}function ne(t){let n=te(t);return void 0!==t._t&&(n.lineColor=t._t),void 0!==t.Ts&&(n.topColor=t.Ts),void 0!==t.Ps&&(n.bottomColor=t.Ps),n}function se(t){let n=te(t);return void 0!==t.Pe&&(n.topLineColor=t.Pe),void 0!==t.Re&&(n.bottomLineColor=t.Re),void 0!==t.Se&&(n.topFillColor1=t.Se),void 0!==t.ke&&(n.topFillColor2=t.ke),void 0!==t.ye&&(n.bottomFillColor1=t.ye),void 0!==t.Ce&&(n.bottomFillColor2=t.Ce),n}function ee(t){let n={open:t.Vt[0],high:t.Vt[1],low:t.Vt[2],close:t.Vt[3],time:t.bb};return void 0!==t.kb&&(n.customValues=t.kb),n}function re(t){let n=ee(t);return void 0!==t.O&&(n.color=t.O),n}function he(t){let n=ee(t),{O:l,Bt:a,$h:u}=t;return void 0!==l&&(n.color=l),void 0!==a&&(n.borderColor=a),void 0!==u&&(n.wickColor=u),n}function le(t){return({Area:ne,Line:ie,Baseline:se,Histogram:ie,Bar:re,Candlestick:he,Custom:ae})[t]}function ae(t){let n=t.bb;return Object.assign(Object.assign({},t.He),{time:n})}let tH={vertLine:{color:"#9598A1",width:1,style:3,visible:!0,labelVisible:!0,labelBackgroundColor:"#131722"},horzLine:{color:"#9598A1",width:1,style:3,visible:!0,labelVisible:!0,labelBackgroundColor:"#131722"},mode:1},tK={vertLines:{color:"#D6DCDE",style:0,visible:!0},horzLines:{color:"#D6DCDE",style:0,visible:!0}},tY={background:{type:"solid",color:"#FFFFFF"},textColor:"#191919",fontSize:12,fontFamily:tO},tX={autoScale:!0,mode:0,invertScale:!1,alignLabels:!0,borderVisible:!0,borderColor:"#2B2B43",entireTextOnly:!1,visible:!1,ticksVisible:!1,scaleMargins:{bottom:.1,top:.2},minimumWidth:0},tQ={rightOffset:0,barSpacing:6,minBarSpacing:.5,fixLeftEdge:!1,fixRightEdge:!1,lockVisibleTimeRangeOnResize:!1,rightBarStaysOnScroll:!1,borderVisible:!0,borderColor:"#2B2B43",visible:!0,timeVisible:!1,secondsVisible:!0,shiftVisibleRangeOnNewBar:!0,allowShiftVisibleRangeOnWhitespaceReplacement:!1,ticksVisible:!1,uniformDistribution:!1,minimumHeight:0},tG={color:"rgba(0, 0, 0, 0)",visible:!1,fontSize:48,fontFamily:tO,fontStyle:"",text:"",horzAlign:"center",vertAlign:"center"};function ve(){return{width:0,height:0,autoSize:!1,layout:tY,crosshair:tH,grid:tK,overlayPriceScales:Object.assign({},tX),leftPriceScale:Object.assign(Object.assign({},tX),{visible:!1}),rightPriceScale:Object.assign(Object.assign({},tX),{visible:!0}),timeScale:tQ,watermark:tG,localization:{locale:tU?navigator.language:"",dateFormat:"dd MMM 'yy"},handleScroll:{mouseWheel:!0,pressedMouseMove:!0,horzTouchDrag:!0,vertTouchDrag:!0},handleScale:{axisPressedMouseMove:{time:!0,price:!0},axisDoubleClickReset:{time:!0,price:!0},mouseWheel:!0,pinch:!0},kineticScroll:{mouse:!1,touch:!0},trackingMode:{exitMode:1}}}let pe=class pe{constructor(t,n){this.$b=t,this.Ub=n}applyOptions(t){this.$b.qt().zc(this.Ub,t)}options(){return this.Li().W()}width(){return ut(this.Ub)?this.$b.nb(this.Ub):0}Li(){return b(this.$b.qt().Ec(this.Ub)).At}};function me(t,n,l){let a=Ls(t,["time","originalTime"]),u=Object.assign({time:n},a);return void 0!==l&&(u.originalTime=l),u}let tZ={color:"#FF0000",price:0,lineStyle:2,lineWidth:1,lineVisible:!0,axisLabelVisible:!0,title:"",axisLabelColor:"",axisLabelTextColor:""};let we=class we{constructor(t){this.Bh=t}applyOptions(t){this.Bh.Nh(t)}options(){return this.Bh.W()}qb(){return this.Bh}};let ge=class ge{constructor(t,n,l,a,u){this.Yb=new R,this.Es=t,this.Xb=n,this.Kb=l,this.N_=u,this.Zb=a}S(){this.Yb.S()}priceFormatter(){return this.Es.ca()}priceToCoordinate(t){let n=this.Es.Pt();return null===n?null:this.Es.At().Ot(t,n.Vt)}coordinateToPrice(t){let n=this.Es.Pt();return null===n?null:this.Es.At().pn(t,n.Vt)}barsInLogicalRange(t){if(null===t)return null;let n=new yn(new xn(t.from,t.to)).iu(),l=this.Es.In();if(l.Fi())return null;let a=l.nl(n.Os(),1),u=l.nl(n.di(),-1),c=b(l.Qh()),d=b(l.Bn());if(null!==a&&null!==u&&a.se>u.se)return{barsBefore:t.from-c,barsAfter:d-t.to};let g={barsBefore:null===a||a.se===c?t.from-c:a.se-c,barsAfter:null===u||u.se===d?d-t.to:d-u.se};return null!==a&&null!==u&&(g.from=a.bb,g.to=u.bb),g}setData(t){this.N_,this.Es.Xh(),this.Xb.Gb(this.Es,t),this.Jb("full")}update(t){this.Es.Xh(),this.Xb.Qb(this.Es,t),this.Jb("update")}dataByIndex(t,n){let l=this.Es.In().nl(t,n);return null===l?null:le(this.seriesType())(l)}data(){let t=le(this.seriesType());return this.Es.In().ie().map(n=>t(n))}subscribeDataChanged(t){this.Yb.l(t)}unsubscribeDataChanged(t){this.Yb.v(t)}setMarkers(t){this.N_;let n=t.map(t=>me(t,this.N_.convertHorzItemToInternal(t.time),t.time));this.Es.Zl(n)}markers(){return this.Es.Gl().map(t=>me(t,t.originalTime,void 0))}applyOptions(t){this.Es.Nh(t)}options(){return I(this.Es.W())}priceScale(){return this.Kb.priceScale(this.Es.At().xa())}createPriceLine(t){let n=D(I(tZ),t),l=this.Es.Jl(n);return new we(l)}removePriceLine(t){this.Es.Ql(t.qb())}seriesType(){return this.Es.Xh()}attachPrimitive(t){this.Es.ba(t),t.attached&&t.attached({chart:this.Zb,series:this,requestUpdate:()=>this.Es.qt().$l()})}detachPrimitive(t){this.Es.wa(t),t.detached&&t.detached()}Jb(t){this.Yb.M()&&this.Yb.m(t)}};let Me=class Me{constructor(t,n,l){this.tw=new R,this.uu=new R,this._m=new R,this.Ui=t,this.wl=t.yt(),this.$m=n,this.wl.Ku().l(this.iw.bind(this)),this.wl.Zu().l(this.nw.bind(this)),this.$m.gm().l(this.sw.bind(this)),this.N_=l}S(){this.wl.Ku().p(this),this.wl.Zu().p(this),this.$m.gm().p(this),this.tw.S(),this.uu.S(),this._m.S()}scrollPosition(){return this.wl.Eu()}scrollToPosition(t,n){n?this.wl.qu(t,1e3):this.Ui.Jn(t)}scrollToRealTime(){this.wl.Uu()}getVisibleRange(){let t=this.wl.yu();return null===t?null:{from:t.from.originalTime,to:t.to.originalTime}}setVisibleRange(t){let n={from:this.N_.convertHorzItemToInternal(t.from),to:this.N_.convertHorzItemToInternal(t.to)},l=this.wl.Ru(n);this.Ui.ld(l)}getVisibleLogicalRange(){let t=this.wl.ku();return null===t?null:{from:t.Os(),to:t.di()}}setVisibleLogicalRange(t){p(t.from<=t.to,"The from index cannot be after the to index."),this.Ui.ld(t)}resetTimeScale(){this.Ui.Zn()}fitContent(){this.Ui.Qu()}logicalToCoordinate(t){let n=this.Ui.yt();return n.Fi()?null:n.Et(t)}coordinateToLogical(t){return this.wl.Fi()?null:this.wl.Vu(t)}timeToCoordinate(t){let n=this.N_.convertHorzItemToInternal(t),l=this.wl.ya(n,!1);return null===l?null:this.wl.Et(l)}coordinateToTime(t){let n=this.Ui.yt(),l=n.Vu(t),a=n.qi(l);return null===a?null:a.originalTime}width(){return this.$m.$p().width}height(){return this.$m.$p().height}subscribeVisibleTimeRangeChange(t){this.tw.l(t)}unsubscribeVisibleTimeRangeChange(t){this.tw.v(t)}subscribeVisibleLogicalRangeChange(t){this.uu.l(t)}unsubscribeVisibleLogicalRangeChange(t){this.uu.v(t)}subscribeSizeChange(t){this._m.l(t)}unsubscribeSizeChange(t){this._m.v(t)}applyOptions(t){this.wl.Nh(t)}options(){return Object.assign(Object.assign({},I(this.wl.W())),{barSpacing:this.wl.he()})}iw(){this.tw.M()&&this.tw.m(this.getVisibleRange())}nw(){this.uu.M()&&this.uu.m(this.getVisibleLogicalRange())}sw(t){this._m.m(t.width,t.height)}};function Se(t){return function(t){if(B(t.handleScale)){let n=t.handleScale;t.handleScale={axisDoubleClickReset:{time:n,price:n},axisPressedMouseMove:{time:n,price:n},mouseWheel:n,pinch:n}}else if(void 0!==t.handleScale){let{axisPressedMouseMove:n,axisDoubleClickReset:l}=t.handleScale;B(n)&&(t.handleScale.axisPressedMouseMove={time:n,price:n}),B(l)&&(t.handleScale.axisDoubleClickReset={time:l,price:l})}let n=t.handleScroll;B(n)&&(t.handleScroll={horzTouchDrag:n,vertTouchDrag:n,mouseWheel:n,pressedMouseMove:n})}(t),t}let ke=class ke{constructor(t,n,l){this.ew=new Map,this.rw=new Map,this.hw=new R,this.lw=new R,this.aw=new R,this.ow=new Js(n);let a=void 0===l?I(ve()):D(I(ve()),Se(l));this.N_=n,this.$b=new zs(t,a,n),this.$b.Fp().l(t=>{this.hw.M()&&this.hw.m(this._w(t()))},this),this.$b.Wp().l(t=>{this.lw.M()&&this.lw.m(this._w(t()))},this),this.$b.Wc().l(t=>{this.aw.M()&&this.aw.m(this._w(t()))},this);let u=this.$b.qt();this.uw=new Me(u,this.$b.Zm(),this.N_)}remove(){this.$b.Fp().p(this),this.$b.Wp().p(this),this.$b.Wc().p(this),this.uw.S(),this.$b.S(),this.ew.clear(),this.rw.clear(),this.hw.S(),this.lw.S(),this.aw.S(),this.ow.S()}resize(t,n,l){this.autoSizeActive()||this.$b.qm(t,n,l)}addCustomSeries(t,n){let l=w(t),a=Object.assign(Object.assign({},tM),l.defaultOptions());return this.cw("Custom",a,n,l)}addAreaSeries(t){return this.cw("Area",tw,t)}addBaselineSeries(t){return this.cw("Baseline",ty,t)}addBarSeries(t){return this.cw("Bar",tb,t)}addCandlestickSeries(t={}){return void 0!==t.borderColor&&(t.borderUpColor=t.borderColor,t.borderDownColor=t.borderColor),void 0!==t.wickColor&&(t.wickUpColor=t.wickColor,t.wickDownColor=t.wickColor),this.cw("Candlestick",tp,t)}addHistogramSeries(t){return this.cw("Histogram",tS,t)}addLineSeries(t){return this.cw("Line",tg,t)}removeSeries(t){let n=m(this.ew.get(t)),l=this.ow.hd(n);this.$b.qt().hd(n),this.dw(l),this.ew.delete(t),this.rw.delete(n)}Gb(t,n){this.dw(this.ow.Ab(t,n))}Qb(t,n){this.dw(this.ow.Eb(t,n))}subscribeClick(t){this.hw.l(t)}unsubscribeClick(t){this.hw.v(t)}subscribeCrosshairMove(t){this.aw.l(t)}unsubscribeCrosshairMove(t){this.aw.v(t)}subscribeDblClick(t){this.lw.l(t)}unsubscribeDblClick(t){this.lw.v(t)}priceScale(t){return new pe(this.$b,t)}timeScale(){return this.uw}applyOptions(t){this.$b.Nh(Se(t))}options(){return this.$b.W()}takeScreenshot(){return this.$b.tb()}autoSizeActive(){return this.$b.rb()}chartElement(){return this.$b.hb()}paneSize(){let t=this.$b.ab();return{height:t.height,width:t.width}}setCrosshairPosition(t,n,l){let a=this.ew.get(l);if(void 0===a)return;let u=this.$b.qt().cr(a);null!==u&&this.$b.qt().Qc(t,n,u)}clearCrosshairPosition(){this.$b.qt().td(!0)}cw(t,n,l={},a){var u;void 0!==(u=l.priceFormat)&&"custom"!==u.type&&void 0!==u.minMove&&void 0===u.precision&&(u.precision=function(t){if(t>=1)return 0;let n=0;for(;n<8;n++){let n=Math.round(t);if(1e-8>Math.abs(n-t))break;t*=10}return n}(u.minMove));let c=D(I(t_),I(n),l),d=this.$b.qt().ed(t,c,a),g=new ge(d,this,this,this,this.N_);return this.ew.set(g,d),this.rw.set(d,g),g}dw(t){let n=this.$b.qt();n.nd(t.yt.Au,t.yt.jb,t.yt.Hb),t.Fb.forEach((t,n)=>n.it(t.He,t.Wb)),n.Iu()}fw(t){return m(this.rw.get(t))}_w(t){let n=new Map;t.Mb.forEach((t,l)=>{let a=l.Xh(),u=le(a)(t);if("Custom"!==a)p(void 0!==u.open||void 0!==u.value);else{let t=l.Ma();p(!t||!1===t(u))}n.set(this.fw(l),u)});let l=void 0===t.gb?void 0:this.fw(t.gb);return{time:t.bb,logical:t.se,point:t.wb,hoveredSeries:l,hoveredObjectId:t.xb,seriesData:n,sourceEvent:t.Sb}}};function Ce(t,n){return function(t,n,l){let a;if(V(t)){let n=document.getElementById(t);p(null!==n,`Cannot find element in DOM with id=${t}`),a=n}else a=t;let u=new ke(a,n,l);return n.setOptions(u.options()),u}(t,new ts,ts.Td(n))}Object.assign(Object.assign({},t_),tM)}}]);
//# sourceMappingURL=9448-9d5b6bba9925a365.js.map